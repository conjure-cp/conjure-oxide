# essence-feature-usage-stats

## About

This is an internal tool for the [conjure-oxide](https://github.com/conjure-cp/conjure-oxide) project.

It does the following:
- Given a directory containing Essence files, go through it and count how often every Essence language feature is used
- Display this data as a simple web page with a table

The purpose of this is to make it easier to find Essence examples to test specific Essence language features, which should be useful over the course of rewriting the conjure tool stack in Rust


## Building

The static HTML page is generated by running the main.py script.

The page is placed in the ./web/static directory by default. 
This can be configured using the OUTPUT_PATH environment variable, but paths to the script and stylesheet
inside the index.html template will need to be updated. 
The GitHub action also assumes that path and won't work if it's changed.

It is deployed using GitHub Pages: see https://conjure-cp.github.io/conjure-oxide/tools/essence-feature-usage-stats


## Usage

- Essence example files are taken from the [EssenceCatalog](https://github.com/conjure-cp/EssenceCatalog) repo. This can be changed using an environment variable - see bellow.
- Table headers show Essence keywords
- Table row headers show paths to Essence example files and the size of the files (in lines of code)
- Table cells show how often a given keyword is used in a given file
- Cells are colour coded. Red means a keyword is NOT used in this file, orange means it's used less than average, green means it's used more
- Columns are sortable. Click on table header cells to sort rows by how often this keyword is used in each file.(See top of the HTML page for detailed use instructions)

## Configuration

- `ESSENCE_DIR` - Local directory to store essence files
- `CONJURE_DIR` - Local directory to store conjure binaries
- `CONJURE_REPO` - GitHub repo to download conjure releases from
- `ESSENCE_FILE_REPOS` - Comma-separated list of repos to download Essence examples from. Format: `"<repo_url>::<repo_branch>,<repo2_url>::<repo2_branch>,..."`
- `OUTPUT_PATH` - Path to save the generated HTML page. Be careful with changing this (see above).
- `KEYWORD_BLOCKLIST` - Comma-separated list of Essence keywords to ignore
- `EXCLUDE_PATHS_REGEX` - Regex to exclude Essence files, e.g. `"*autogen*"`
- `MAX_N_FILES` - Max number of Essence files to process

---

## Authors

- Georgii Skorokhod and Hannah Zheng, 2023
- University of St Andrews
- Developed as part of a Vertically Integrated Project by Ozgur Akgun et al
- (See [main repo](https://github.com/conjure-cp))
