Model before rewriting:

letting Index be domain int(1..3)
letting Value be domain int(1..9)
letting n be 3
find s: int(1..24)
find square: matrix indexed by [Index, Index] of Value

such that

allDiff(flatten(square)),
and([ (sum([ square[r, c] | c : Index ]) = s) | r : Index ]),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)

such that

(true != (sum([ __0[r, __1] | c : Index ]) = __2))

--

(true != (sum([ __0[r, __1] | c : Index ]) = __2)), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(true != (sum([ __0[r, __1] | c : Index ]) = __2))
new variables:
  find __0#matrix_to_atom_1_1: int(1..9)
  find __0#matrix_to_atom_1_2: int(1..9)
  find __0#matrix_to_atom_1_3: int(1..9)
  find __0#matrix_to_atom_2_1: int(1..9)
  find __0#matrix_to_atom_2_2: int(1..9)
  find __0#matrix_to_atom_2_3: int(1..9)
  find __0#matrix_to_atom_3_1: int(1..9)
  find __0#matrix_to_atom_3_2: int(1..9)
  find __0#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index

such that

(0 != __0[__1, __1])

--

(0 != __0#matrix_to_atom[__1, __1]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __0#matrix_to_atom[__1, __1])
new variables:
  find __0#matrix_to_atom_1_1: int(1..9)
  find __0#matrix_to_atom_1_2: int(1..9)
  find __0#matrix_to_atom_1_3: int(1..9)
  find __0#matrix_to_atom_2_1: int(1..9)
  find __0#matrix_to_atom_2_2: int(1..9)
  find __0#matrix_to_atom_2_3: int(1..9)
  find __0#matrix_to_atom_3_1: int(1..9)
  find __0#matrix_to_atom_3_2: int(1..9)
  find __0#matrix_to_atom_3_3: int(1..9)

--

__0#matrix_to_atom[__1, __1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__0#matrix_to_atom[__1, __1] @ and([__inDomain(__1,int(1..3)),__inDomain(__1,int(1..3));int(1..)])}

--

(0 != {__0#matrix_to_atom[__1, __1] @ and([__inDomain(__1,int(1..3)),__inDomain(__1,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __0#matrix_to_atom[__1, __1])

--

(0 != __0#matrix_to_atom[__1, __1]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),product([1,(__1 - 1);int(1..)]),1;int(1..)])])

--

product([1,(__1 - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(__1 - 1);int(1..)])

--

product([(__1 - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(__1 - 1)

--

(__1 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__1,-(1);int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-(1);int(1..)]);int(1..)]),(__1 - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),(__1 - 1),1;int(1..)])])

--

(__1 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__1,-(1);int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([__1,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([__1,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([__1,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),__1,-1,1;int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),__1,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),__1;int(1..)])])

--

[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),__1;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__2]
new variables:
  find __2: int(1..9)
new constraints:
  __2 =aux sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),__1;int(1..)])

--

__2 =aux sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),__1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[__1, __3],__2),FlatWeightedSumGeq([1, 3],[__1, __3],__2);int(1..)])
new variables:
  find __3: int(0..2)
new constraints:
  __3 =aux sum([__1,-1;int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__2]),
and([FlatWeightedSumLeq([1, 3],[__1, __3],__2),FlatWeightedSumGeq([1, 3],[__1, __3],__2);int(1..)]),
__3 =aux sum([__1,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__2]),
FlatWeightedSumLeq([1, 3],[__1, __3],__2),
FlatWeightedSumGeq([1, 3],[__1, __3],__2),
__3 =aux sum([__1,-1;int(1..)])

--

__3 =aux sum([__1,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __1], __3),SumGeq([-1, __1], __3);int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__2]),
FlatWeightedSumLeq([1, 3],[__1, __3],__2),
FlatWeightedSumGeq([1, 3],[__1, __3],__2),
and([SumLeq([-1, __1], __3),SumGeq([-1, __1], __3);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__2]),
FlatWeightedSumLeq([1, 3],[__1, __3],__2),
FlatWeightedSumGeq([1, 3],[__1, __3],__2),
SumLeq([-1, __1], __3),
SumGeq([-1, __1], __3)

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__2]),
FlatWeightedSumLeq([1, 3],[__1, __3],__2),
FlatWeightedSumGeq([1, 3],[__1, __3],__2),
SumLeq([-1, __1], __3),
SumGeq([-1, __1], __3)

Via-solver generator model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

such that

true

[ __0[r, __1] | c : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[__0[r, __1],__0[r, __1],__0[r, __1];int(1..)]

--

(true != (sum([__0#matrix_to_atom[r, __1],__0#matrix_to_atom[r, __1],__0#matrix_to_atom[r, __1];int(1..)]) = __2)), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(true != (sum([__0#matrix_to_atom[r, __1],__0#matrix_to_atom[r, __1],__0#matrix_to_atom[r, __1];int(1..)]) = __2))

--

__0#matrix_to_atom[r, __1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__0#matrix_to_atom[r, __1] @ and([__inDomain(r,int(1..3)),__inDomain(__1,int(1..3));int(1..)])}

--

(true != (sum([{__0#matrix_to_atom[r, __1] @ and([__inDomain(r,int(1..3)),__inDomain(__1,int(1..3));int(1..)])},__0#matrix_to_atom[r, __1],__0#matrix_to_atom[r, __1];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__0#matrix_to_atom[r, __1],__0#matrix_to_atom[r, __1],__0#matrix_to_atom[r, __1];int(1..)]) = __2))

--

__0#matrix_to_atom[r, __1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__0#matrix_to_atom[r, __1] @ and([__inDomain(r,int(1..3)),__inDomain(__1,int(1..3));int(1..)])}

--

(true != (sum([__0#matrix_to_atom[r, __1],{__0#matrix_to_atom[r, __1] @ and([__inDomain(r,int(1..3)),__inDomain(__1,int(1..3));int(1..)])},__0#matrix_to_atom[r, __1];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__0#matrix_to_atom[r, __1],__0#matrix_to_atom[r, __1],__0#matrix_to_atom[r, __1];int(1..)]) = __2))

--

__0#matrix_to_atom[r, __1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__0#matrix_to_atom[r, __1] @ and([__inDomain(r,int(1..3)),__inDomain(__1,int(1..3));int(1..)])}

--

(true != (sum([__0#matrix_to_atom[r, __1],__0#matrix_to_atom[r, __1],{__0#matrix_to_atom[r, __1] @ and([__inDomain(r,int(1..3)),__inDomain(__1,int(1..3));int(1..)])};int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__0#matrix_to_atom[r, __1],__0#matrix_to_atom[r, __1],__0#matrix_to_atom[r, __1];int(1..)]) = __2))

--

(true != (sum([__0#matrix_to_atom[r, __1],__0#matrix_to_atom[r, __1],__0#matrix_to_atom[r, __1];int(1..)]) = __2)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(__1 - 1);int(1..)]),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(__1 - 1);int(1..)]),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(__1 - 1);int(1..)]),1;int(1..)])];int(1..)]) = __2))

--

product([1,(__1 - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(__1 - 1);int(1..)])

--

product([(__1 - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(__1 - 1)

--

product([1,(__1 - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(__1 - 1);int(1..)])

--

product([(__1 - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(__1 - 1)

--

product([1,(__1 - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(__1 - 1);int(1..)])

--

product([(__1 - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(__1 - 1)

--

(r - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([r,-(1);int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-(1);int(1..)]);int(1..)]),(__1 - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),(__1 - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])];int(1..)]) = __2))

--

(__1 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__1,-(1);int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),sum([__1,-(1);int(1..)]),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),sum([__1,-1;int(1..)]),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])];int(1..)]) = __2))

--

sum([product([3,sum([r,-1;int(1..)]);int(1..)]),sum([__1,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1,-1,1;int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1,-1,1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])];int(1..)]) = __2))

--

(r - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([r,-(1);int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-(1);int(1..)]);int(1..)]),(__1 - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),(__1 - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])];int(1..)]) = __2))

--

(__1 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__1,-(1);int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),sum([__1,-(1);int(1..)]),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),sum([__1,-1;int(1..)]),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])];int(1..)]) = __2))

--

sum([product([3,sum([r,-1;int(1..)]);int(1..)]),sum([__1,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1,-1,1;int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1,-1,1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),(__1 - 1),1;int(1..)])];int(1..)]) = __2))

--

(r - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([r,-(1);int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-(1);int(1..)]);int(1..)]),(__1 - 1),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),(__1 - 1),1;int(1..)])];int(1..)]) = __2))

--

(__1 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__1,-(1);int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),sum([__1,-(1);int(1..)]),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),sum([__1,-1;int(1..)]),1;int(1..)])];int(1..)]) = __2))

--

sum([product([3,sum([r,-1;int(1..)]);int(1..)]),sum([__1,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1,-1,1;int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1,-1,1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])];int(1..)]) = __2))

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])];int(1..)]) = __2)), 
   ~~> flatten_generic ([("Minion", 4200)])
(true != __3)
new variables:
  find __3: bool
new constraints:
  __3 =aux (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])];int(1..)]) = __2)

--

__3 =aux (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])];int(1..)]) = __2), 
   ~~> bool_eq_to_reify ([("Minion", 4400)])
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])];int(1..)]) = __2), __3)

--

[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4]
new variables:
  find __4: int(1..9)
new constraints:
  __4 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])

--

__4 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[__1, __5],__4),FlatWeightedSumGeq([1, 3],[__1, __5],__4);int(1..)])
new variables:
  find __5: int(0..2)
new constraints:
  __5 =aux sum([r,-1;int(1..)])

--

(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])];int(1..)]) = __2), __3),
and([FlatWeightedSumLeq([1, 3],[__1, __5],__4),FlatWeightedSumGeq([1, 3],[__1, __5],__4);int(1..)]),
__5 =aux sum([r,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])];int(1..)]) = __2), __3),
FlatWeightedSumLeq([1, 3],[__1, __5],__4),
FlatWeightedSumGeq([1, 3],[__1, __5],__4),
__5 =aux sum([r,-1;int(1..)])

--

__5 =aux sum([r,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, r], __5),SumGeq([-1, r], __5);int(1..)])

--

(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])];int(1..)]) = __2), __3),
FlatWeightedSumLeq([1, 3],[__1, __5],__4),
FlatWeightedSumGeq([1, 3],[__1, __5],__4),
and([SumLeq([-1, r], __5),SumGeq([-1, r], __5);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])];int(1..)]) = __2), __3),
FlatWeightedSumLeq([1, 3],[__1, __5],__4),
FlatWeightedSumGeq([1, 3],[__1, __5],__4),
SumLeq([-1, r], __5),
SumGeq([-1, r], __5)

--

[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6]
new variables:
  find __6: int(1..9)
new constraints:
  __6 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])

--

__6 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[__1, __7],__6),FlatWeightedSumGeq([1, 3],[__1, __7],__6);int(1..)])
new variables:
  find __7: int(0..2)
new constraints:
  __7 =aux sum([r,-1;int(1..)])

--

(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])];int(1..)]) = __2), __3),
FlatWeightedSumLeq([1, 3],[__1, __5],__4),
FlatWeightedSumGeq([1, 3],[__1, __5],__4),
SumLeq([-1, r], __5),
SumGeq([-1, r], __5),
and([FlatWeightedSumLeq([1, 3],[__1, __7],__6),FlatWeightedSumGeq([1, 3],[__1, __7],__6);int(1..)]),
__7 =aux sum([r,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])];int(1..)]) = __2), __3),
FlatWeightedSumLeq([1, 3],[__1, __5],__4),
FlatWeightedSumGeq([1, 3],[__1, __5],__4),
SumLeq([-1, r], __5),
SumGeq([-1, r], __5),
FlatWeightedSumLeq([1, 3],[__1, __7],__6),
FlatWeightedSumGeq([1, 3],[__1, __7],__6),
__7 =aux sum([r,-1;int(1..)])

--

__7 =aux sum([r,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, r], __7),SumGeq([-1, r], __7);int(1..)])

--

(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])];int(1..)]) = __2), __3),
FlatWeightedSumLeq([1, 3],[__1, __5],__4),
FlatWeightedSumGeq([1, 3],[__1, __5],__4),
SumLeq([-1, r], __5),
SumGeq([-1, r], __5),
FlatWeightedSumLeq([1, 3],[__1, __7],__6),
FlatWeightedSumGeq([1, 3],[__1, __7],__6),
and([SumLeq([-1, r], __7),SumGeq([-1, r], __7);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])];int(1..)]) = __2), __3),
FlatWeightedSumLeq([1, 3],[__1, __5],__4),
FlatWeightedSumGeq([1, 3],[__1, __5],__4),
SumLeq([-1, r], __5),
SumGeq([-1, r], __5),
FlatWeightedSumLeq([1, 3],[__1, __7],__6),
FlatWeightedSumGeq([1, 3],[__1, __7],__6),
SumLeq([-1, r], __7),
SumGeq([-1, r], __7)

--

[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__8]
new variables:
  find __8: int(1..9)
new constraints:
  __8 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)])

--

__8 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),__1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[__1, __9],__8),FlatWeightedSumGeq([1, 3],[__1, __9],__8);int(1..)])
new variables:
  find __9: int(0..2)
new constraints:
  __9 =aux sum([r,-1;int(1..)])

--

(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__8];int(1..)]) = __2), __3),
FlatWeightedSumLeq([1, 3],[__1, __5],__4),
FlatWeightedSumGeq([1, 3],[__1, __5],__4),
SumLeq([-1, r], __5),
SumGeq([-1, r], __5),
FlatWeightedSumLeq([1, 3],[__1, __7],__6),
FlatWeightedSumGeq([1, 3],[__1, __7],__6),
SumLeq([-1, r], __7),
SumGeq([-1, r], __7),
and([FlatWeightedSumLeq([1, 3],[__1, __9],__8),FlatWeightedSumGeq([1, 3],[__1, __9],__8);int(1..)]),
__9 =aux sum([r,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__8];int(1..)]) = __2), __3),
FlatWeightedSumLeq([1, 3],[__1, __5],__4),
FlatWeightedSumGeq([1, 3],[__1, __5],__4),
SumLeq([-1, r], __5),
SumGeq([-1, r], __5),
FlatWeightedSumLeq([1, 3],[__1, __7],__6),
FlatWeightedSumGeq([1, 3],[__1, __7],__6),
SumLeq([-1, r], __7),
SumGeq([-1, r], __7),
FlatWeightedSumLeq([1, 3],[__1, __9],__8),
FlatWeightedSumGeq([1, 3],[__1, __9],__8),
__9 =aux sum([r,-1;int(1..)])

--

__9 =aux sum([r,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, r], __9),SumGeq([-1, r], __9);int(1..)])

--

(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__8];int(1..)]) = __2), __3),
FlatWeightedSumLeq([1, 3],[__1, __5],__4),
FlatWeightedSumGeq([1, 3],[__1, __5],__4),
SumLeq([-1, r], __5),
SumGeq([-1, r], __5),
FlatWeightedSumLeq([1, 3],[__1, __7],__6),
FlatWeightedSumGeq([1, 3],[__1, __7],__6),
SumLeq([-1, r], __7),
SumGeq([-1, r], __7),
FlatWeightedSumLeq([1, 3],[__1, __9],__8),
FlatWeightedSumGeq([1, 3],[__1, __9],__8),
and([SumLeq([-1, r], __9),SumGeq([-1, r], __9);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__8];int(1..)]) = __2), __3),
FlatWeightedSumLeq([1, 3],[__1, __5],__4),
FlatWeightedSumGeq([1, 3],[__1, __5],__4),
SumLeq([-1, r], __5),
SumGeq([-1, r], __5),
FlatWeightedSumLeq([1, 3],[__1, __7],__6),
FlatWeightedSumGeq([1, 3],[__1, __7],__6),
SumLeq([-1, r], __7),
SumGeq([-1, r], __7),
FlatWeightedSumLeq([1, 3],[__1, __9],__8),
FlatWeightedSumGeq([1, 3],[__1, __9],__8),
SumLeq([-1, r], __9),
SumGeq([-1, r], __9)

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

such that

(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__8];int(1..)]) = __2), __3),
FlatWeightedSumLeq([1, 3],[__1, __5],__4),
FlatWeightedSumGeq([1, 3],[__1, __5],__4),
SumLeq([-1, r], __5),
SumGeq([-1, r], __5),
FlatWeightedSumLeq([1, 3],[__1, __7],__6),
FlatWeightedSumGeq([1, 3],[__1, __7],__6),
SumLeq([-1, r], __7),
SumGeq([-1, r], __7),
FlatWeightedSumLeq([1, 3],[__1, __9],__8),
FlatWeightedSumGeq([1, 3],[__1, __9],__8),
SumLeq([-1, r], __9),
SumGeq([-1, r], __9)

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)

such that

(true != (sum([ __0[__1, c] | r : Index ]) = __2))

--

(true != (sum([ __0[__1, c] | r : Index ]) = __2)), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(true != (sum([ __0[__1, c] | r : Index ]) = __2))
new variables:
  find __0#matrix_to_atom_1_1: int(1..9)
  find __0#matrix_to_atom_1_2: int(1..9)
  find __0#matrix_to_atom_1_3: int(1..9)
  find __0#matrix_to_atom_2_1: int(1..9)
  find __0#matrix_to_atom_2_2: int(1..9)
  find __0#matrix_to_atom_2_3: int(1..9)
  find __0#matrix_to_atom_3_1: int(1..9)
  find __0#matrix_to_atom_3_2: int(1..9)
  find __0#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index

such that

(0 != __0[__1, __2])

--

(0 != __0#matrix_to_atom[__1, __2]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __0#matrix_to_atom[__1, __2])
new variables:
  find __0#matrix_to_atom_1_1: int(1..9)
  find __0#matrix_to_atom_1_2: int(1..9)
  find __0#matrix_to_atom_1_3: int(1..9)
  find __0#matrix_to_atom_2_1: int(1..9)
  find __0#matrix_to_atom_2_2: int(1..9)
  find __0#matrix_to_atom_2_3: int(1..9)
  find __0#matrix_to_atom_3_1: int(1..9)
  find __0#matrix_to_atom_3_2: int(1..9)
  find __0#matrix_to_atom_3_3: int(1..9)

--

__0#matrix_to_atom[__1, __2], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__0#matrix_to_atom[__1, __2] @ and([__inDomain(__1,int(1..3)),__inDomain(__2,int(1..3));int(1..)])}

--

(0 != {__0#matrix_to_atom[__1, __2] @ and([__inDomain(__1,int(1..3)),__inDomain(__2,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __0#matrix_to_atom[__1, __2])

--

(0 != __0#matrix_to_atom[__1, __2]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),product([1,(__2 - 1);int(1..)]),1;int(1..)])])

--

product([1,(__2 - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(__2 - 1);int(1..)])

--

product([(__2 - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(__2 - 1)

--

(__1 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__1,-(1);int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-(1);int(1..)]);int(1..)]),(__2 - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),(__2 - 1),1;int(1..)])])

--

(__2 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__2,-(1);int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([__2,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([__2,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([__2,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),__2,-1,1;int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),__2,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),__2;int(1..)])])

--

[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),__2;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__3]
new variables:
  find __3: int(1..9)
new constraints:
  __3 =aux sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),__2;int(1..)])

--

__3 =aux sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),__2;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[__2, __4],__3),FlatWeightedSumGeq([1, 3],[__2, __4],__3);int(1..)])
new variables:
  find __4: int(0..2)
new constraints:
  __4 =aux sum([__1,-1;int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__3]),
and([FlatWeightedSumLeq([1, 3],[__2, __4],__3),FlatWeightedSumGeq([1, 3],[__2, __4],__3);int(1..)]),
__4 =aux sum([__1,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__3]),
FlatWeightedSumLeq([1, 3],[__2, __4],__3),
FlatWeightedSumGeq([1, 3],[__2, __4],__3),
__4 =aux sum([__1,-1;int(1..)])

--

__4 =aux sum([__1,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __1], __4),SumGeq([-1, __1], __4);int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__3]),
FlatWeightedSumLeq([1, 3],[__2, __4],__3),
FlatWeightedSumGeq([1, 3],[__2, __4],__3),
and([SumLeq([-1, __1], __4),SumGeq([-1, __1], __4);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__3]),
FlatWeightedSumLeq([1, 3],[__2, __4],__3),
FlatWeightedSumGeq([1, 3],[__2, __4],__3),
SumLeq([-1, __1], __4),
SumGeq([-1, __1], __4)

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__3]),
FlatWeightedSumLeq([1, 3],[__2, __4],__3),
FlatWeightedSumGeq([1, 3],[__2, __4],__3),
SumLeq([-1, __1], __4),
SumGeq([-1, __1], __4)

Via-solver generator model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

such that

true

[ __0[__1, c] | r : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[__0[__1, c],__0[__1, c],__0[__1, c];int(1..)]

--

(true != (sum([__0#matrix_to_atom[__1, c],__0#matrix_to_atom[__1, c],__0#matrix_to_atom[__1, c];int(1..)]) = __2)), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(true != (sum([__0#matrix_to_atom[__1, c],__0#matrix_to_atom[__1, c],__0#matrix_to_atom[__1, c];int(1..)]) = __2))

--

__0#matrix_to_atom[__1, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__0#matrix_to_atom[__1, c] @ and([__inDomain(__1,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([{__0#matrix_to_atom[__1, c] @ and([__inDomain(__1,int(1..3)),__inDomain(c,int(1..3));int(1..)])},__0#matrix_to_atom[__1, c],__0#matrix_to_atom[__1, c];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__0#matrix_to_atom[__1, c],__0#matrix_to_atom[__1, c],__0#matrix_to_atom[__1, c];int(1..)]) = __2))

--

__0#matrix_to_atom[__1, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__0#matrix_to_atom[__1, c] @ and([__inDomain(__1,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([__0#matrix_to_atom[__1, c],{__0#matrix_to_atom[__1, c] @ and([__inDomain(__1,int(1..3)),__inDomain(c,int(1..3));int(1..)])},__0#matrix_to_atom[__1, c];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__0#matrix_to_atom[__1, c],__0#matrix_to_atom[__1, c],__0#matrix_to_atom[__1, c];int(1..)]) = __2))

--

__0#matrix_to_atom[__1, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__0#matrix_to_atom[__1, c] @ and([__inDomain(__1,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([__0#matrix_to_atom[__1, c],__0#matrix_to_atom[__1, c],{__0#matrix_to_atom[__1, c] @ and([__inDomain(__1,int(1..3)),__inDomain(c,int(1..3));int(1..)])};int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__0#matrix_to_atom[__1, c],__0#matrix_to_atom[__1, c],__0#matrix_to_atom[__1, c];int(1..)]) = __2))

--

(true != (sum([__0#matrix_to_atom[__1, c],__0#matrix_to_atom[__1, c],__0#matrix_to_atom[__1, c];int(1..)]) = __2)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])];int(1..)]) = __2))

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

(__1 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__1,-(1);int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __2))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __2))

--

sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __2))

--

(__1 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__1,-(1);int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __2))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __2))

--

sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(__1 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __2))

--

(__1 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__1,-(1);int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __2))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])];int(1..)]) = __2))

--

sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])];int(1..)]) = __2)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __2))

--

(true != (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __2)), 
   ~~> flatten_generic ([("Minion", 4200)])
(true != __3)
new variables:
  find __3: bool
new constraints:
  __3 =aux (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __2)

--

__3 =aux (sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __2), 
   ~~> bool_eq_to_reify ([("Minion", 4400)])
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __2), __3)

--

[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4]
new variables:
  find __4: int(1..9)
new constraints:
  __4 =aux sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__4 =aux sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__5, c],__4),FlatWeightedSumGeq([3, 1],[__5, c],__4);int(1..)])
new variables:
  find __5: int(0..2)
new constraints:
  __5 =aux sum([__1,-1;int(1..)])

--

(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __2), __3),
and([FlatWeightedSumLeq([3, 1],[__5, c],__4),FlatWeightedSumGeq([3, 1],[__5, c],__4);int(1..)]),
__5 =aux sum([__1,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __2), __3),
FlatWeightedSumLeq([3, 1],[__5, c],__4),
FlatWeightedSumGeq([3, 1],[__5, c],__4),
__5 =aux sum([__1,-1;int(1..)])

--

__5 =aux sum([__1,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __1], __5),SumGeq([-1, __1], __5);int(1..)])

--

(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __2), __3),
FlatWeightedSumLeq([3, 1],[__5, c],__4),
FlatWeightedSumGeq([3, 1],[__5, c],__4),
and([SumLeq([-1, __1], __5),SumGeq([-1, __1], __5);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __2), __3),
FlatWeightedSumLeq([3, 1],[__5, c],__4),
FlatWeightedSumGeq([3, 1],[__5, c],__4),
SumLeq([-1, __1], __5),
SumGeq([-1, __1], __5)

--

[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6]
new variables:
  find __6: int(1..9)
new constraints:
  __6 =aux sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__6 =aux sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__7, c],__6),FlatWeightedSumGeq([3, 1],[__7, c],__6);int(1..)])
new variables:
  find __7: int(0..2)
new constraints:
  __7 =aux sum([__1,-1;int(1..)])

--

(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __2), __3),
FlatWeightedSumLeq([3, 1],[__5, c],__4),
FlatWeightedSumGeq([3, 1],[__5, c],__4),
SumLeq([-1, __1], __5),
SumGeq([-1, __1], __5),
and([FlatWeightedSumLeq([3, 1],[__7, c],__6),FlatWeightedSumGeq([3, 1],[__7, c],__6);int(1..)]),
__7 =aux sum([__1,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __2), __3),
FlatWeightedSumLeq([3, 1],[__5, c],__4),
FlatWeightedSumGeq([3, 1],[__5, c],__4),
SumLeq([-1, __1], __5),
SumGeq([-1, __1], __5),
FlatWeightedSumLeq([3, 1],[__7, c],__6),
FlatWeightedSumGeq([3, 1],[__7, c],__6),
__7 =aux sum([__1,-1;int(1..)])

--

__7 =aux sum([__1,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __1], __7),SumGeq([-1, __1], __7);int(1..)])

--

(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __2), __3),
FlatWeightedSumLeq([3, 1],[__5, c],__4),
FlatWeightedSumGeq([3, 1],[__5, c],__4),
SumLeq([-1, __1], __5),
SumGeq([-1, __1], __5),
FlatWeightedSumLeq([3, 1],[__7, c],__6),
FlatWeightedSumGeq([3, 1],[__7, c],__6),
and([SumLeq([-1, __1], __7),SumGeq([-1, __1], __7);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __2), __3),
FlatWeightedSumLeq([3, 1],[__5, c],__4),
FlatWeightedSumGeq([3, 1],[__5, c],__4),
SumLeq([-1, __1], __5),
SumGeq([-1, __1], __5),
FlatWeightedSumLeq([3, 1],[__7, c],__6),
FlatWeightedSumGeq([3, 1],[__7, c],__6),
SumLeq([-1, __1], __7),
SumGeq([-1, __1], __7)

--

[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__8]
new variables:
  find __8: int(1..9)
new constraints:
  __8 =aux sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__8 =aux sum([product([3,sum([__1,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__9, c],__8),FlatWeightedSumGeq([3, 1],[__9, c],__8);int(1..)])
new variables:
  find __9: int(0..2)
new constraints:
  __9 =aux sum([__1,-1;int(1..)])

--

(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__8];int(1..)]) = __2), __3),
FlatWeightedSumLeq([3, 1],[__5, c],__4),
FlatWeightedSumGeq([3, 1],[__5, c],__4),
SumLeq([-1, __1], __5),
SumGeq([-1, __1], __5),
FlatWeightedSumLeq([3, 1],[__7, c],__6),
FlatWeightedSumGeq([3, 1],[__7, c],__6),
SumLeq([-1, __1], __7),
SumGeq([-1, __1], __7),
and([FlatWeightedSumLeq([3, 1],[__9, c],__8),FlatWeightedSumGeq([3, 1],[__9, c],__8);int(1..)]),
__9 =aux sum([__1,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__8];int(1..)]) = __2), __3),
FlatWeightedSumLeq([3, 1],[__5, c],__4),
FlatWeightedSumGeq([3, 1],[__5, c],__4),
SumLeq([-1, __1], __5),
SumGeq([-1, __1], __5),
FlatWeightedSumLeq([3, 1],[__7, c],__6),
FlatWeightedSumGeq([3, 1],[__7, c],__6),
SumLeq([-1, __1], __7),
SumGeq([-1, __1], __7),
FlatWeightedSumLeq([3, 1],[__9, c],__8),
FlatWeightedSumGeq([3, 1],[__9, c],__8),
__9 =aux sum([__1,-1;int(1..)])

--

__9 =aux sum([__1,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __1], __9),SumGeq([-1, __1], __9);int(1..)])

--

(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__8];int(1..)]) = __2), __3),
FlatWeightedSumLeq([3, 1],[__5, c],__4),
FlatWeightedSumGeq([3, 1],[__5, c],__4),
SumLeq([-1, __1], __5),
SumGeq([-1, __1], __5),
FlatWeightedSumLeq([3, 1],[__7, c],__6),
FlatWeightedSumGeq([3, 1],[__7, c],__6),
SumLeq([-1, __1], __7),
SumGeq([-1, __1], __7),
FlatWeightedSumLeq([3, 1],[__9, c],__8),
FlatWeightedSumGeq([3, 1],[__9, c],__8),
and([SumLeq([-1, __1], __9),SumGeq([-1, __1], __9);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__8];int(1..)]) = __2), __3),
FlatWeightedSumLeq([3, 1],[__5, c],__4),
FlatWeightedSumGeq([3, 1],[__5, c],__4),
SumLeq([-1, __1], __5),
SumGeq([-1, __1], __5),
FlatWeightedSumLeq([3, 1],[__7, c],__6),
FlatWeightedSumGeq([3, 1],[__7, c],__6),
SumLeq([-1, __1], __7),
SumGeq([-1, __1], __7),
FlatWeightedSumLeq([3, 1],[__9, c],__8),
FlatWeightedSumGeq([3, 1],[__9, c],__8),
SumLeq([-1, __1], __9),
SumGeq([-1, __1], __9)

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

such that

(true != __3),
Reify((sum([[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__4],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__6],[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__8];int(1..)]) = __2), __3),
FlatWeightedSumLeq([3, 1],[__5, c],__4),
FlatWeightedSumGeq([3, 1],[__5, c],__4),
SumLeq([-1, __1], __5),
SumGeq([-1, __1], __5),
FlatWeightedSumLeq([3, 1],[__7, c],__6),
FlatWeightedSumGeq([3, 1],[__7, c],__6),
SumLeq([-1, __1], __7),
SumGeq([-1, __1], __7),
FlatWeightedSumLeq([3, 1],[__9, c],__8),
FlatWeightedSumGeq([3, 1],[__9, c],__8),
SumLeq([-1, __1], __9),
SumGeq([-1, __1], __9)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value

such that

(0 != __0[d, d])

--

(0 != __0#matrix_to_atom[d, d]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __0#matrix_to_atom[d, d])
new variables:
  find __0#matrix_to_atom_1_1: int(1..9)
  find __0#matrix_to_atom_1_2: int(1..9)
  find __0#matrix_to_atom_1_3: int(1..9)
  find __0#matrix_to_atom_2_1: int(1..9)
  find __0#matrix_to_atom_2_2: int(1..9)
  find __0#matrix_to_atom_2_3: int(1..9)
  find __0#matrix_to_atom_3_1: int(1..9)
  find __0#matrix_to_atom_3_2: int(1..9)
  find __0#matrix_to_atom_3_3: int(1..9)

--

__0#matrix_to_atom[d, d], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__0#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}

--

(0 != {__0#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __0#matrix_to_atom[d, d])

--

(0 != __0#matrix_to_atom[d, d]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(d - 1);int(1..)]),1;int(1..)])])

--

product([1,(d - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(d - 1);int(1..)])

--

product([(d - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(d - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(d - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(d - 1),1;int(1..)])])

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])])

--

[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__1]
new variables:
  find __1: int(1..9)
new constraints:
  __1 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])

--

__1 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__2, d],__1),FlatWeightedSumGeq([3, 1],[__2, d],__1);int(1..)])
new variables:
  find __2: int(0..2)
new constraints:
  __2 =aux sum([d,-1;int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__1]),
and([FlatWeightedSumLeq([3, 1],[__2, d],__1),FlatWeightedSumGeq([3, 1],[__2, d],__1);int(1..)]),
__2 =aux sum([d,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__1]),
FlatWeightedSumLeq([3, 1],[__2, d],__1),
FlatWeightedSumGeq([3, 1],[__2, d],__1),
__2 =aux sum([d,-1;int(1..)])

--

__2 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __2),SumGeq([-1, d], __2);int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__1]),
FlatWeightedSumLeq([3, 1],[__2, d],__1),
FlatWeightedSumGeq([3, 1],[__2, d],__1),
and([SumLeq([-1, d], __2),SumGeq([-1, d], __2);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__1]),
FlatWeightedSumLeq([3, 1],[__2, d],__1),
FlatWeightedSumGeq([3, 1],[__2, d],__1),
SumLeq([-1, d], __2),
SumGeq([-1, d], __2)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][__1]),
FlatWeightedSumLeq([3, 1],[__2, d],__1),
FlatWeightedSumGeq([3, 1],[__2, d],__1),
SumLeq([-1, d], __2),
SumGeq([-1, d], __2)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value

such that

(0 != __0[d, (4 - d)])

--

(4 - d), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([4,-(d);int(1..)])

--

(0 != __0#matrix_to_atom[d, sum([4,-(d);int(1..)])]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __0#matrix_to_atom[d, sum([4,-(d);int(1..)])])
new variables:
  find __0#matrix_to_atom_1_1: int(1..9)
  find __0#matrix_to_atom_1_2: int(1..9)
  find __0#matrix_to_atom_1_3: int(1..9)
  find __0#matrix_to_atom_2_1: int(1..9)
  find __0#matrix_to_atom_2_2: int(1..9)
  find __0#matrix_to_atom_2_3: int(1..9)
  find __0#matrix_to_atom_3_1: int(1..9)
  find __0#matrix_to_atom_3_2: int(1..9)
  find __0#matrix_to_atom_3_3: int(1..9)

--

__0#matrix_to_atom[d, sum([4,-(d);int(1..)])], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__0#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

(0 != {__0#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != {__0#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])})

--

(0 != {__0#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> bubble_up ([("Bubble", 8800)])
{(0 != __0#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

{(0 != __0#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}, 
   ~~> expand_bubble ([("Bubble", 8900)])
and([(0 != __0#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)])

--

and([(0 != __0#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __0#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])

--

(0 != __0#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __0#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(0 != __0#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(sum([4,-(d);int(1..)]) - 1);int(1..)])

--

product([(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(sum([4,-(d);int(1..)]) - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(sum([4,-(d);int(1..)]) - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([sum([4,-(d);int(1..)]),-(1);int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-(1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([3,sum([d,-1;int(1..)]);int(1..)]), 
   ~~> flatten_product ([("Minion", 4200)])
product([3,__1;int(1..)])
new variables:
  find __1: int(0..2)
new constraints:
  __1 =aux sum([d,-1;int(1..)])

--

__1 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __1),SumGeq([-1, d], __1);int(1..)])

--

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,__1;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
and([SumLeq([-1, d], __1),SumGeq([-1, d], __1);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,__1;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __1),
SumGeq([-1, d], __1)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__0#matrix_to_atom_1_1,__0#matrix_to_atom_1_2,__0#matrix_to_atom_1_3,__0#matrix_to_atom_2_1,__0#matrix_to_atom_2_2,__0#matrix_to_atom_2_3,__0#matrix_to_atom_3_1,__0#matrix_to_atom_3_2,__0#matrix_to_atom_3_3;int(1..)][sum([product([3,__1;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __1),
SumGeq([-1, d], __1)

Via-solver generator model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

such that

true

[ (sum([ square[r, c] | c : Index ]) = s) | r : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[(sum([ square[1, c] | c : Index ]) = s),(sum([ square[2, c] | c : Index ]) = s),(sum([ square[3, c] | c : Index ]) = s);int(1..)]

--

allDiff(flatten(square)),
and([(sum([ square[1, c] | c : Index ]) = s),(sum([ square[2, c] | c : Index ]) = s),(sum([ square[3, c] | c : Index ]) = s);int(1..)]),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([ square[1, c] | c : Index ]) = s),
(sum([ square[2, c] | c : Index ]) = s),
(sum([ square[3, c] | c : Index ]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

such that

(0 != __4[1, c])

--

(0 != __4#matrix_to_atom[1, c]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __4#matrix_to_atom[1, c])
new variables:
  find __4#matrix_to_atom_1_1: int(1..9)
  find __4#matrix_to_atom_1_2: int(1..9)
  find __4#matrix_to_atom_1_3: int(1..9)
  find __4#matrix_to_atom_2_1: int(1..9)
  find __4#matrix_to_atom_2_2: int(1..9)
  find __4#matrix_to_atom_2_3: int(1..9)
  find __4#matrix_to_atom_3_1: int(1..9)
  find __4#matrix_to_atom_3_2: int(1..9)
  find __4#matrix_to_atom_3_3: int(1..9)

--

__4#matrix_to_atom[1, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__4#matrix_to_atom[1, c] @ and([__inDomain(1,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(0 != {__4#matrix_to_atom[1, c] @ and([__inDomain(1,int(1..3)),__inDomain(c,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __4#matrix_to_atom[1, c])

--

(0 != __4#matrix_to_atom[1, c]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([product([3,(1 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])])

--

(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([product([3,(1 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([product([1,(c - 1);int(1..)]),1;int(1..)])])

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([sum([c,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([sum([c,-1;int(1..)]),1;int(1..)])])

--

sum([sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([c,-1,1;int(1..)])

--

(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([c,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([c;int(1..)])])

--

sum([c;int(1..)]), 
   ~~> remove_unit_vector_sum ([("Base", 8800)])
c

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][c])

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)

such that

(0 != __5[2, c])

--

(0 != __5#matrix_to_atom[2, c]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __5#matrix_to_atom[2, c])
new variables:
  find __5#matrix_to_atom_1_1: int(1..9)
  find __5#matrix_to_atom_1_2: int(1..9)
  find __5#matrix_to_atom_1_3: int(1..9)
  find __5#matrix_to_atom_2_1: int(1..9)
  find __5#matrix_to_atom_2_2: int(1..9)
  find __5#matrix_to_atom_2_3: int(1..9)
  find __5#matrix_to_atom_3_1: int(1..9)
  find __5#matrix_to_atom_3_2: int(1..9)
  find __5#matrix_to_atom_3_3: int(1..9)

--

__5#matrix_to_atom[2, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__5#matrix_to_atom[2, c] @ and([__inDomain(2,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(0 != {__5#matrix_to_atom[2, c] @ and([__inDomain(2,int(1..3)),__inDomain(c,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __5#matrix_to_atom[2, c])

--

(0 != __5#matrix_to_atom[2, c]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([product([3,(2 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])])

--

(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([product([3,(2 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([product([1,(c - 1);int(1..)]),4;int(1..)])])

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([sum([c,-(1);int(1..)]),4;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([sum([c,-1;int(1..)]),4;int(1..)])])

--

sum([sum([c,-1;int(1..)]),4;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([c,-1,4;int(1..)])

--

(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([c,-1,4;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([c,3;int(1..)])])

--

[__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([c,3;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][__6]
new variables:
  find __6: int(4..6)
new constraints:
  __6 =aux sum([c,3;int(1..)])

--

__6 =aux sum([c,3;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([3, c], __6),SumGeq([3, c], __6);int(1..)])

--

(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][__6]),
and([SumLeq([3, c], __6),SumGeq([3, c], __6);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][__6]),
SumLeq([3, c], __6),
SumGeq([3, c], __6)

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][__6]),
SumLeq([3, c], __6),
SumGeq([3, c], __6)

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)

such that

(0 != __7[3, c])

--

(0 != __7#matrix_to_atom[3, c]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __7#matrix_to_atom[3, c])
new variables:
  find __7#matrix_to_atom_1_1: int(1..9)
  find __7#matrix_to_atom_1_2: int(1..9)
  find __7#matrix_to_atom_1_3: int(1..9)
  find __7#matrix_to_atom_2_1: int(1..9)
  find __7#matrix_to_atom_2_2: int(1..9)
  find __7#matrix_to_atom_2_3: int(1..9)
  find __7#matrix_to_atom_3_1: int(1..9)
  find __7#matrix_to_atom_3_2: int(1..9)
  find __7#matrix_to_atom_3_3: int(1..9)

--

__7#matrix_to_atom[3, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__7#matrix_to_atom[3, c] @ and([__inDomain(3,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(0 != {__7#matrix_to_atom[3, c] @ and([__inDomain(3,int(1..3)),__inDomain(c,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __7#matrix_to_atom[3, c])

--

(0 != __7#matrix_to_atom[3, c]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__7#matrix_to_atom_1_1,__7#matrix_to_atom_1_2,__7#matrix_to_atom_1_3,__7#matrix_to_atom_2_1,__7#matrix_to_atom_2_2,__7#matrix_to_atom_2_3,__7#matrix_to_atom_3_1,__7#matrix_to_atom_3_2,__7#matrix_to_atom_3_3;int(1..)][sum([product([3,(3 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])])

--

(0 != [__7#matrix_to_atom_1_1,__7#matrix_to_atom_1_2,__7#matrix_to_atom_1_3,__7#matrix_to_atom_2_1,__7#matrix_to_atom_2_2,__7#matrix_to_atom_2_3,__7#matrix_to_atom_3_1,__7#matrix_to_atom_3_2,__7#matrix_to_atom_3_3;int(1..)][sum([product([3,(3 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__7#matrix_to_atom_1_1,__7#matrix_to_atom_1_2,__7#matrix_to_atom_1_3,__7#matrix_to_atom_2_1,__7#matrix_to_atom_2_2,__7#matrix_to_atom_2_3,__7#matrix_to_atom_3_1,__7#matrix_to_atom_3_2,__7#matrix_to_atom_3_3;int(1..)][sum([product([1,(c - 1);int(1..)]),7;int(1..)])])

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(0 != [__7#matrix_to_atom_1_1,__7#matrix_to_atom_1_2,__7#matrix_to_atom_1_3,__7#matrix_to_atom_2_1,__7#matrix_to_atom_2_2,__7#matrix_to_atom_2_3,__7#matrix_to_atom_3_1,__7#matrix_to_atom_3_2,__7#matrix_to_atom_3_3;int(1..)][sum([sum([c,-(1);int(1..)]),7;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__7#matrix_to_atom_1_1,__7#matrix_to_atom_1_2,__7#matrix_to_atom_1_3,__7#matrix_to_atom_2_1,__7#matrix_to_atom_2_2,__7#matrix_to_atom_2_3,__7#matrix_to_atom_3_1,__7#matrix_to_atom_3_2,__7#matrix_to_atom_3_3;int(1..)][sum([sum([c,-1;int(1..)]),7;int(1..)])])

--

sum([sum([c,-1;int(1..)]),7;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([c,-1,7;int(1..)])

--

(0 != [__7#matrix_to_atom_1_1,__7#matrix_to_atom_1_2,__7#matrix_to_atom_1_3,__7#matrix_to_atom_2_1,__7#matrix_to_atom_2_2,__7#matrix_to_atom_2_3,__7#matrix_to_atom_3_1,__7#matrix_to_atom_3_2,__7#matrix_to_atom_3_3;int(1..)][sum([c,-1,7;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__7#matrix_to_atom_1_1,__7#matrix_to_atom_1_2,__7#matrix_to_atom_1_3,__7#matrix_to_atom_2_1,__7#matrix_to_atom_2_2,__7#matrix_to_atom_2_3,__7#matrix_to_atom_3_1,__7#matrix_to_atom_3_2,__7#matrix_to_atom_3_3;int(1..)][sum([c,6;int(1..)])])

--

[__7#matrix_to_atom_1_1,__7#matrix_to_atom_1_2,__7#matrix_to_atom_1_3,__7#matrix_to_atom_2_1,__7#matrix_to_atom_2_2,__7#matrix_to_atom_2_3,__7#matrix_to_atom_3_1,__7#matrix_to_atom_3_2,__7#matrix_to_atom_3_3;int(1..)][sum([c,6;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__7#matrix_to_atom_1_1,__7#matrix_to_atom_1_2,__7#matrix_to_atom_1_3,__7#matrix_to_atom_2_1,__7#matrix_to_atom_2_2,__7#matrix_to_atom_2_3,__7#matrix_to_atom_3_1,__7#matrix_to_atom_3_2,__7#matrix_to_atom_3_3;int(1..)][__8]
new variables:
  find __8: int(7..9)
new constraints:
  __8 =aux sum([c,6;int(1..)])

--

__8 =aux sum([c,6;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([6, c], __8),SumGeq([6, c], __8);int(1..)])

--

(0 != [__7#matrix_to_atom_1_1,__7#matrix_to_atom_1_2,__7#matrix_to_atom_1_3,__7#matrix_to_atom_2_1,__7#matrix_to_atom_2_2,__7#matrix_to_atom_2_3,__7#matrix_to_atom_3_1,__7#matrix_to_atom_3_2,__7#matrix_to_atom_3_3;int(1..)][__8]),
and([SumLeq([6, c], __8),SumGeq([6, c], __8);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__7#matrix_to_atom_1_1,__7#matrix_to_atom_1_2,__7#matrix_to_atom_1_3,__7#matrix_to_atom_2_1,__7#matrix_to_atom_2_2,__7#matrix_to_atom_2_3,__7#matrix_to_atom_3_1,__7#matrix_to_atom_3_2,__7#matrix_to_atom_3_3;int(1..)][__8]),
SumLeq([6, c], __8),
SumGeq([6, c], __8)

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__7#matrix_to_atom_1_1,__7#matrix_to_atom_1_2,__7#matrix_to_atom_1_3,__7#matrix_to_atom_2_1,__7#matrix_to_atom_2_2,__7#matrix_to_atom_2_3,__7#matrix_to_atom_3_1,__7#matrix_to_atom_3_2,__7#matrix_to_atom_3_3;int(1..)][__8]),
SumLeq([6, c], __8),
SumGeq([6, c], __8)

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: int(1..24)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

such that

(true != (sum([ __10[__11, c] | r : Index ]) = __12))

--

(true != (sum([ __10[__11, c] | r : Index ]) = __12)), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(true != (sum([ __10[__11, c] | r : Index ]) = __12))
new variables:
  find __10#matrix_to_atom_1_1: int(1..9)
  find __10#matrix_to_atom_1_2: int(1..9)
  find __10#matrix_to_atom_1_3: int(1..9)
  find __10#matrix_to_atom_2_1: int(1..9)
  find __10#matrix_to_atom_2_2: int(1..9)
  find __10#matrix_to_atom_2_3: int(1..9)
  find __10#matrix_to_atom_3_1: int(1..9)
  find __10#matrix_to_atom_3_2: int(1..9)
  find __10#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

such that

(0 != __5[__6, __7])

--

(0 != __5#matrix_to_atom[__6, __7]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __5#matrix_to_atom[__6, __7])
new variables:
  find __5#matrix_to_atom_1_1: int(1..9)
  find __5#matrix_to_atom_1_2: int(1..9)
  find __5#matrix_to_atom_1_3: int(1..9)
  find __5#matrix_to_atom_2_1: int(1..9)
  find __5#matrix_to_atom_2_2: int(1..9)
  find __5#matrix_to_atom_2_3: int(1..9)
  find __5#matrix_to_atom_3_1: int(1..9)
  find __5#matrix_to_atom_3_2: int(1..9)
  find __5#matrix_to_atom_3_3: int(1..9)

--

__5#matrix_to_atom[__6, __7], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__5#matrix_to_atom[__6, __7] @ and([__inDomain(__6,int(1..3)),__inDomain(__7,int(1..3));int(1..)])}

--

(0 != {__5#matrix_to_atom[__6, __7] @ and([__inDomain(__6,int(1..3)),__inDomain(__7,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __5#matrix_to_atom[__6, __7])

--

(0 != __5#matrix_to_atom[__6, __7]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([product([3,(__6 - 1);int(1..)]),product([1,(__7 - 1);int(1..)]),1;int(1..)])])

--

product([1,(__7 - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(__7 - 1);int(1..)])

--

product([(__7 - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(__7 - 1)

--

(__6 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__6,-(1);int(1..)])

--

(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__6,-(1);int(1..)]);int(1..)]),(__7 - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__6,-1;int(1..)]);int(1..)]),(__7 - 1),1;int(1..)])])

--

(__7 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__7,-(1);int(1..)])

--

(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__6,-1;int(1..)]);int(1..)]),sum([__7,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__6,-1;int(1..)]);int(1..)]),sum([__7,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([__6,-1;int(1..)]);int(1..)]),sum([__7,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__6,-1;int(1..)]);int(1..)]),__7,-1,1;int(1..)])

--

(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__6,-1;int(1..)]);int(1..)]),__7,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__6,-1;int(1..)]);int(1..)]),__7;int(1..)])])

--

[__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__6,-1;int(1..)]);int(1..)]),__7;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][__8]
new variables:
  find __8: int(1..9)
new constraints:
  __8 =aux sum([product([3,sum([__6,-1;int(1..)]);int(1..)]),__7;int(1..)])

--

__8 =aux sum([product([3,sum([__6,-1;int(1..)]);int(1..)]),__7;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[__7, __9],__8),FlatWeightedSumGeq([1, 3],[__7, __9],__8);int(1..)])
new variables:
  find __9: int(0..2)
new constraints:
  __9 =aux sum([__6,-1;int(1..)])

--

(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][__8]),
and([FlatWeightedSumLeq([1, 3],[__7, __9],__8),FlatWeightedSumGeq([1, 3],[__7, __9],__8);int(1..)]),
__9 =aux sum([__6,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][__8]),
FlatWeightedSumLeq([1, 3],[__7, __9],__8),
FlatWeightedSumGeq([1, 3],[__7, __9],__8),
__9 =aux sum([__6,-1;int(1..)])

--

__9 =aux sum([__6,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __6], __9),SumGeq([-1, __6], __9);int(1..)])

--

(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][__8]),
FlatWeightedSumLeq([1, 3],[__7, __9],__8),
FlatWeightedSumGeq([1, 3],[__7, __9],__8),
and([SumLeq([-1, __6], __9),SumGeq([-1, __6], __9);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][__8]),
FlatWeightedSumLeq([1, 3],[__7, __9],__8),
FlatWeightedSumGeq([1, 3],[__7, __9],__8),
SumLeq([-1, __6], __9),
SumGeq([-1, __6], __9)

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__5#matrix_to_atom_1_1,__5#matrix_to_atom_1_2,__5#matrix_to_atom_1_3,__5#matrix_to_atom_2_1,__5#matrix_to_atom_2_2,__5#matrix_to_atom_2_3,__5#matrix_to_atom_3_1,__5#matrix_to_atom_3_2,__5#matrix_to_atom_3_3;int(1..)][__8]),
FlatWeightedSumLeq([1, 3],[__7, __9],__8),
FlatWeightedSumGeq([1, 3],[__7, __9],__8),
SumLeq([-1, __6], __9),
SumGeq([-1, __6], __9)

Via-solver generator model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)

such that

true

[ __10[__11, c] | r : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[__10[__11, c],__10[__11, c],__10[__11, c];int(1..)]

--

(true != (sum([__10#matrix_to_atom[__11, c],__10#matrix_to_atom[__11, c],__10#matrix_to_atom[__11, c];int(1..)]) = __12)), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(true != (sum([__10#matrix_to_atom[__11, c],__10#matrix_to_atom[__11, c],__10#matrix_to_atom[__11, c];int(1..)]) = __12))

--

__10#matrix_to_atom[__11, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__10#matrix_to_atom[__11, c] @ and([__inDomain(__11,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([{__10#matrix_to_atom[__11, c] @ and([__inDomain(__11,int(1..3)),__inDomain(c,int(1..3));int(1..)])},__10#matrix_to_atom[__11, c],__10#matrix_to_atom[__11, c];int(1..)]) = __12)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__10#matrix_to_atom[__11, c],__10#matrix_to_atom[__11, c],__10#matrix_to_atom[__11, c];int(1..)]) = __12))

--

__10#matrix_to_atom[__11, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__10#matrix_to_atom[__11, c] @ and([__inDomain(__11,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([__10#matrix_to_atom[__11, c],{__10#matrix_to_atom[__11, c] @ and([__inDomain(__11,int(1..3)),__inDomain(c,int(1..3));int(1..)])},__10#matrix_to_atom[__11, c];int(1..)]) = __12)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__10#matrix_to_atom[__11, c],__10#matrix_to_atom[__11, c],__10#matrix_to_atom[__11, c];int(1..)]) = __12))

--

__10#matrix_to_atom[__11, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__10#matrix_to_atom[__11, c] @ and([__inDomain(__11,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([__10#matrix_to_atom[__11, c],__10#matrix_to_atom[__11, c],{__10#matrix_to_atom[__11, c] @ and([__inDomain(__11,int(1..3)),__inDomain(c,int(1..3));int(1..)])};int(1..)]) = __12)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__10#matrix_to_atom[__11, c],__10#matrix_to_atom[__11, c],__10#matrix_to_atom[__11, c];int(1..)]) = __12))

--

(true != (sum([__10#matrix_to_atom[__11, c],__10#matrix_to_atom[__11, c],__10#matrix_to_atom[__11, c];int(1..)]) = __12)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])];int(1..)]) = __12))

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

(__11 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__11,-(1);int(1..)])

--

(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __12)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __12))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __12)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __12))

--

sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __12)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __12))

--

(__11 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__11,-(1);int(1..)])

--

(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __12)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __12))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __12)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __12))

--

sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __12)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __12))

--

(__11 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__11,-(1);int(1..)])

--

(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __12)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __12))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])];int(1..)]) = __12)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])];int(1..)]) = __12))

--

sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])];int(1..)]) = __12)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __12))

--

(true != (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __12)), 
   ~~> flatten_generic ([("Minion", 4200)])
(true != __13)
new variables:
  find __13: bool
new constraints:
  __13 =aux (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __12)

--

__13 =aux (sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __12), 
   ~~> bool_eq_to_reify ([("Minion", 4400)])
Reify((sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __12), __13)

--

[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__14]
new variables:
  find __14: int(1..9)
new constraints:
  __14 =aux sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__14 =aux sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__15, c],__14),FlatWeightedSumGeq([3, 1],[__15, c],__14);int(1..)])
new variables:
  find __15: int(0..2)
new constraints:
  __15 =aux sum([__11,-1;int(1..)])

--

(true != __13),
Reify((sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__14],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __12), __13),
and([FlatWeightedSumLeq([3, 1],[__15, c],__14),FlatWeightedSumGeq([3, 1],[__15, c],__14);int(1..)]),
__15 =aux sum([__11,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __13),
Reify((sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__14],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __12), __13),
FlatWeightedSumLeq([3, 1],[__15, c],__14),
FlatWeightedSumGeq([3, 1],[__15, c],__14),
__15 =aux sum([__11,-1;int(1..)])

--

__15 =aux sum([__11,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __11], __15),SumGeq([-1, __11], __15);int(1..)])

--

(true != __13),
Reify((sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__14],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __12), __13),
FlatWeightedSumLeq([3, 1],[__15, c],__14),
FlatWeightedSumGeq([3, 1],[__15, c],__14),
and([SumLeq([-1, __11], __15),SumGeq([-1, __11], __15);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __13),
Reify((sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__14],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __12), __13),
FlatWeightedSumLeq([3, 1],[__15, c],__14),
FlatWeightedSumGeq([3, 1],[__15, c],__14),
SumLeq([-1, __11], __15),
SumGeq([-1, __11], __15)

--

[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__16]
new variables:
  find __16: int(1..9)
new constraints:
  __16 =aux sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__16 =aux sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__17, c],__16),FlatWeightedSumGeq([3, 1],[__17, c],__16);int(1..)])
new variables:
  find __17: int(0..2)
new constraints:
  __17 =aux sum([__11,-1;int(1..)])

--

(true != __13),
Reify((sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__14],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__16],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __12), __13),
FlatWeightedSumLeq([3, 1],[__15, c],__14),
FlatWeightedSumGeq([3, 1],[__15, c],__14),
SumLeq([-1, __11], __15),
SumGeq([-1, __11], __15),
and([FlatWeightedSumLeq([3, 1],[__17, c],__16),FlatWeightedSumGeq([3, 1],[__17, c],__16);int(1..)]),
__17 =aux sum([__11,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __13),
Reify((sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__14],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__16],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __12), __13),
FlatWeightedSumLeq([3, 1],[__15, c],__14),
FlatWeightedSumGeq([3, 1],[__15, c],__14),
SumLeq([-1, __11], __15),
SumGeq([-1, __11], __15),
FlatWeightedSumLeq([3, 1],[__17, c],__16),
FlatWeightedSumGeq([3, 1],[__17, c],__16),
__17 =aux sum([__11,-1;int(1..)])

--

__17 =aux sum([__11,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __11], __17),SumGeq([-1, __11], __17);int(1..)])

--

(true != __13),
Reify((sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__14],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__16],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __12), __13),
FlatWeightedSumLeq([3, 1],[__15, c],__14),
FlatWeightedSumGeq([3, 1],[__15, c],__14),
SumLeq([-1, __11], __15),
SumGeq([-1, __11], __15),
FlatWeightedSumLeq([3, 1],[__17, c],__16),
FlatWeightedSumGeq([3, 1],[__17, c],__16),
and([SumLeq([-1, __11], __17),SumGeq([-1, __11], __17);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __13),
Reify((sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__14],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__16],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __12), __13),
FlatWeightedSumLeq([3, 1],[__15, c],__14),
FlatWeightedSumGeq([3, 1],[__15, c],__14),
SumLeq([-1, __11], __15),
SumGeq([-1, __11], __15),
FlatWeightedSumLeq([3, 1],[__17, c],__16),
FlatWeightedSumGeq([3, 1],[__17, c],__16),
SumLeq([-1, __11], __17),
SumGeq([-1, __11], __17)

--

[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__18]
new variables:
  find __18: int(1..9)
new constraints:
  __18 =aux sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__18 =aux sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__19, c],__18),FlatWeightedSumGeq([3, 1],[__19, c],__18);int(1..)])
new variables:
  find __19: int(0..2)
new constraints:
  __19 =aux sum([__11,-1;int(1..)])

--

(true != __13),
Reify((sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__14],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__16],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__18];int(1..)]) = __12), __13),
FlatWeightedSumLeq([3, 1],[__15, c],__14),
FlatWeightedSumGeq([3, 1],[__15, c],__14),
SumLeq([-1, __11], __15),
SumGeq([-1, __11], __15),
FlatWeightedSumLeq([3, 1],[__17, c],__16),
FlatWeightedSumGeq([3, 1],[__17, c],__16),
SumLeq([-1, __11], __17),
SumGeq([-1, __11], __17),
and([FlatWeightedSumLeq([3, 1],[__19, c],__18),FlatWeightedSumGeq([3, 1],[__19, c],__18);int(1..)]),
__19 =aux sum([__11,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __13),
Reify((sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__14],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__16],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__18];int(1..)]) = __12), __13),
FlatWeightedSumLeq([3, 1],[__15, c],__14),
FlatWeightedSumGeq([3, 1],[__15, c],__14),
SumLeq([-1, __11], __15),
SumGeq([-1, __11], __15),
FlatWeightedSumLeq([3, 1],[__17, c],__16),
FlatWeightedSumGeq([3, 1],[__17, c],__16),
SumLeq([-1, __11], __17),
SumGeq([-1, __11], __17),
FlatWeightedSumLeq([3, 1],[__19, c],__18),
FlatWeightedSumGeq([3, 1],[__19, c],__18),
__19 =aux sum([__11,-1;int(1..)])

--

__19 =aux sum([__11,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __11], __19),SumGeq([-1, __11], __19);int(1..)])

--

(true != __13),
Reify((sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__14],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__16],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__18];int(1..)]) = __12), __13),
FlatWeightedSumLeq([3, 1],[__15, c],__14),
FlatWeightedSumGeq([3, 1],[__15, c],__14),
SumLeq([-1, __11], __15),
SumGeq([-1, __11], __15),
FlatWeightedSumLeq([3, 1],[__17, c],__16),
FlatWeightedSumGeq([3, 1],[__17, c],__16),
SumLeq([-1, __11], __17),
SumGeq([-1, __11], __17),
FlatWeightedSumLeq([3, 1],[__19, c],__18),
FlatWeightedSumGeq([3, 1],[__19, c],__18),
and([SumLeq([-1, __11], __19),SumGeq([-1, __11], __19);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __13),
Reify((sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__14],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__16],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__18];int(1..)]) = __12), __13),
FlatWeightedSumLeq([3, 1],[__15, c],__14),
FlatWeightedSumGeq([3, 1],[__15, c],__14),
SumLeq([-1, __11], __15),
SumGeq([-1, __11], __15),
FlatWeightedSumLeq([3, 1],[__17, c],__16),
FlatWeightedSumGeq([3, 1],[__17, c],__16),
SumLeq([-1, __11], __17),
SumGeq([-1, __11], __17),
FlatWeightedSumLeq([3, 1],[__19, c],__18),
FlatWeightedSumGeq([3, 1],[__19, c],__18),
SumLeq([-1, __11], __19),
SumGeq([-1, __11], __19)

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: int(1..24)
find __13: bool
find __14: int(1..9)
find __15: int(0..2)
find __16: int(1..9)
find __17: int(0..2)
find __18: int(1..9)
find __19: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)

such that

(true != __13),
Reify((sum([[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__14],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__16],[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__18];int(1..)]) = __12), __13),
FlatWeightedSumLeq([3, 1],[__15, c],__14),
FlatWeightedSumGeq([3, 1],[__15, c],__14),
SumLeq([-1, __11], __15),
SumGeq([-1, __11], __15),
FlatWeightedSumLeq([3, 1],[__17, c],__16),
FlatWeightedSumGeq([3, 1],[__17, c],__16),
SumLeq([-1, __11], __17),
SumGeq([-1, __11], __17),
FlatWeightedSumLeq([3, 1],[__19, c],__18),
FlatWeightedSumGeq([3, 1],[__19, c],__18),
SumLeq([-1, __11], __19),
SumGeq([-1, __11], __19)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

such that

(0 != __3[d, d])

--

(0 != __3#matrix_to_atom[d, d]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __3#matrix_to_atom[d, d])
new variables:
  find __3#matrix_to_atom_1_1: int(1..9)
  find __3#matrix_to_atom_1_2: int(1..9)
  find __3#matrix_to_atom_1_3: int(1..9)
  find __3#matrix_to_atom_2_1: int(1..9)
  find __3#matrix_to_atom_2_2: int(1..9)
  find __3#matrix_to_atom_2_3: int(1..9)
  find __3#matrix_to_atom_3_1: int(1..9)
  find __3#matrix_to_atom_3_2: int(1..9)
  find __3#matrix_to_atom_3_3: int(1..9)

--

__3#matrix_to_atom[d, d], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__3#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}

--

(0 != {__3#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __3#matrix_to_atom[d, d])

--

(0 != __3#matrix_to_atom[d, d]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__3#matrix_to_atom_1_1,__3#matrix_to_atom_1_2,__3#matrix_to_atom_1_3,__3#matrix_to_atom_2_1,__3#matrix_to_atom_2_2,__3#matrix_to_atom_2_3,__3#matrix_to_atom_3_1,__3#matrix_to_atom_3_2,__3#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(d - 1);int(1..)]),1;int(1..)])])

--

product([1,(d - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(d - 1);int(1..)])

--

product([(d - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(d - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__3#matrix_to_atom_1_1,__3#matrix_to_atom_1_2,__3#matrix_to_atom_1_3,__3#matrix_to_atom_2_1,__3#matrix_to_atom_2_2,__3#matrix_to_atom_2_3,__3#matrix_to_atom_3_1,__3#matrix_to_atom_3_2,__3#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(d - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__3#matrix_to_atom_1_1,__3#matrix_to_atom_1_2,__3#matrix_to_atom_1_3,__3#matrix_to_atom_2_1,__3#matrix_to_atom_2_2,__3#matrix_to_atom_2_3,__3#matrix_to_atom_3_1,__3#matrix_to_atom_3_2,__3#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(d - 1),1;int(1..)])])

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__3#matrix_to_atom_1_1,__3#matrix_to_atom_1_2,__3#matrix_to_atom_1_3,__3#matrix_to_atom_2_1,__3#matrix_to_atom_2_2,__3#matrix_to_atom_2_3,__3#matrix_to_atom_3_1,__3#matrix_to_atom_3_2,__3#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__3#matrix_to_atom_1_1,__3#matrix_to_atom_1_2,__3#matrix_to_atom_1_3,__3#matrix_to_atom_2_1,__3#matrix_to_atom_2_2,__3#matrix_to_atom_2_3,__3#matrix_to_atom_3_1,__3#matrix_to_atom_3_2,__3#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])

--

(0 != [__3#matrix_to_atom_1_1,__3#matrix_to_atom_1_2,__3#matrix_to_atom_1_3,__3#matrix_to_atom_2_1,__3#matrix_to_atom_2_2,__3#matrix_to_atom_2_3,__3#matrix_to_atom_3_1,__3#matrix_to_atom_3_2,__3#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__3#matrix_to_atom_1_1,__3#matrix_to_atom_1_2,__3#matrix_to_atom_1_3,__3#matrix_to_atom_2_1,__3#matrix_to_atom_2_2,__3#matrix_to_atom_2_3,__3#matrix_to_atom_3_1,__3#matrix_to_atom_3_2,__3#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])])

--

[__3#matrix_to_atom_1_1,__3#matrix_to_atom_1_2,__3#matrix_to_atom_1_3,__3#matrix_to_atom_2_1,__3#matrix_to_atom_2_2,__3#matrix_to_atom_2_3,__3#matrix_to_atom_3_1,__3#matrix_to_atom_3_2,__3#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__3#matrix_to_atom_1_1,__3#matrix_to_atom_1_2,__3#matrix_to_atom_1_3,__3#matrix_to_atom_2_1,__3#matrix_to_atom_2_2,__3#matrix_to_atom_2_3,__3#matrix_to_atom_3_1,__3#matrix_to_atom_3_2,__3#matrix_to_atom_3_3;int(1..)][__4]
new variables:
  find __4: int(1..9)
new constraints:
  __4 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])

--

__4 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__5, d],__4),FlatWeightedSumGeq([3, 1],[__5, d],__4);int(1..)])
new variables:
  find __5: int(0..2)
new constraints:
  __5 =aux sum([d,-1;int(1..)])

--

(0 != [__3#matrix_to_atom_1_1,__3#matrix_to_atom_1_2,__3#matrix_to_atom_1_3,__3#matrix_to_atom_2_1,__3#matrix_to_atom_2_2,__3#matrix_to_atom_2_3,__3#matrix_to_atom_3_1,__3#matrix_to_atom_3_2,__3#matrix_to_atom_3_3;int(1..)][__4]),
and([FlatWeightedSumLeq([3, 1],[__5, d],__4),FlatWeightedSumGeq([3, 1],[__5, d],__4);int(1..)]),
__5 =aux sum([d,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__3#matrix_to_atom_1_1,__3#matrix_to_atom_1_2,__3#matrix_to_atom_1_3,__3#matrix_to_atom_2_1,__3#matrix_to_atom_2_2,__3#matrix_to_atom_2_3,__3#matrix_to_atom_3_1,__3#matrix_to_atom_3_2,__3#matrix_to_atom_3_3;int(1..)][__4]),
FlatWeightedSumLeq([3, 1],[__5, d],__4),
FlatWeightedSumGeq([3, 1],[__5, d],__4),
__5 =aux sum([d,-1;int(1..)])

--

__5 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __5),SumGeq([-1, d], __5);int(1..)])

--

(0 != [__3#matrix_to_atom_1_1,__3#matrix_to_atom_1_2,__3#matrix_to_atom_1_3,__3#matrix_to_atom_2_1,__3#matrix_to_atom_2_2,__3#matrix_to_atom_2_3,__3#matrix_to_atom_3_1,__3#matrix_to_atom_3_2,__3#matrix_to_atom_3_3;int(1..)][__4]),
FlatWeightedSumLeq([3, 1],[__5, d],__4),
FlatWeightedSumGeq([3, 1],[__5, d],__4),
and([SumLeq([-1, d], __5),SumGeq([-1, d], __5);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__3#matrix_to_atom_1_1,__3#matrix_to_atom_1_2,__3#matrix_to_atom_1_3,__3#matrix_to_atom_2_1,__3#matrix_to_atom_2_2,__3#matrix_to_atom_2_3,__3#matrix_to_atom_3_1,__3#matrix_to_atom_3_2,__3#matrix_to_atom_3_3;int(1..)][__4]),
FlatWeightedSumLeq([3, 1],[__5, d],__4),
FlatWeightedSumGeq([3, 1],[__5, d],__4),
SumLeq([-1, d], __5),
SumGeq([-1, d], __5)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__3#matrix_to_atom_1_1,__3#matrix_to_atom_1_2,__3#matrix_to_atom_1_3,__3#matrix_to_atom_2_1,__3#matrix_to_atom_2_2,__3#matrix_to_atom_2_3,__3#matrix_to_atom_3_1,__3#matrix_to_atom_3_2,__3#matrix_to_atom_3_3;int(1..)][__4]),
FlatWeightedSumLeq([3, 1],[__5, d],__4),
FlatWeightedSumGeq([3, 1],[__5, d],__4),
SumLeq([-1, d], __5),
SumGeq([-1, d], __5)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)

such that

(0 != __2[d, (4 - d)])

--

(4 - d), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([4,-(d);int(1..)])

--

(0 != __2#matrix_to_atom[d, sum([4,-(d);int(1..)])]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __2#matrix_to_atom[d, sum([4,-(d);int(1..)])])
new variables:
  find __2#matrix_to_atom_1_1: int(1..9)
  find __2#matrix_to_atom_1_2: int(1..9)
  find __2#matrix_to_atom_1_3: int(1..9)
  find __2#matrix_to_atom_2_1: int(1..9)
  find __2#matrix_to_atom_2_2: int(1..9)
  find __2#matrix_to_atom_2_3: int(1..9)
  find __2#matrix_to_atom_3_1: int(1..9)
  find __2#matrix_to_atom_3_2: int(1..9)
  find __2#matrix_to_atom_3_3: int(1..9)

--

__2#matrix_to_atom[d, sum([4,-(d);int(1..)])], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__2#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

(0 != {__2#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != {__2#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])})

--

(0 != {__2#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> bubble_up ([("Bubble", 8800)])
{(0 != __2#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

{(0 != __2#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}, 
   ~~> expand_bubble ([("Bubble", 8900)])
and([(0 != __2#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)])

--

and([(0 != __2#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __2#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])

--

(0 != __2#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __2#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(0 != __2#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__2#matrix_to_atom_1_1,__2#matrix_to_atom_1_2,__2#matrix_to_atom_1_3,__2#matrix_to_atom_2_1,__2#matrix_to_atom_2_2,__2#matrix_to_atom_2_3,__2#matrix_to_atom_3_1,__2#matrix_to_atom_3_2,__2#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(sum([4,-(d);int(1..)]) - 1);int(1..)])

--

product([(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(sum([4,-(d);int(1..)]) - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__2#matrix_to_atom_1_1,__2#matrix_to_atom_1_2,__2#matrix_to_atom_1_3,__2#matrix_to_atom_2_1,__2#matrix_to_atom_2_2,__2#matrix_to_atom_2_3,__2#matrix_to_atom_3_1,__2#matrix_to_atom_3_2,__2#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__2#matrix_to_atom_1_1,__2#matrix_to_atom_1_2,__2#matrix_to_atom_1_3,__2#matrix_to_atom_2_1,__2#matrix_to_atom_2_2,__2#matrix_to_atom_2_3,__2#matrix_to_atom_3_1,__2#matrix_to_atom_3_2,__2#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(sum([4,-(d);int(1..)]) - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([sum([4,-(d);int(1..)]),-(1);int(1..)])

--

(0 != [__2#matrix_to_atom_1_1,__2#matrix_to_atom_1_2,__2#matrix_to_atom_1_3,__2#matrix_to_atom_2_1,__2#matrix_to_atom_2_2,__2#matrix_to_atom_2_3,__2#matrix_to_atom_3_1,__2#matrix_to_atom_3_2,__2#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-(1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__2#matrix_to_atom_1_1,__2#matrix_to_atom_1_2,__2#matrix_to_atom_1_3,__2#matrix_to_atom_2_1,__2#matrix_to_atom_2_2,__2#matrix_to_atom_2_3,__2#matrix_to_atom_3_1,__2#matrix_to_atom_3_2,__2#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])

--

(0 != [__2#matrix_to_atom_1_1,__2#matrix_to_atom_1_2,__2#matrix_to_atom_1_3,__2#matrix_to_atom_2_1,__2#matrix_to_atom_2_2,__2#matrix_to_atom_2_3,__2#matrix_to_atom_3_1,__2#matrix_to_atom_3_2,__2#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__2#matrix_to_atom_1_1,__2#matrix_to_atom_1_2,__2#matrix_to_atom_1_3,__2#matrix_to_atom_2_1,__2#matrix_to_atom_2_2,__2#matrix_to_atom_2_3,__2#matrix_to_atom_3_1,__2#matrix_to_atom_3_2,__2#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([3,sum([d,-1;int(1..)]);int(1..)]), 
   ~~> flatten_product ([("Minion", 4200)])
product([3,__3;int(1..)])
new variables:
  find __3: int(0..2)
new constraints:
  __3 =aux sum([d,-1;int(1..)])

--

__3 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __3),SumGeq([-1, d], __3);int(1..)])

--

(0 != [__2#matrix_to_atom_1_1,__2#matrix_to_atom_1_2,__2#matrix_to_atom_1_3,__2#matrix_to_atom_2_1,__2#matrix_to_atom_2_2,__2#matrix_to_atom_2_3,__2#matrix_to_atom_3_1,__2#matrix_to_atom_3_2,__2#matrix_to_atom_3_3;int(1..)][sum([product([3,__3;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
and([SumLeq([-1, d], __3),SumGeq([-1, d], __3);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__2#matrix_to_atom_1_1,__2#matrix_to_atom_1_2,__2#matrix_to_atom_1_3,__2#matrix_to_atom_2_1,__2#matrix_to_atom_2_2,__2#matrix_to_atom_2_3,__2#matrix_to_atom_3_1,__2#matrix_to_atom_3_2,__2#matrix_to_atom_3_3;int(1..)][sum([product([3,__3;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __3),
SumGeq([-1, d], __3)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__2#matrix_to_atom_1_1,__2#matrix_to_atom_1_2,__2#matrix_to_atom_1_3,__2#matrix_to_atom_2_1,__2#matrix_to_atom_2_2,__2#matrix_to_atom_2_3,__2#matrix_to_atom_3_1,__2#matrix_to_atom_3_2,__2#matrix_to_atom_3_3;int(1..)][sum([product([3,__3;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __3),
SumGeq([-1, d], __3)

Via-solver generator model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)

such that

true

[ square[1, c] | c : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[square[1, 1],square[1, 2],square[1, 3];int(1..)]

--

square[1, 1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[1, 1] @ and([__inDomain(1,int(1..3)),__inDomain(1,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([{square[1, 1] @ and([__inDomain(1,int(1..3)),__inDomain(1,int(1..3));int(1..)])},square[1, 2],square[1, 3];int(1..)]) = s),
(sum([ square[2, c] | c : Index ]) = s),
(sum([ square[3, c] | c : Index ]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([ square[2, c] | c : Index ]) = s),
(sum([ square[3, c] | c : Index ]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

square[1, 2], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[1, 2] @ and([__inDomain(1,int(1..3)),__inDomain(2,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],{square[1, 2] @ and([__inDomain(1,int(1..3)),__inDomain(2,int(1..3));int(1..)])},square[1, 3];int(1..)]) = s),
(sum([ square[2, c] | c : Index ]) = s),
(sum([ square[3, c] | c : Index ]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([ square[2, c] | c : Index ]) = s),
(sum([ square[3, c] | c : Index ]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

square[1, 3], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[1, 3] @ and([__inDomain(1,int(1..3)),__inDomain(3,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],{square[1, 3] @ and([__inDomain(1,int(1..3)),__inDomain(3,int(1..3));int(1..)])};int(1..)]) = s),
(sum([ square[2, c] | c : Index ]) = s),
(sum([ square[3, c] | c : Index ]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([ square[2, c] | c : Index ]) = s),
(sum([ square[3, c] | c : Index ]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __9: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)

such that

(0 != __9[2, c])

--

(0 != __9#matrix_to_atom[2, c]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __9#matrix_to_atom[2, c])
new variables:
  find __9#matrix_to_atom_1_1: int(1..9)
  find __9#matrix_to_atom_1_2: int(1..9)
  find __9#matrix_to_atom_1_3: int(1..9)
  find __9#matrix_to_atom_2_1: int(1..9)
  find __9#matrix_to_atom_2_2: int(1..9)
  find __9#matrix_to_atom_2_3: int(1..9)
  find __9#matrix_to_atom_3_1: int(1..9)
  find __9#matrix_to_atom_3_2: int(1..9)
  find __9#matrix_to_atom_3_3: int(1..9)

--

__9#matrix_to_atom[2, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__9#matrix_to_atom[2, c] @ and([__inDomain(2,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(0 != {__9#matrix_to_atom[2, c] @ and([__inDomain(2,int(1..3)),__inDomain(c,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __9#matrix_to_atom[2, c])

--

(0 != __9#matrix_to_atom[2, c]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([product([3,(2 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])])

--

(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([product([3,(2 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([product([1,(c - 1);int(1..)]),4;int(1..)])])

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([sum([c,-(1);int(1..)]),4;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([sum([c,-1;int(1..)]),4;int(1..)])])

--

sum([sum([c,-1;int(1..)]),4;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([c,-1,4;int(1..)])

--

(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([c,-1,4;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([c,3;int(1..)])])

--

[__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([c,3;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][__10]
new variables:
  find __10: int(4..6)
new constraints:
  __10 =aux sum([c,3;int(1..)])

--

__10 =aux sum([c,3;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([3, c], __10),SumGeq([3, c], __10);int(1..)])

--

(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][__10]),
and([SumLeq([3, c], __10),SumGeq([3, c], __10);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][__10]),
SumLeq([3, c], __10),
SumGeq([3, c], __10)

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(4..6)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][__10]),
SumLeq([3, c], __10),
SumGeq([3, c], __10)

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(4..6)
find __11: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)

such that

(0 != __11[3, c])

--

(0 != __11#matrix_to_atom[3, c]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __11#matrix_to_atom[3, c])
new variables:
  find __11#matrix_to_atom_1_1: int(1..9)
  find __11#matrix_to_atom_1_2: int(1..9)
  find __11#matrix_to_atom_1_3: int(1..9)
  find __11#matrix_to_atom_2_1: int(1..9)
  find __11#matrix_to_atom_2_2: int(1..9)
  find __11#matrix_to_atom_2_3: int(1..9)
  find __11#matrix_to_atom_3_1: int(1..9)
  find __11#matrix_to_atom_3_2: int(1..9)
  find __11#matrix_to_atom_3_3: int(1..9)

--

__11#matrix_to_atom[3, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__11#matrix_to_atom[3, c] @ and([__inDomain(3,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(0 != {__11#matrix_to_atom[3, c] @ and([__inDomain(3,int(1..3)),__inDomain(c,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __11#matrix_to_atom[3, c])

--

(0 != __11#matrix_to_atom[3, c]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__11#matrix_to_atom_1_1,__11#matrix_to_atom_1_2,__11#matrix_to_atom_1_3,__11#matrix_to_atom_2_1,__11#matrix_to_atom_2_2,__11#matrix_to_atom_2_3,__11#matrix_to_atom_3_1,__11#matrix_to_atom_3_2,__11#matrix_to_atom_3_3;int(1..)][sum([product([3,(3 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])])

--

(0 != [__11#matrix_to_atom_1_1,__11#matrix_to_atom_1_2,__11#matrix_to_atom_1_3,__11#matrix_to_atom_2_1,__11#matrix_to_atom_2_2,__11#matrix_to_atom_2_3,__11#matrix_to_atom_3_1,__11#matrix_to_atom_3_2,__11#matrix_to_atom_3_3;int(1..)][sum([product([3,(3 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__11#matrix_to_atom_1_1,__11#matrix_to_atom_1_2,__11#matrix_to_atom_1_3,__11#matrix_to_atom_2_1,__11#matrix_to_atom_2_2,__11#matrix_to_atom_2_3,__11#matrix_to_atom_3_1,__11#matrix_to_atom_3_2,__11#matrix_to_atom_3_3;int(1..)][sum([product([1,(c - 1);int(1..)]),7;int(1..)])])

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(0 != [__11#matrix_to_atom_1_1,__11#matrix_to_atom_1_2,__11#matrix_to_atom_1_3,__11#matrix_to_atom_2_1,__11#matrix_to_atom_2_2,__11#matrix_to_atom_2_3,__11#matrix_to_atom_3_1,__11#matrix_to_atom_3_2,__11#matrix_to_atom_3_3;int(1..)][sum([sum([c,-(1);int(1..)]),7;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__11#matrix_to_atom_1_1,__11#matrix_to_atom_1_2,__11#matrix_to_atom_1_3,__11#matrix_to_atom_2_1,__11#matrix_to_atom_2_2,__11#matrix_to_atom_2_3,__11#matrix_to_atom_3_1,__11#matrix_to_atom_3_2,__11#matrix_to_atom_3_3;int(1..)][sum([sum([c,-1;int(1..)]),7;int(1..)])])

--

sum([sum([c,-1;int(1..)]),7;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([c,-1,7;int(1..)])

--

(0 != [__11#matrix_to_atom_1_1,__11#matrix_to_atom_1_2,__11#matrix_to_atom_1_3,__11#matrix_to_atom_2_1,__11#matrix_to_atom_2_2,__11#matrix_to_atom_2_3,__11#matrix_to_atom_3_1,__11#matrix_to_atom_3_2,__11#matrix_to_atom_3_3;int(1..)][sum([c,-1,7;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__11#matrix_to_atom_1_1,__11#matrix_to_atom_1_2,__11#matrix_to_atom_1_3,__11#matrix_to_atom_2_1,__11#matrix_to_atom_2_2,__11#matrix_to_atom_2_3,__11#matrix_to_atom_3_1,__11#matrix_to_atom_3_2,__11#matrix_to_atom_3_3;int(1..)][sum([c,6;int(1..)])])

--

[__11#matrix_to_atom_1_1,__11#matrix_to_atom_1_2,__11#matrix_to_atom_1_3,__11#matrix_to_atom_2_1,__11#matrix_to_atom_2_2,__11#matrix_to_atom_2_3,__11#matrix_to_atom_3_1,__11#matrix_to_atom_3_2,__11#matrix_to_atom_3_3;int(1..)][sum([c,6;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__11#matrix_to_atom_1_1,__11#matrix_to_atom_1_2,__11#matrix_to_atom_1_3,__11#matrix_to_atom_2_1,__11#matrix_to_atom_2_2,__11#matrix_to_atom_2_3,__11#matrix_to_atom_3_1,__11#matrix_to_atom_3_2,__11#matrix_to_atom_3_3;int(1..)][__12]
new variables:
  find __12: int(7..9)
new constraints:
  __12 =aux sum([c,6;int(1..)])

--

__12 =aux sum([c,6;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([6, c], __12),SumGeq([6, c], __12);int(1..)])

--

(0 != [__11#matrix_to_atom_1_1,__11#matrix_to_atom_1_2,__11#matrix_to_atom_1_3,__11#matrix_to_atom_2_1,__11#matrix_to_atom_2_2,__11#matrix_to_atom_2_3,__11#matrix_to_atom_3_1,__11#matrix_to_atom_3_2,__11#matrix_to_atom_3_3;int(1..)][__12]),
and([SumLeq([6, c], __12),SumGeq([6, c], __12);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__11#matrix_to_atom_1_1,__11#matrix_to_atom_1_2,__11#matrix_to_atom_1_3,__11#matrix_to_atom_2_1,__11#matrix_to_atom_2_2,__11#matrix_to_atom_2_3,__11#matrix_to_atom_3_1,__11#matrix_to_atom_3_2,__11#matrix_to_atom_3_3;int(1..)][__12]),
SumLeq([6, c], __12),
SumGeq([6, c], __12)

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(4..6)
find __11: matrix indexed by [Index, Index] of Value
find __12: int(7..9)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __11#matrix_to_atom_1_1: int(1..9)
find __11#matrix_to_atom_1_2: int(1..9)
find __11#matrix_to_atom_1_3: int(1..9)
find __11#matrix_to_atom_2_1: int(1..9)
find __11#matrix_to_atom_2_2: int(1..9)
find __11#matrix_to_atom_2_3: int(1..9)
find __11#matrix_to_atom_3_1: int(1..9)
find __11#matrix_to_atom_3_2: int(1..9)
find __11#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__11#matrix_to_atom_1_1,__11#matrix_to_atom_1_2,__11#matrix_to_atom_1_3,__11#matrix_to_atom_2_1,__11#matrix_to_atom_2_2,__11#matrix_to_atom_2_3,__11#matrix_to_atom_3_1,__11#matrix_to_atom_3_2,__11#matrix_to_atom_3_3;int(1..)][__12]),
SumLeq([6, c], __12),
SumGeq([6, c], __12)

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: int(1..24)
find __13: bool
find __14: int(1..9)
find __15: int(0..2)
find __16: int(1..9)
find __17: int(0..2)
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: int(1..24)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)

such that

(true != (sum([ __20[__21, c] | r : Index ]) = __22))

--

(true != (sum([ __20[__21, c] | r : Index ]) = __22)), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(true != (sum([ __20[__21, c] | r : Index ]) = __22))
new variables:
  find __20#matrix_to_atom_1_1: int(1..9)
  find __20#matrix_to_atom_1_2: int(1..9)
  find __20#matrix_to_atom_1_3: int(1..9)
  find __20#matrix_to_atom_2_1: int(1..9)
  find __20#matrix_to_atom_2_2: int(1..9)
  find __20#matrix_to_atom_2_3: int(1..9)
  find __20#matrix_to_atom_3_1: int(1..9)
  find __20#matrix_to_atom_3_2: int(1..9)
  find __20#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)

such that

(0 != __10[__11, __12])

--

(0 != __10#matrix_to_atom[__11, __12]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __10#matrix_to_atom[__11, __12])
new variables:
  find __10#matrix_to_atom_1_1: int(1..9)
  find __10#matrix_to_atom_1_2: int(1..9)
  find __10#matrix_to_atom_1_3: int(1..9)
  find __10#matrix_to_atom_2_1: int(1..9)
  find __10#matrix_to_atom_2_2: int(1..9)
  find __10#matrix_to_atom_2_3: int(1..9)
  find __10#matrix_to_atom_3_1: int(1..9)
  find __10#matrix_to_atom_3_2: int(1..9)
  find __10#matrix_to_atom_3_3: int(1..9)

--

__10#matrix_to_atom[__11, __12], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__10#matrix_to_atom[__11, __12] @ and([__inDomain(__11,int(1..3)),__inDomain(__12,int(1..3));int(1..)])}

--

(0 != {__10#matrix_to_atom[__11, __12] @ and([__inDomain(__11,int(1..3)),__inDomain(__12,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __10#matrix_to_atom[__11, __12])

--

(0 != __10#matrix_to_atom[__11, __12]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(__11 - 1);int(1..)]),product([1,(__12 - 1);int(1..)]),1;int(1..)])])

--

product([1,(__12 - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(__12 - 1);int(1..)])

--

product([(__12 - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(__12 - 1)

--

(__11 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__11,-(1);int(1..)])

--

(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-(1);int(1..)]);int(1..)]),(__12 - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),(__12 - 1),1;int(1..)])])

--

(__12 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__12,-(1);int(1..)])

--

(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),sum([__12,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),sum([__12,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),sum([__12,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),__12,-1,1;int(1..)])

--

(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),__12,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),__12;int(1..)])])

--

[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),__12;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__13]
new variables:
  find __13: int(1..9)
new constraints:
  __13 =aux sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),__12;int(1..)])

--

__13 =aux sum([product([3,sum([__11,-1;int(1..)]);int(1..)]),__12;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[__12, __14],__13),FlatWeightedSumGeq([1, 3],[__12, __14],__13);int(1..)])
new variables:
  find __14: int(0..2)
new constraints:
  __14 =aux sum([__11,-1;int(1..)])

--

(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__13]),
and([FlatWeightedSumLeq([1, 3],[__12, __14],__13),FlatWeightedSumGeq([1, 3],[__12, __14],__13);int(1..)]),
__14 =aux sum([__11,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__13]),
FlatWeightedSumLeq([1, 3],[__12, __14],__13),
FlatWeightedSumGeq([1, 3],[__12, __14],__13),
__14 =aux sum([__11,-1;int(1..)])

--

__14 =aux sum([__11,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __11], __14),SumGeq([-1, __11], __14);int(1..)])

--

(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__13]),
FlatWeightedSumLeq([1, 3],[__12, __14],__13),
FlatWeightedSumGeq([1, 3],[__12, __14],__13),
and([SumLeq([-1, __11], __14),SumGeq([-1, __11], __14);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__13]),
FlatWeightedSumLeq([1, 3],[__12, __14],__13),
FlatWeightedSumGeq([1, 3],[__12, __14],__13),
SumLeq([-1, __11], __14),
SumGeq([-1, __11], __14)

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][__13]),
FlatWeightedSumLeq([1, 3],[__12, __14],__13),
FlatWeightedSumGeq([1, 3],[__12, __14],__13),
SumLeq([-1, __11], __14),
SumGeq([-1, __11], __14)

Via-solver generator model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)

such that

true

[ __20[__21, c] | r : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[__20[__21, c],__20[__21, c],__20[__21, c];int(1..)]

--

(true != (sum([__20#matrix_to_atom[__21, c],__20#matrix_to_atom[__21, c],__20#matrix_to_atom[__21, c];int(1..)]) = __22)), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(true != (sum([__20#matrix_to_atom[__21, c],__20#matrix_to_atom[__21, c],__20#matrix_to_atom[__21, c];int(1..)]) = __22))

--

__20#matrix_to_atom[__21, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__20#matrix_to_atom[__21, c] @ and([__inDomain(__21,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([{__20#matrix_to_atom[__21, c] @ and([__inDomain(__21,int(1..3)),__inDomain(c,int(1..3));int(1..)])},__20#matrix_to_atom[__21, c],__20#matrix_to_atom[__21, c];int(1..)]) = __22)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__20#matrix_to_atom[__21, c],__20#matrix_to_atom[__21, c],__20#matrix_to_atom[__21, c];int(1..)]) = __22))

--

__20#matrix_to_atom[__21, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__20#matrix_to_atom[__21, c] @ and([__inDomain(__21,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([__20#matrix_to_atom[__21, c],{__20#matrix_to_atom[__21, c] @ and([__inDomain(__21,int(1..3)),__inDomain(c,int(1..3));int(1..)])},__20#matrix_to_atom[__21, c];int(1..)]) = __22)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__20#matrix_to_atom[__21, c],__20#matrix_to_atom[__21, c],__20#matrix_to_atom[__21, c];int(1..)]) = __22))

--

__20#matrix_to_atom[__21, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__20#matrix_to_atom[__21, c] @ and([__inDomain(__21,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([__20#matrix_to_atom[__21, c],__20#matrix_to_atom[__21, c],{__20#matrix_to_atom[__21, c] @ and([__inDomain(__21,int(1..3)),__inDomain(c,int(1..3));int(1..)])};int(1..)]) = __22)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__20#matrix_to_atom[__21, c],__20#matrix_to_atom[__21, c],__20#matrix_to_atom[__21, c];int(1..)]) = __22))

--

(true != (sum([__20#matrix_to_atom[__21, c],__20#matrix_to_atom[__21, c],__20#matrix_to_atom[__21, c];int(1..)]) = __22)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])];int(1..)]) = __22))

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

(__21 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__21,-(1);int(1..)])

--

(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __22)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __22))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __22)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __22))

--

sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __22)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __22))

--

(__21 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__21,-(1);int(1..)])

--

(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __22)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __22))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __22)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __22))

--

sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __22)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __22))

--

(__21 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__21,-(1);int(1..)])

--

(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __22)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __22))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])];int(1..)]) = __22)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])];int(1..)]) = __22))

--

sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])];int(1..)]) = __22)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __22))

--

(true != (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __22)), 
   ~~> flatten_generic ([("Minion", 4200)])
(true != __23)
new variables:
  find __23: bool
new constraints:
  __23 =aux (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __22)

--

__23 =aux (sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __22), 
   ~~> bool_eq_to_reify ([("Minion", 4400)])
Reify((sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __22), __23)

--

[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__24]
new variables:
  find __24: int(1..9)
new constraints:
  __24 =aux sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__24 =aux sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__25, c],__24),FlatWeightedSumGeq([3, 1],[__25, c],__24);int(1..)])
new variables:
  find __25: int(0..2)
new constraints:
  __25 =aux sum([__21,-1;int(1..)])

--

(true != __23),
Reify((sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__24],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __22), __23),
and([FlatWeightedSumLeq([3, 1],[__25, c],__24),FlatWeightedSumGeq([3, 1],[__25, c],__24);int(1..)]),
__25 =aux sum([__21,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __23),
Reify((sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__24],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __22), __23),
FlatWeightedSumLeq([3, 1],[__25, c],__24),
FlatWeightedSumGeq([3, 1],[__25, c],__24),
__25 =aux sum([__21,-1;int(1..)])

--

__25 =aux sum([__21,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __21], __25),SumGeq([-1, __21], __25);int(1..)])

--

(true != __23),
Reify((sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__24],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __22), __23),
FlatWeightedSumLeq([3, 1],[__25, c],__24),
FlatWeightedSumGeq([3, 1],[__25, c],__24),
and([SumLeq([-1, __21], __25),SumGeq([-1, __21], __25);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __23),
Reify((sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__24],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __22), __23),
FlatWeightedSumLeq([3, 1],[__25, c],__24),
FlatWeightedSumGeq([3, 1],[__25, c],__24),
SumLeq([-1, __21], __25),
SumGeq([-1, __21], __25)

--

[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__26]
new variables:
  find __26: int(1..9)
new constraints:
  __26 =aux sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__26 =aux sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__27, c],__26),FlatWeightedSumGeq([3, 1],[__27, c],__26);int(1..)])
new variables:
  find __27: int(0..2)
new constraints:
  __27 =aux sum([__21,-1;int(1..)])

--

(true != __23),
Reify((sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__24],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__26],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __22), __23),
FlatWeightedSumLeq([3, 1],[__25, c],__24),
FlatWeightedSumGeq([3, 1],[__25, c],__24),
SumLeq([-1, __21], __25),
SumGeq([-1, __21], __25),
and([FlatWeightedSumLeq([3, 1],[__27, c],__26),FlatWeightedSumGeq([3, 1],[__27, c],__26);int(1..)]),
__27 =aux sum([__21,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __23),
Reify((sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__24],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__26],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __22), __23),
FlatWeightedSumLeq([3, 1],[__25, c],__24),
FlatWeightedSumGeq([3, 1],[__25, c],__24),
SumLeq([-1, __21], __25),
SumGeq([-1, __21], __25),
FlatWeightedSumLeq([3, 1],[__27, c],__26),
FlatWeightedSumGeq([3, 1],[__27, c],__26),
__27 =aux sum([__21,-1;int(1..)])

--

__27 =aux sum([__21,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __21], __27),SumGeq([-1, __21], __27);int(1..)])

--

(true != __23),
Reify((sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__24],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__26],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __22), __23),
FlatWeightedSumLeq([3, 1],[__25, c],__24),
FlatWeightedSumGeq([3, 1],[__25, c],__24),
SumLeq([-1, __21], __25),
SumGeq([-1, __21], __25),
FlatWeightedSumLeq([3, 1],[__27, c],__26),
FlatWeightedSumGeq([3, 1],[__27, c],__26),
and([SumLeq([-1, __21], __27),SumGeq([-1, __21], __27);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __23),
Reify((sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__24],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__26],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __22), __23),
FlatWeightedSumLeq([3, 1],[__25, c],__24),
FlatWeightedSumGeq([3, 1],[__25, c],__24),
SumLeq([-1, __21], __25),
SumGeq([-1, __21], __25),
FlatWeightedSumLeq([3, 1],[__27, c],__26),
FlatWeightedSumGeq([3, 1],[__27, c],__26),
SumLeq([-1, __21], __27),
SumGeq([-1, __21], __27)

--

[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__28]
new variables:
  find __28: int(1..9)
new constraints:
  __28 =aux sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__28 =aux sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__29, c],__28),FlatWeightedSumGeq([3, 1],[__29, c],__28);int(1..)])
new variables:
  find __29: int(0..2)
new constraints:
  __29 =aux sum([__21,-1;int(1..)])

--

(true != __23),
Reify((sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__24],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__26],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__28];int(1..)]) = __22), __23),
FlatWeightedSumLeq([3, 1],[__25, c],__24),
FlatWeightedSumGeq([3, 1],[__25, c],__24),
SumLeq([-1, __21], __25),
SumGeq([-1, __21], __25),
FlatWeightedSumLeq([3, 1],[__27, c],__26),
FlatWeightedSumGeq([3, 1],[__27, c],__26),
SumLeq([-1, __21], __27),
SumGeq([-1, __21], __27),
and([FlatWeightedSumLeq([3, 1],[__29, c],__28),FlatWeightedSumGeq([3, 1],[__29, c],__28);int(1..)]),
__29 =aux sum([__21,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __23),
Reify((sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__24],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__26],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__28];int(1..)]) = __22), __23),
FlatWeightedSumLeq([3, 1],[__25, c],__24),
FlatWeightedSumGeq([3, 1],[__25, c],__24),
SumLeq([-1, __21], __25),
SumGeq([-1, __21], __25),
FlatWeightedSumLeq([3, 1],[__27, c],__26),
FlatWeightedSumGeq([3, 1],[__27, c],__26),
SumLeq([-1, __21], __27),
SumGeq([-1, __21], __27),
FlatWeightedSumLeq([3, 1],[__29, c],__28),
FlatWeightedSumGeq([3, 1],[__29, c],__28),
__29 =aux sum([__21,-1;int(1..)])

--

__29 =aux sum([__21,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __21], __29),SumGeq([-1, __21], __29);int(1..)])

--

(true != __23),
Reify((sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__24],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__26],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__28];int(1..)]) = __22), __23),
FlatWeightedSumLeq([3, 1],[__25, c],__24),
FlatWeightedSumGeq([3, 1],[__25, c],__24),
SumLeq([-1, __21], __25),
SumGeq([-1, __21], __25),
FlatWeightedSumLeq([3, 1],[__27, c],__26),
FlatWeightedSumGeq([3, 1],[__27, c],__26),
SumLeq([-1, __21], __27),
SumGeq([-1, __21], __27),
FlatWeightedSumLeq([3, 1],[__29, c],__28),
FlatWeightedSumGeq([3, 1],[__29, c],__28),
and([SumLeq([-1, __21], __29),SumGeq([-1, __21], __29);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __23),
Reify((sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__24],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__26],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__28];int(1..)]) = __22), __23),
FlatWeightedSumLeq([3, 1],[__25, c],__24),
FlatWeightedSumGeq([3, 1],[__25, c],__24),
SumLeq([-1, __21], __25),
SumGeq([-1, __21], __25),
FlatWeightedSumLeq([3, 1],[__27, c],__26),
FlatWeightedSumGeq([3, 1],[__27, c],__26),
SumLeq([-1, __21], __27),
SumGeq([-1, __21], __27),
FlatWeightedSumLeq([3, 1],[__29, c],__28),
FlatWeightedSumGeq([3, 1],[__29, c],__28),
SumLeq([-1, __21], __29),
SumGeq([-1, __21], __29)

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: int(1..24)
find __13: bool
find __14: int(1..9)
find __15: int(0..2)
find __16: int(1..9)
find __17: int(0..2)
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: int(1..24)
find __23: bool
find __24: int(1..9)
find __25: int(0..2)
find __26: int(1..9)
find __27: int(0..2)
find __28: int(1..9)
find __29: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)

such that

(true != __23),
Reify((sum([[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__24],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__26],[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__28];int(1..)]) = __22), __23),
FlatWeightedSumLeq([3, 1],[__25, c],__24),
FlatWeightedSumGeq([3, 1],[__25, c],__24),
SumLeq([-1, __21], __25),
SumGeq([-1, __21], __25),
FlatWeightedSumLeq([3, 1],[__27, c],__26),
FlatWeightedSumGeq([3, 1],[__27, c],__26),
SumLeq([-1, __21], __27),
SumGeq([-1, __21], __27),
FlatWeightedSumLeq([3, 1],[__29, c],__28),
FlatWeightedSumGeq([3, 1],[__29, c],__28),
SumLeq([-1, __21], __29),
SumGeq([-1, __21], __29)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)

such that

(0 != __6[d, d])

--

(0 != __6#matrix_to_atom[d, d]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __6#matrix_to_atom[d, d])
new variables:
  find __6#matrix_to_atom_1_1: int(1..9)
  find __6#matrix_to_atom_1_2: int(1..9)
  find __6#matrix_to_atom_1_3: int(1..9)
  find __6#matrix_to_atom_2_1: int(1..9)
  find __6#matrix_to_atom_2_2: int(1..9)
  find __6#matrix_to_atom_2_3: int(1..9)
  find __6#matrix_to_atom_3_1: int(1..9)
  find __6#matrix_to_atom_3_2: int(1..9)
  find __6#matrix_to_atom_3_3: int(1..9)

--

__6#matrix_to_atom[d, d], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__6#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}

--

(0 != {__6#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __6#matrix_to_atom[d, d])

--

(0 != __6#matrix_to_atom[d, d]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(d - 1);int(1..)]),1;int(1..)])])

--

product([1,(d - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(d - 1);int(1..)])

--

product([(d - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(d - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(d - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(d - 1),1;int(1..)])])

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])

--

(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])])

--

[__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][__7]
new variables:
  find __7: int(1..9)
new constraints:
  __7 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])

--

__7 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__8, d],__7),FlatWeightedSumGeq([3, 1],[__8, d],__7);int(1..)])
new variables:
  find __8: int(0..2)
new constraints:
  __8 =aux sum([d,-1;int(1..)])

--

(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][__7]),
and([FlatWeightedSumLeq([3, 1],[__8, d],__7),FlatWeightedSumGeq([3, 1],[__8, d],__7);int(1..)]),
__8 =aux sum([d,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][__7]),
FlatWeightedSumLeq([3, 1],[__8, d],__7),
FlatWeightedSumGeq([3, 1],[__8, d],__7),
__8 =aux sum([d,-1;int(1..)])

--

__8 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __8),SumGeq([-1, d], __8);int(1..)])

--

(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][__7]),
FlatWeightedSumLeq([3, 1],[__8, d],__7),
FlatWeightedSumGeq([3, 1],[__8, d],__7),
and([SumLeq([-1, d], __8),SumGeq([-1, d], __8);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][__7]),
FlatWeightedSumLeq([3, 1],[__8, d],__7),
FlatWeightedSumGeq([3, 1],[__8, d],__7),
SumLeq([-1, d], __8),
SumGeq([-1, d], __8)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][__7]),
FlatWeightedSumLeq([3, 1],[__8, d],__7),
FlatWeightedSumGeq([3, 1],[__8, d],__7),
SumLeq([-1, d], __8),
SumGeq([-1, d], __8)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)

such that

(0 != __4[d, (4 - d)])

--

(4 - d), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([4,-(d);int(1..)])

--

(0 != __4#matrix_to_atom[d, sum([4,-(d);int(1..)])]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __4#matrix_to_atom[d, sum([4,-(d);int(1..)])])
new variables:
  find __4#matrix_to_atom_1_1: int(1..9)
  find __4#matrix_to_atom_1_2: int(1..9)
  find __4#matrix_to_atom_1_3: int(1..9)
  find __4#matrix_to_atom_2_1: int(1..9)
  find __4#matrix_to_atom_2_2: int(1..9)
  find __4#matrix_to_atom_2_3: int(1..9)
  find __4#matrix_to_atom_3_1: int(1..9)
  find __4#matrix_to_atom_3_2: int(1..9)
  find __4#matrix_to_atom_3_3: int(1..9)

--

__4#matrix_to_atom[d, sum([4,-(d);int(1..)])], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__4#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

(0 != {__4#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != {__4#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])})

--

(0 != {__4#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> bubble_up ([("Bubble", 8800)])
{(0 != __4#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

{(0 != __4#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}, 
   ~~> expand_bubble ([("Bubble", 8900)])
and([(0 != __4#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)])

--

and([(0 != __4#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __4#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])

--

(0 != __4#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __4#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(0 != __4#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(sum([4,-(d);int(1..)]) - 1);int(1..)])

--

product([(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(sum([4,-(d);int(1..)]) - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(sum([4,-(d);int(1..)]) - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([sum([4,-(d);int(1..)]),-(1);int(1..)])

--

(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-(1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])

--

(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([3,sum([d,-1;int(1..)]);int(1..)]), 
   ~~> flatten_product ([("Minion", 4200)])
product([3,__5;int(1..)])
new variables:
  find __5: int(0..2)
new constraints:
  __5 =aux sum([d,-1;int(1..)])

--

__5 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __5),SumGeq([-1, d], __5);int(1..)])

--

(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([product([3,__5;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
and([SumLeq([-1, d], __5),SumGeq([-1, d], __5);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([product([3,__5;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __5),
SumGeq([-1, d], __5)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__4#matrix_to_atom_1_1,__4#matrix_to_atom_1_2,__4#matrix_to_atom_1_3,__4#matrix_to_atom_2_1,__4#matrix_to_atom_2_2,__4#matrix_to_atom_2_3,__4#matrix_to_atom_3_1,__4#matrix_to_atom_3_2,__4#matrix_to_atom_3_3;int(1..)][sum([product([3,__5;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __5),
SumGeq([-1, d], __5)

Via-solver generator model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(4..6)
find __11: matrix indexed by [Index, Index] of Value
find __12: int(7..9)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __11#matrix_to_atom_1_1: int(1..9)
find __11#matrix_to_atom_1_2: int(1..9)
find __11#matrix_to_atom_1_3: int(1..9)
find __11#matrix_to_atom_2_1: int(1..9)
find __11#matrix_to_atom_2_2: int(1..9)
find __11#matrix_to_atom_2_3: int(1..9)
find __11#matrix_to_atom_3_1: int(1..9)
find __11#matrix_to_atom_3_2: int(1..9)
find __11#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(4..6)
find __11: matrix indexed by [Index, Index] of Value
find __12: int(7..9)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __11#matrix_to_atom_1_1: int(1..9)
find __11#matrix_to_atom_1_2: int(1..9)
find __11#matrix_to_atom_1_3: int(1..9)
find __11#matrix_to_atom_2_1: int(1..9)
find __11#matrix_to_atom_2_2: int(1..9)
find __11#matrix_to_atom_2_3: int(1..9)
find __11#matrix_to_atom_3_1: int(1..9)
find __11#matrix_to_atom_3_2: int(1..9)
find __11#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(4..6)
find __11: matrix indexed by [Index, Index] of Value
find __12: int(7..9)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __11#matrix_to_atom_1_1: int(1..9)
find __11#matrix_to_atom_1_2: int(1..9)
find __11#matrix_to_atom_1_3: int(1..9)
find __11#matrix_to_atom_2_1: int(1..9)
find __11#matrix_to_atom_2_2: int(1..9)
find __11#matrix_to_atom_2_3: int(1..9)
find __11#matrix_to_atom_3_1: int(1..9)
find __11#matrix_to_atom_3_2: int(1..9)
find __11#matrix_to_atom_3_3: int(1..9)

such that

true

[ square[2, c] | c : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[square[2, 1],square[2, 2],square[2, 3];int(1..)]

--

square[2, 1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[2, 1] @ and([__inDomain(2,int(1..3)),__inDomain(1,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([{square[2, 1] @ and([__inDomain(2,int(1..3)),__inDomain(1,int(1..3));int(1..)])},square[2, 2],square[2, 3];int(1..)]) = s),
(sum([ square[3, c] | c : Index ]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([ square[3, c] | c : Index ]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

square[2, 2], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[2, 2] @ and([__inDomain(2,int(1..3)),__inDomain(2,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],{square[2, 2] @ and([__inDomain(2,int(1..3)),__inDomain(2,int(1..3));int(1..)])},square[2, 3];int(1..)]) = s),
(sum([ square[3, c] | c : Index ]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([ square[3, c] | c : Index ]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

square[2, 3], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[2, 3] @ and([__inDomain(2,int(1..3)),__inDomain(3,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],{square[2, 3] @ and([__inDomain(2,int(1..3)),__inDomain(3,int(1..3));int(1..)])};int(1..)]) = s),
(sum([ square[3, c] | c : Index ]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([ square[3, c] | c : Index ]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(4..6)
find __11: matrix indexed by [Index, Index] of Value
find __12: int(7..9)
find __13: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __11#matrix_to_atom_1_1: int(1..9)
find __11#matrix_to_atom_1_2: int(1..9)
find __11#matrix_to_atom_1_3: int(1..9)
find __11#matrix_to_atom_2_1: int(1..9)
find __11#matrix_to_atom_2_2: int(1..9)
find __11#matrix_to_atom_2_3: int(1..9)
find __11#matrix_to_atom_3_1: int(1..9)
find __11#matrix_to_atom_3_2: int(1..9)
find __11#matrix_to_atom_3_3: int(1..9)

such that

(0 != __13[3, c])

--

(0 != __13#matrix_to_atom[3, c]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __13#matrix_to_atom[3, c])
new variables:
  find __13#matrix_to_atom_1_1: int(1..9)
  find __13#matrix_to_atom_1_2: int(1..9)
  find __13#matrix_to_atom_1_3: int(1..9)
  find __13#matrix_to_atom_2_1: int(1..9)
  find __13#matrix_to_atom_2_2: int(1..9)
  find __13#matrix_to_atom_2_3: int(1..9)
  find __13#matrix_to_atom_3_1: int(1..9)
  find __13#matrix_to_atom_3_2: int(1..9)
  find __13#matrix_to_atom_3_3: int(1..9)

--

__13#matrix_to_atom[3, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__13#matrix_to_atom[3, c] @ and([__inDomain(3,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(0 != {__13#matrix_to_atom[3, c] @ and([__inDomain(3,int(1..3)),__inDomain(c,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __13#matrix_to_atom[3, c])

--

(0 != __13#matrix_to_atom[3, c]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__13#matrix_to_atom_1_1,__13#matrix_to_atom_1_2,__13#matrix_to_atom_1_3,__13#matrix_to_atom_2_1,__13#matrix_to_atom_2_2,__13#matrix_to_atom_2_3,__13#matrix_to_atom_3_1,__13#matrix_to_atom_3_2,__13#matrix_to_atom_3_3;int(1..)][sum([product([3,(3 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])])

--

(0 != [__13#matrix_to_atom_1_1,__13#matrix_to_atom_1_2,__13#matrix_to_atom_1_3,__13#matrix_to_atom_2_1,__13#matrix_to_atom_2_2,__13#matrix_to_atom_2_3,__13#matrix_to_atom_3_1,__13#matrix_to_atom_3_2,__13#matrix_to_atom_3_3;int(1..)][sum([product([3,(3 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__13#matrix_to_atom_1_1,__13#matrix_to_atom_1_2,__13#matrix_to_atom_1_3,__13#matrix_to_atom_2_1,__13#matrix_to_atom_2_2,__13#matrix_to_atom_2_3,__13#matrix_to_atom_3_1,__13#matrix_to_atom_3_2,__13#matrix_to_atom_3_3;int(1..)][sum([product([1,(c - 1);int(1..)]),7;int(1..)])])

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(0 != [__13#matrix_to_atom_1_1,__13#matrix_to_atom_1_2,__13#matrix_to_atom_1_3,__13#matrix_to_atom_2_1,__13#matrix_to_atom_2_2,__13#matrix_to_atom_2_3,__13#matrix_to_atom_3_1,__13#matrix_to_atom_3_2,__13#matrix_to_atom_3_3;int(1..)][sum([sum([c,-(1);int(1..)]),7;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__13#matrix_to_atom_1_1,__13#matrix_to_atom_1_2,__13#matrix_to_atom_1_3,__13#matrix_to_atom_2_1,__13#matrix_to_atom_2_2,__13#matrix_to_atom_2_3,__13#matrix_to_atom_3_1,__13#matrix_to_atom_3_2,__13#matrix_to_atom_3_3;int(1..)][sum([sum([c,-1;int(1..)]),7;int(1..)])])

--

sum([sum([c,-1;int(1..)]),7;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([c,-1,7;int(1..)])

--

(0 != [__13#matrix_to_atom_1_1,__13#matrix_to_atom_1_2,__13#matrix_to_atom_1_3,__13#matrix_to_atom_2_1,__13#matrix_to_atom_2_2,__13#matrix_to_atom_2_3,__13#matrix_to_atom_3_1,__13#matrix_to_atom_3_2,__13#matrix_to_atom_3_3;int(1..)][sum([c,-1,7;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__13#matrix_to_atom_1_1,__13#matrix_to_atom_1_2,__13#matrix_to_atom_1_3,__13#matrix_to_atom_2_1,__13#matrix_to_atom_2_2,__13#matrix_to_atom_2_3,__13#matrix_to_atom_3_1,__13#matrix_to_atom_3_2,__13#matrix_to_atom_3_3;int(1..)][sum([c,6;int(1..)])])

--

[__13#matrix_to_atom_1_1,__13#matrix_to_atom_1_2,__13#matrix_to_atom_1_3,__13#matrix_to_atom_2_1,__13#matrix_to_atom_2_2,__13#matrix_to_atom_2_3,__13#matrix_to_atom_3_1,__13#matrix_to_atom_3_2,__13#matrix_to_atom_3_3;int(1..)][sum([c,6;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__13#matrix_to_atom_1_1,__13#matrix_to_atom_1_2,__13#matrix_to_atom_1_3,__13#matrix_to_atom_2_1,__13#matrix_to_atom_2_2,__13#matrix_to_atom_2_3,__13#matrix_to_atom_3_1,__13#matrix_to_atom_3_2,__13#matrix_to_atom_3_3;int(1..)][__14]
new variables:
  find __14: int(7..9)
new constraints:
  __14 =aux sum([c,6;int(1..)])

--

__14 =aux sum([c,6;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([6, c], __14),SumGeq([6, c], __14);int(1..)])

--

(0 != [__13#matrix_to_atom_1_1,__13#matrix_to_atom_1_2,__13#matrix_to_atom_1_3,__13#matrix_to_atom_2_1,__13#matrix_to_atom_2_2,__13#matrix_to_atom_2_3,__13#matrix_to_atom_3_1,__13#matrix_to_atom_3_2,__13#matrix_to_atom_3_3;int(1..)][__14]),
and([SumLeq([6, c], __14),SumGeq([6, c], __14);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__13#matrix_to_atom_1_1,__13#matrix_to_atom_1_2,__13#matrix_to_atom_1_3,__13#matrix_to_atom_2_1,__13#matrix_to_atom_2_2,__13#matrix_to_atom_2_3,__13#matrix_to_atom_3_1,__13#matrix_to_atom_3_2,__13#matrix_to_atom_3_3;int(1..)][__14]),
SumLeq([6, c], __14),
SumGeq([6, c], __14)

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(4..6)
find __11: matrix indexed by [Index, Index] of Value
find __12: int(7..9)
find __13: matrix indexed by [Index, Index] of Value
find __14: int(7..9)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __11#matrix_to_atom_1_1: int(1..9)
find __11#matrix_to_atom_1_2: int(1..9)
find __11#matrix_to_atom_1_3: int(1..9)
find __11#matrix_to_atom_2_1: int(1..9)
find __11#matrix_to_atom_2_2: int(1..9)
find __11#matrix_to_atom_2_3: int(1..9)
find __11#matrix_to_atom_3_1: int(1..9)
find __11#matrix_to_atom_3_2: int(1..9)
find __11#matrix_to_atom_3_3: int(1..9)
find __13#matrix_to_atom_1_1: int(1..9)
find __13#matrix_to_atom_1_2: int(1..9)
find __13#matrix_to_atom_1_3: int(1..9)
find __13#matrix_to_atom_2_1: int(1..9)
find __13#matrix_to_atom_2_2: int(1..9)
find __13#matrix_to_atom_2_3: int(1..9)
find __13#matrix_to_atom_3_1: int(1..9)
find __13#matrix_to_atom_3_2: int(1..9)
find __13#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__13#matrix_to_atom_1_1,__13#matrix_to_atom_1_2,__13#matrix_to_atom_1_3,__13#matrix_to_atom_2_1,__13#matrix_to_atom_2_2,__13#matrix_to_atom_2_3,__13#matrix_to_atom_3_1,__13#matrix_to_atom_3_2,__13#matrix_to_atom_3_3;int(1..)][__14]),
SumLeq([6, c], __14),
SumGeq([6, c], __14)

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: int(1..24)
find __13: bool
find __14: int(1..9)
find __15: int(0..2)
find __16: int(1..9)
find __17: int(0..2)
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: int(1..24)
find __23: bool
find __24: int(1..9)
find __25: int(0..2)
find __26: int(1..9)
find __27: int(0..2)
find __28: int(1..9)
find __29: int(0..2)
find __30: matrix indexed by [Index, Index] of Value
find __31: Index
find __32: int(1..24)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)

such that

(true != (sum([ __30[__31, c] | r : Index ]) = __32))

--

(true != (sum([ __30[__31, c] | r : Index ]) = __32)), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(true != (sum([ __30[__31, c] | r : Index ]) = __32))
new variables:
  find __30#matrix_to_atom_1_1: int(1..9)
  find __30#matrix_to_atom_1_2: int(1..9)
  find __30#matrix_to_atom_1_3: int(1..9)
  find __30#matrix_to_atom_2_1: int(1..9)
  find __30#matrix_to_atom_2_2: int(1..9)
  find __30#matrix_to_atom_2_3: int(1..9)
  find __30#matrix_to_atom_3_1: int(1..9)
  find __30#matrix_to_atom_3_2: int(1..9)
  find __30#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)

such that

(0 != __15[__16, __17])

--

(0 != __15#matrix_to_atom[__16, __17]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __15#matrix_to_atom[__16, __17])
new variables:
  find __15#matrix_to_atom_1_1: int(1..9)
  find __15#matrix_to_atom_1_2: int(1..9)
  find __15#matrix_to_atom_1_3: int(1..9)
  find __15#matrix_to_atom_2_1: int(1..9)
  find __15#matrix_to_atom_2_2: int(1..9)
  find __15#matrix_to_atom_2_3: int(1..9)
  find __15#matrix_to_atom_3_1: int(1..9)
  find __15#matrix_to_atom_3_2: int(1..9)
  find __15#matrix_to_atom_3_3: int(1..9)

--

__15#matrix_to_atom[__16, __17], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__15#matrix_to_atom[__16, __17] @ and([__inDomain(__16,int(1..3)),__inDomain(__17,int(1..3));int(1..)])}

--

(0 != {__15#matrix_to_atom[__16, __17] @ and([__inDomain(__16,int(1..3)),__inDomain(__17,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __15#matrix_to_atom[__16, __17])

--

(0 != __15#matrix_to_atom[__16, __17]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,(__16 - 1);int(1..)]),product([1,(__17 - 1);int(1..)]),1;int(1..)])])

--

product([1,(__17 - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(__17 - 1);int(1..)])

--

product([(__17 - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(__17 - 1)

--

(__16 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__16,-(1);int(1..)])

--

(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__16,-(1);int(1..)]);int(1..)]),(__17 - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__16,-1;int(1..)]);int(1..)]),(__17 - 1),1;int(1..)])])

--

(__17 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__17,-(1);int(1..)])

--

(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__16,-1;int(1..)]);int(1..)]),sum([__17,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__16,-1;int(1..)]);int(1..)]),sum([__17,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([__16,-1;int(1..)]);int(1..)]),sum([__17,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__16,-1;int(1..)]);int(1..)]),__17,-1,1;int(1..)])

--

(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__16,-1;int(1..)]);int(1..)]),__17,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__16,-1;int(1..)]);int(1..)]),__17;int(1..)])])

--

[__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__16,-1;int(1..)]);int(1..)]),__17;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][__18]
new variables:
  find __18: int(1..9)
new constraints:
  __18 =aux sum([product([3,sum([__16,-1;int(1..)]);int(1..)]),__17;int(1..)])

--

__18 =aux sum([product([3,sum([__16,-1;int(1..)]);int(1..)]),__17;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[__17, __19],__18),FlatWeightedSumGeq([1, 3],[__17, __19],__18);int(1..)])
new variables:
  find __19: int(0..2)
new constraints:
  __19 =aux sum([__16,-1;int(1..)])

--

(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][__18]),
and([FlatWeightedSumLeq([1, 3],[__17, __19],__18),FlatWeightedSumGeq([1, 3],[__17, __19],__18);int(1..)]),
__19 =aux sum([__16,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][__18]),
FlatWeightedSumLeq([1, 3],[__17, __19],__18),
FlatWeightedSumGeq([1, 3],[__17, __19],__18),
__19 =aux sum([__16,-1;int(1..)])

--

__19 =aux sum([__16,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __16], __19),SumGeq([-1, __16], __19);int(1..)])

--

(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][__18]),
FlatWeightedSumLeq([1, 3],[__17, __19],__18),
FlatWeightedSumGeq([1, 3],[__17, __19],__18),
and([SumLeq([-1, __16], __19),SumGeq([-1, __16], __19);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][__18]),
FlatWeightedSumLeq([1, 3],[__17, __19],__18),
FlatWeightedSumGeq([1, 3],[__17, __19],__18),
SumLeq([-1, __16], __19),
SumGeq([-1, __16], __19)

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][__18]),
FlatWeightedSumLeq([1, 3],[__17, __19],__18),
FlatWeightedSumGeq([1, 3],[__17, __19],__18),
SumLeq([-1, __16], __19),
SumGeq([-1, __16], __19)

Via-solver generator model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)

such that

true

[ __30[__31, c] | r : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[__30[__31, c],__30[__31, c],__30[__31, c];int(1..)]

--

(true != (sum([__30#matrix_to_atom[__31, c],__30#matrix_to_atom[__31, c],__30#matrix_to_atom[__31, c];int(1..)]) = __32)), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(true != (sum([__30#matrix_to_atom[__31, c],__30#matrix_to_atom[__31, c],__30#matrix_to_atom[__31, c];int(1..)]) = __32))

--

__30#matrix_to_atom[__31, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__30#matrix_to_atom[__31, c] @ and([__inDomain(__31,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([{__30#matrix_to_atom[__31, c] @ and([__inDomain(__31,int(1..3)),__inDomain(c,int(1..3));int(1..)])},__30#matrix_to_atom[__31, c],__30#matrix_to_atom[__31, c];int(1..)]) = __32)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__30#matrix_to_atom[__31, c],__30#matrix_to_atom[__31, c],__30#matrix_to_atom[__31, c];int(1..)]) = __32))

--

__30#matrix_to_atom[__31, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__30#matrix_to_atom[__31, c] @ and([__inDomain(__31,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([__30#matrix_to_atom[__31, c],{__30#matrix_to_atom[__31, c] @ and([__inDomain(__31,int(1..3)),__inDomain(c,int(1..3));int(1..)])},__30#matrix_to_atom[__31, c];int(1..)]) = __32)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__30#matrix_to_atom[__31, c],__30#matrix_to_atom[__31, c],__30#matrix_to_atom[__31, c];int(1..)]) = __32))

--

__30#matrix_to_atom[__31, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__30#matrix_to_atom[__31, c] @ and([__inDomain(__31,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([__30#matrix_to_atom[__31, c],__30#matrix_to_atom[__31, c],{__30#matrix_to_atom[__31, c] @ and([__inDomain(__31,int(1..3)),__inDomain(c,int(1..3));int(1..)])};int(1..)]) = __32)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__30#matrix_to_atom[__31, c],__30#matrix_to_atom[__31, c],__30#matrix_to_atom[__31, c];int(1..)]) = __32))

--

(true != (sum([__30#matrix_to_atom[__31, c],__30#matrix_to_atom[__31, c],__30#matrix_to_atom[__31, c];int(1..)]) = __32)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])];int(1..)]) = __32))

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

(__31 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__31,-(1);int(1..)])

--

(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __32)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __32))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __32)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __32))

--

sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __32)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __32))

--

(__31 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__31,-(1);int(1..)])

--

(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __32)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __32))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __32)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __32))

--

sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __32)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,(__31 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __32))

--

(__31 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__31,-(1);int(1..)])

--

(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __32)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __32))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])];int(1..)]) = __32)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])];int(1..)]) = __32))

--

sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])];int(1..)]) = __32)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __32))

--

(true != (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __32)), 
   ~~> flatten_generic ([("Minion", 4200)])
(true != __33)
new variables:
  find __33: bool
new constraints:
  __33 =aux (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __32)

--

__33 =aux (sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __32), 
   ~~> bool_eq_to_reify ([("Minion", 4400)])
Reify((sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __32), __33)

--

[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__34]
new variables:
  find __34: int(1..9)
new constraints:
  __34 =aux sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__34 =aux sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__35, c],__34),FlatWeightedSumGeq([3, 1],[__35, c],__34);int(1..)])
new variables:
  find __35: int(0..2)
new constraints:
  __35 =aux sum([__31,-1;int(1..)])

--

(true != __33),
Reify((sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__34],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __32), __33),
and([FlatWeightedSumLeq([3, 1],[__35, c],__34),FlatWeightedSumGeq([3, 1],[__35, c],__34);int(1..)]),
__35 =aux sum([__31,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __33),
Reify((sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__34],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __32), __33),
FlatWeightedSumLeq([3, 1],[__35, c],__34),
FlatWeightedSumGeq([3, 1],[__35, c],__34),
__35 =aux sum([__31,-1;int(1..)])

--

__35 =aux sum([__31,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __31], __35),SumGeq([-1, __31], __35);int(1..)])

--

(true != __33),
Reify((sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__34],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __32), __33),
FlatWeightedSumLeq([3, 1],[__35, c],__34),
FlatWeightedSumGeq([3, 1],[__35, c],__34),
and([SumLeq([-1, __31], __35),SumGeq([-1, __31], __35);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __33),
Reify((sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__34],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __32), __33),
FlatWeightedSumLeq([3, 1],[__35, c],__34),
FlatWeightedSumGeq([3, 1],[__35, c],__34),
SumLeq([-1, __31], __35),
SumGeq([-1, __31], __35)

--

[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__36]
new variables:
  find __36: int(1..9)
new constraints:
  __36 =aux sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__36 =aux sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__37, c],__36),FlatWeightedSumGeq([3, 1],[__37, c],__36);int(1..)])
new variables:
  find __37: int(0..2)
new constraints:
  __37 =aux sum([__31,-1;int(1..)])

--

(true != __33),
Reify((sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__34],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__36],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __32), __33),
FlatWeightedSumLeq([3, 1],[__35, c],__34),
FlatWeightedSumGeq([3, 1],[__35, c],__34),
SumLeq([-1, __31], __35),
SumGeq([-1, __31], __35),
and([FlatWeightedSumLeq([3, 1],[__37, c],__36),FlatWeightedSumGeq([3, 1],[__37, c],__36);int(1..)]),
__37 =aux sum([__31,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __33),
Reify((sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__34],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__36],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __32), __33),
FlatWeightedSumLeq([3, 1],[__35, c],__34),
FlatWeightedSumGeq([3, 1],[__35, c],__34),
SumLeq([-1, __31], __35),
SumGeq([-1, __31], __35),
FlatWeightedSumLeq([3, 1],[__37, c],__36),
FlatWeightedSumGeq([3, 1],[__37, c],__36),
__37 =aux sum([__31,-1;int(1..)])

--

__37 =aux sum([__31,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __31], __37),SumGeq([-1, __31], __37);int(1..)])

--

(true != __33),
Reify((sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__34],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__36],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __32), __33),
FlatWeightedSumLeq([3, 1],[__35, c],__34),
FlatWeightedSumGeq([3, 1],[__35, c],__34),
SumLeq([-1, __31], __35),
SumGeq([-1, __31], __35),
FlatWeightedSumLeq([3, 1],[__37, c],__36),
FlatWeightedSumGeq([3, 1],[__37, c],__36),
and([SumLeq([-1, __31], __37),SumGeq([-1, __31], __37);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __33),
Reify((sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__34],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__36],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __32), __33),
FlatWeightedSumLeq([3, 1],[__35, c],__34),
FlatWeightedSumGeq([3, 1],[__35, c],__34),
SumLeq([-1, __31], __35),
SumGeq([-1, __31], __35),
FlatWeightedSumLeq([3, 1],[__37, c],__36),
FlatWeightedSumGeq([3, 1],[__37, c],__36),
SumLeq([-1, __31], __37),
SumGeq([-1, __31], __37)

--

[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__38]
new variables:
  find __38: int(1..9)
new constraints:
  __38 =aux sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__38 =aux sum([product([3,sum([__31,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__39, c],__38),FlatWeightedSumGeq([3, 1],[__39, c],__38);int(1..)])
new variables:
  find __39: int(0..2)
new constraints:
  __39 =aux sum([__31,-1;int(1..)])

--

(true != __33),
Reify((sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__34],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__36],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__38];int(1..)]) = __32), __33),
FlatWeightedSumLeq([3, 1],[__35, c],__34),
FlatWeightedSumGeq([3, 1],[__35, c],__34),
SumLeq([-1, __31], __35),
SumGeq([-1, __31], __35),
FlatWeightedSumLeq([3, 1],[__37, c],__36),
FlatWeightedSumGeq([3, 1],[__37, c],__36),
SumLeq([-1, __31], __37),
SumGeq([-1, __31], __37),
and([FlatWeightedSumLeq([3, 1],[__39, c],__38),FlatWeightedSumGeq([3, 1],[__39, c],__38);int(1..)]),
__39 =aux sum([__31,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __33),
Reify((sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__34],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__36],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__38];int(1..)]) = __32), __33),
FlatWeightedSumLeq([3, 1],[__35, c],__34),
FlatWeightedSumGeq([3, 1],[__35, c],__34),
SumLeq([-1, __31], __35),
SumGeq([-1, __31], __35),
FlatWeightedSumLeq([3, 1],[__37, c],__36),
FlatWeightedSumGeq([3, 1],[__37, c],__36),
SumLeq([-1, __31], __37),
SumGeq([-1, __31], __37),
FlatWeightedSumLeq([3, 1],[__39, c],__38),
FlatWeightedSumGeq([3, 1],[__39, c],__38),
__39 =aux sum([__31,-1;int(1..)])

--

__39 =aux sum([__31,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __31], __39),SumGeq([-1, __31], __39);int(1..)])

--

(true != __33),
Reify((sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__34],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__36],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__38];int(1..)]) = __32), __33),
FlatWeightedSumLeq([3, 1],[__35, c],__34),
FlatWeightedSumGeq([3, 1],[__35, c],__34),
SumLeq([-1, __31], __35),
SumGeq([-1, __31], __35),
FlatWeightedSumLeq([3, 1],[__37, c],__36),
FlatWeightedSumGeq([3, 1],[__37, c],__36),
SumLeq([-1, __31], __37),
SumGeq([-1, __31], __37),
FlatWeightedSumLeq([3, 1],[__39, c],__38),
FlatWeightedSumGeq([3, 1],[__39, c],__38),
and([SumLeq([-1, __31], __39),SumGeq([-1, __31], __39);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __33),
Reify((sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__34],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__36],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__38];int(1..)]) = __32), __33),
FlatWeightedSumLeq([3, 1],[__35, c],__34),
FlatWeightedSumGeq([3, 1],[__35, c],__34),
SumLeq([-1, __31], __35),
SumGeq([-1, __31], __35),
FlatWeightedSumLeq([3, 1],[__37, c],__36),
FlatWeightedSumGeq([3, 1],[__37, c],__36),
SumLeq([-1, __31], __37),
SumGeq([-1, __31], __37),
FlatWeightedSumLeq([3, 1],[__39, c],__38),
FlatWeightedSumGeq([3, 1],[__39, c],__38),
SumLeq([-1, __31], __39),
SumGeq([-1, __31], __39)

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: int(1..24)
find __13: bool
find __14: int(1..9)
find __15: int(0..2)
find __16: int(1..9)
find __17: int(0..2)
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: int(1..24)
find __23: bool
find __24: int(1..9)
find __25: int(0..2)
find __26: int(1..9)
find __27: int(0..2)
find __28: int(1..9)
find __29: int(0..2)
find __30: matrix indexed by [Index, Index] of Value
find __31: Index
find __32: int(1..24)
find __33: bool
find __34: int(1..9)
find __35: int(0..2)
find __36: int(1..9)
find __37: int(0..2)
find __38: int(1..9)
find __39: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __30#matrix_to_atom_1_1: int(1..9)
find __30#matrix_to_atom_1_2: int(1..9)
find __30#matrix_to_atom_1_3: int(1..9)
find __30#matrix_to_atom_2_1: int(1..9)
find __30#matrix_to_atom_2_2: int(1..9)
find __30#matrix_to_atom_2_3: int(1..9)
find __30#matrix_to_atom_3_1: int(1..9)
find __30#matrix_to_atom_3_2: int(1..9)
find __30#matrix_to_atom_3_3: int(1..9)

such that

(true != __33),
Reify((sum([[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__34],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__36],[__30#matrix_to_atom_1_1,__30#matrix_to_atom_1_2,__30#matrix_to_atom_1_3,__30#matrix_to_atom_2_1,__30#matrix_to_atom_2_2,__30#matrix_to_atom_2_3,__30#matrix_to_atom_3_1,__30#matrix_to_atom_3_2,__30#matrix_to_atom_3_3;int(1..)][__38];int(1..)]) = __32), __33),
FlatWeightedSumLeq([3, 1],[__35, c],__34),
FlatWeightedSumGeq([3, 1],[__35, c],__34),
SumLeq([-1, __31], __35),
SumGeq([-1, __31], __35),
FlatWeightedSumLeq([3, 1],[__37, c],__36),
FlatWeightedSumGeq([3, 1],[__37, c],__36),
SumLeq([-1, __31], __37),
SumGeq([-1, __31], __37),
FlatWeightedSumLeq([3, 1],[__39, c],__38),
FlatWeightedSumGeq([3, 1],[__39, c],__38),
SumLeq([-1, __31], __39),
SumGeq([-1, __31], __39)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)

such that

(0 != __9[d, d])

--

(0 != __9#matrix_to_atom[d, d]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __9#matrix_to_atom[d, d])
new variables:
  find __9#matrix_to_atom_1_1: int(1..9)
  find __9#matrix_to_atom_1_2: int(1..9)
  find __9#matrix_to_atom_1_3: int(1..9)
  find __9#matrix_to_atom_2_1: int(1..9)
  find __9#matrix_to_atom_2_2: int(1..9)
  find __9#matrix_to_atom_2_3: int(1..9)
  find __9#matrix_to_atom_3_1: int(1..9)
  find __9#matrix_to_atom_3_2: int(1..9)
  find __9#matrix_to_atom_3_3: int(1..9)

--

__9#matrix_to_atom[d, d], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__9#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}

--

(0 != {__9#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __9#matrix_to_atom[d, d])

--

(0 != __9#matrix_to_atom[d, d]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(d - 1);int(1..)]),1;int(1..)])])

--

product([1,(d - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(d - 1);int(1..)])

--

product([(d - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(d - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(d - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(d - 1),1;int(1..)])])

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])

--

(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])])

--

[__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][__10]
new variables:
  find __10: int(1..9)
new constraints:
  __10 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])

--

__10 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__11, d],__10),FlatWeightedSumGeq([3, 1],[__11, d],__10);int(1..)])
new variables:
  find __11: int(0..2)
new constraints:
  __11 =aux sum([d,-1;int(1..)])

--

(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][__10]),
and([FlatWeightedSumLeq([3, 1],[__11, d],__10),FlatWeightedSumGeq([3, 1],[__11, d],__10);int(1..)]),
__11 =aux sum([d,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][__10]),
FlatWeightedSumLeq([3, 1],[__11, d],__10),
FlatWeightedSumGeq([3, 1],[__11, d],__10),
__11 =aux sum([d,-1;int(1..)])

--

__11 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __11),SumGeq([-1, d], __11);int(1..)])

--

(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][__10]),
FlatWeightedSumLeq([3, 1],[__11, d],__10),
FlatWeightedSumGeq([3, 1],[__11, d],__10),
and([SumLeq([-1, d], __11),SumGeq([-1, d], __11);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][__10]),
FlatWeightedSumLeq([3, 1],[__11, d],__10),
FlatWeightedSumGeq([3, 1],[__11, d],__10),
SumLeq([-1, d], __11),
SumGeq([-1, d], __11)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(1..9)
find __11: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__9#matrix_to_atom_1_1,__9#matrix_to_atom_1_2,__9#matrix_to_atom_1_3,__9#matrix_to_atom_2_1,__9#matrix_to_atom_2_2,__9#matrix_to_atom_2_3,__9#matrix_to_atom_3_1,__9#matrix_to_atom_3_2,__9#matrix_to_atom_3_3;int(1..)][__10]),
FlatWeightedSumLeq([3, 1],[__11, d],__10),
FlatWeightedSumGeq([3, 1],[__11, d],__10),
SumLeq([-1, d], __11),
SumGeq([-1, d], __11)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)

such that

(0 != __6[d, (4 - d)])

--

(4 - d), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([4,-(d);int(1..)])

--

(0 != __6#matrix_to_atom[d, sum([4,-(d);int(1..)])]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __6#matrix_to_atom[d, sum([4,-(d);int(1..)])])
new variables:
  find __6#matrix_to_atom_1_1: int(1..9)
  find __6#matrix_to_atom_1_2: int(1..9)
  find __6#matrix_to_atom_1_3: int(1..9)
  find __6#matrix_to_atom_2_1: int(1..9)
  find __6#matrix_to_atom_2_2: int(1..9)
  find __6#matrix_to_atom_2_3: int(1..9)
  find __6#matrix_to_atom_3_1: int(1..9)
  find __6#matrix_to_atom_3_2: int(1..9)
  find __6#matrix_to_atom_3_3: int(1..9)

--

__6#matrix_to_atom[d, sum([4,-(d);int(1..)])], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__6#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

(0 != {__6#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != {__6#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])})

--

(0 != {__6#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> bubble_up ([("Bubble", 8800)])
{(0 != __6#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

{(0 != __6#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}, 
   ~~> expand_bubble ([("Bubble", 8900)])
and([(0 != __6#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)])

--

and([(0 != __6#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __6#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])

--

(0 != __6#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __6#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(0 != __6#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(sum([4,-(d);int(1..)]) - 1);int(1..)])

--

product([(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(sum([4,-(d);int(1..)]) - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(sum([4,-(d);int(1..)]) - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([sum([4,-(d);int(1..)]),-(1);int(1..)])

--

(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-(1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])

--

(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([3,sum([d,-1;int(1..)]);int(1..)]), 
   ~~> flatten_product ([("Minion", 4200)])
product([3,__7;int(1..)])
new variables:
  find __7: int(0..2)
new constraints:
  __7 =aux sum([d,-1;int(1..)])

--

__7 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __7),SumGeq([-1, d], __7);int(1..)])

--

(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,__7;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
and([SumLeq([-1, d], __7),SumGeq([-1, d], __7);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,__7;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __7),
SumGeq([-1, d], __7)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__6#matrix_to_atom_1_1,__6#matrix_to_atom_1_2,__6#matrix_to_atom_1_3,__6#matrix_to_atom_2_1,__6#matrix_to_atom_2_2,__6#matrix_to_atom_2_3,__6#matrix_to_atom_3_1,__6#matrix_to_atom_3_2,__6#matrix_to_atom_3_3;int(1..)][sum([product([3,__7;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __7),
SumGeq([-1, d], __7)

Via-solver generator model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(4..6)
find __11: matrix indexed by [Index, Index] of Value
find __12: int(7..9)
find __13: matrix indexed by [Index, Index] of Value
find __14: int(7..9)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __11#matrix_to_atom_1_1: int(1..9)
find __11#matrix_to_atom_1_2: int(1..9)
find __11#matrix_to_atom_1_3: int(1..9)
find __11#matrix_to_atom_2_1: int(1..9)
find __11#matrix_to_atom_2_2: int(1..9)
find __11#matrix_to_atom_2_3: int(1..9)
find __11#matrix_to_atom_3_1: int(1..9)
find __11#matrix_to_atom_3_2: int(1..9)
find __11#matrix_to_atom_3_3: int(1..9)
find __13#matrix_to_atom_1_1: int(1..9)
find __13#matrix_to_atom_1_2: int(1..9)
find __13#matrix_to_atom_1_3: int(1..9)
find __13#matrix_to_atom_2_1: int(1..9)
find __13#matrix_to_atom_2_2: int(1..9)
find __13#matrix_to_atom_2_3: int(1..9)
find __13#matrix_to_atom_3_1: int(1..9)
find __13#matrix_to_atom_3_2: int(1..9)
find __13#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(4..6)
find __11: matrix indexed by [Index, Index] of Value
find __12: int(7..9)
find __13: matrix indexed by [Index, Index] of Value
find __14: int(7..9)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __11#matrix_to_atom_1_1: int(1..9)
find __11#matrix_to_atom_1_2: int(1..9)
find __11#matrix_to_atom_1_3: int(1..9)
find __11#matrix_to_atom_2_1: int(1..9)
find __11#matrix_to_atom_2_2: int(1..9)
find __11#matrix_to_atom_2_3: int(1..9)
find __11#matrix_to_atom_3_1: int(1..9)
find __11#matrix_to_atom_3_2: int(1..9)
find __11#matrix_to_atom_3_3: int(1..9)
find __13#matrix_to_atom_1_1: int(1..9)
find __13#matrix_to_atom_1_2: int(1..9)
find __13#matrix_to_atom_1_3: int(1..9)
find __13#matrix_to_atom_2_1: int(1..9)
find __13#matrix_to_atom_2_2: int(1..9)
find __13#matrix_to_atom_2_3: int(1..9)
find __13#matrix_to_atom_3_1: int(1..9)
find __13#matrix_to_atom_3_2: int(1..9)
find __13#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..9)
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: matrix indexed by [Index, Index] of Value
find __6: int(4..6)
find __7: matrix indexed by [Index, Index] of Value
find __8: int(7..9)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(4..6)
find __11: matrix indexed by [Index, Index] of Value
find __12: int(7..9)
find __13: matrix indexed by [Index, Index] of Value
find __14: int(7..9)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __7#matrix_to_atom_1_1: int(1..9)
find __7#matrix_to_atom_1_2: int(1..9)
find __7#matrix_to_atom_1_3: int(1..9)
find __7#matrix_to_atom_2_1: int(1..9)
find __7#matrix_to_atom_2_2: int(1..9)
find __7#matrix_to_atom_2_3: int(1..9)
find __7#matrix_to_atom_3_1: int(1..9)
find __7#matrix_to_atom_3_2: int(1..9)
find __7#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __11#matrix_to_atom_1_1: int(1..9)
find __11#matrix_to_atom_1_2: int(1..9)
find __11#matrix_to_atom_1_3: int(1..9)
find __11#matrix_to_atom_2_1: int(1..9)
find __11#matrix_to_atom_2_2: int(1..9)
find __11#matrix_to_atom_2_3: int(1..9)
find __11#matrix_to_atom_3_1: int(1..9)
find __11#matrix_to_atom_3_2: int(1..9)
find __11#matrix_to_atom_3_3: int(1..9)
find __13#matrix_to_atom_1_1: int(1..9)
find __13#matrix_to_atom_1_2: int(1..9)
find __13#matrix_to_atom_1_3: int(1..9)
find __13#matrix_to_atom_2_1: int(1..9)
find __13#matrix_to_atom_2_2: int(1..9)
find __13#matrix_to_atom_2_3: int(1..9)
find __13#matrix_to_atom_3_1: int(1..9)
find __13#matrix_to_atom_3_2: int(1..9)
find __13#matrix_to_atom_3_3: int(1..9)

such that

true

[ square[3, c] | c : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[square[3, 1],square[3, 2],square[3, 3];int(1..)]

--

square[3, 1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[3, 1] @ and([__inDomain(3,int(1..3)),__inDomain(1,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([{square[3, 1] @ and([__inDomain(3,int(1..3)),__inDomain(1,int(1..3));int(1..)])},square[3, 2],square[3, 3];int(1..)]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

square[3, 2], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[3, 2] @ and([__inDomain(3,int(1..3)),__inDomain(2,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],{square[3, 2] @ and([__inDomain(3,int(1..3)),__inDomain(2,int(1..3));int(1..)])},square[3, 3];int(1..)]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

square[3, 3], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[3, 3] @ and([__inDomain(3,int(1..3)),__inDomain(3,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],{square[3, 3] @ and([__inDomain(3,int(1..3)),__inDomain(3,int(1..3));int(1..)])};int(1..)]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: int(1..24)
find __13: bool
find __14: int(1..9)
find __15: int(0..2)
find __16: int(1..9)
find __17: int(0..2)
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: int(1..24)
find __23: bool
find __24: int(1..9)
find __25: int(0..2)
find __26: int(1..9)
find __27: int(0..2)
find __28: int(1..9)
find __29: int(0..2)
find __30: matrix indexed by [Index, Index] of Value
find __31: Index
find __32: int(1..24)
find __33: bool
find __34: int(1..9)
find __35: int(0..2)
find __36: int(1..9)
find __37: int(0..2)
find __38: int(1..9)
find __39: int(0..2)
find __40: matrix indexed by [Index, Index] of Value
find __41: Index
find __42: int(1..24)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __30#matrix_to_atom_1_1: int(1..9)
find __30#matrix_to_atom_1_2: int(1..9)
find __30#matrix_to_atom_1_3: int(1..9)
find __30#matrix_to_atom_2_1: int(1..9)
find __30#matrix_to_atom_2_2: int(1..9)
find __30#matrix_to_atom_2_3: int(1..9)
find __30#matrix_to_atom_3_1: int(1..9)
find __30#matrix_to_atom_3_2: int(1..9)
find __30#matrix_to_atom_3_3: int(1..9)

such that

(true != (sum([ __40[__41, c] | r : Index ]) = __42))

--

(true != (sum([ __40[__41, c] | r : Index ]) = __42)), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(true != (sum([ __40[__41, c] | r : Index ]) = __42))
new variables:
  find __40#matrix_to_atom_1_1: int(1..9)
  find __40#matrix_to_atom_1_2: int(1..9)
  find __40#matrix_to_atom_1_3: int(1..9)
  find __40#matrix_to_atom_2_1: int(1..9)
  find __40#matrix_to_atom_2_2: int(1..9)
  find __40#matrix_to_atom_2_3: int(1..9)
  find __40#matrix_to_atom_3_1: int(1..9)
  find __40#matrix_to_atom_3_2: int(1..9)
  find __40#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)

such that

(0 != __20[__21, __22])

--

(0 != __20#matrix_to_atom[__21, __22]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __20#matrix_to_atom[__21, __22])
new variables:
  find __20#matrix_to_atom_1_1: int(1..9)
  find __20#matrix_to_atom_1_2: int(1..9)
  find __20#matrix_to_atom_1_3: int(1..9)
  find __20#matrix_to_atom_2_1: int(1..9)
  find __20#matrix_to_atom_2_2: int(1..9)
  find __20#matrix_to_atom_2_3: int(1..9)
  find __20#matrix_to_atom_3_1: int(1..9)
  find __20#matrix_to_atom_3_2: int(1..9)
  find __20#matrix_to_atom_3_3: int(1..9)

--

__20#matrix_to_atom[__21, __22], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__20#matrix_to_atom[__21, __22] @ and([__inDomain(__21,int(1..3)),__inDomain(__22,int(1..3));int(1..)])}

--

(0 != {__20#matrix_to_atom[__21, __22] @ and([__inDomain(__21,int(1..3)),__inDomain(__22,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __20#matrix_to_atom[__21, __22])

--

(0 != __20#matrix_to_atom[__21, __22]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,(__21 - 1);int(1..)]),product([1,(__22 - 1);int(1..)]),1;int(1..)])])

--

product([1,(__22 - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(__22 - 1);int(1..)])

--

product([(__22 - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(__22 - 1)

--

(__21 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__21,-(1);int(1..)])

--

(0 != [__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-(1);int(1..)]);int(1..)]),(__22 - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),(__22 - 1),1;int(1..)])])

--

(__22 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__22,-(1);int(1..)])

--

(0 != [__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),sum([__22,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),sum([__22,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),sum([__22,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),__22,-1,1;int(1..)])

--

(0 != [__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),__22,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),__22;int(1..)])])

--

[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),__22;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__23]
new variables:
  find __23: int(1..9)
new constraints:
  __23 =aux sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),__22;int(1..)])

--

__23 =aux sum([product([3,sum([__21,-1;int(1..)]);int(1..)]),__22;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[__22, __24],__23),FlatWeightedSumGeq([1, 3],[__22, __24],__23);int(1..)])
new variables:
  find __24: int(0..2)
new constraints:
  __24 =aux sum([__21,-1;int(1..)])

--

(0 != [__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__23]),
and([FlatWeightedSumLeq([1, 3],[__22, __24],__23),FlatWeightedSumGeq([1, 3],[__22, __24],__23);int(1..)]),
__24 =aux sum([__21,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__23]),
FlatWeightedSumLeq([1, 3],[__22, __24],__23),
FlatWeightedSumGeq([1, 3],[__22, __24],__23),
__24 =aux sum([__21,-1;int(1..)])

--

__24 =aux sum([__21,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __21], __24),SumGeq([-1, __21], __24);int(1..)])

--

(0 != [__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__23]),
FlatWeightedSumLeq([1, 3],[__22, __24],__23),
FlatWeightedSumGeq([1, 3],[__22, __24],__23),
and([SumLeq([-1, __21], __24),SumGeq([-1, __21], __24);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__23]),
FlatWeightedSumLeq([1, 3],[__22, __24],__23),
FlatWeightedSumGeq([1, 3],[__22, __24],__23),
SumLeq([-1, __21], __24),
SumGeq([-1, __21], __24)

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__20#matrix_to_atom_1_1,__20#matrix_to_atom_1_2,__20#matrix_to_atom_1_3,__20#matrix_to_atom_2_1,__20#matrix_to_atom_2_2,__20#matrix_to_atom_2_3,__20#matrix_to_atom_3_1,__20#matrix_to_atom_3_2,__20#matrix_to_atom_3_3;int(1..)][__23]),
FlatWeightedSumLeq([1, 3],[__22, __24],__23),
FlatWeightedSumGeq([1, 3],[__22, __24],__23),
SumLeq([-1, __21], __24),
SumGeq([-1, __21], __24)

Via-solver generator model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)

such that

true

[ __40[__41, c] | r : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[__40[__41, c],__40[__41, c],__40[__41, c];int(1..)]

--

(true != (sum([__40#matrix_to_atom[__41, c],__40#matrix_to_atom[__41, c],__40#matrix_to_atom[__41, c];int(1..)]) = __42)), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(true != (sum([__40#matrix_to_atom[__41, c],__40#matrix_to_atom[__41, c],__40#matrix_to_atom[__41, c];int(1..)]) = __42))

--

__40#matrix_to_atom[__41, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__40#matrix_to_atom[__41, c] @ and([__inDomain(__41,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([{__40#matrix_to_atom[__41, c] @ and([__inDomain(__41,int(1..3)),__inDomain(c,int(1..3));int(1..)])},__40#matrix_to_atom[__41, c],__40#matrix_to_atom[__41, c];int(1..)]) = __42)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__40#matrix_to_atom[__41, c],__40#matrix_to_atom[__41, c],__40#matrix_to_atom[__41, c];int(1..)]) = __42))

--

__40#matrix_to_atom[__41, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__40#matrix_to_atom[__41, c] @ and([__inDomain(__41,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([__40#matrix_to_atom[__41, c],{__40#matrix_to_atom[__41, c] @ and([__inDomain(__41,int(1..3)),__inDomain(c,int(1..3));int(1..)])},__40#matrix_to_atom[__41, c];int(1..)]) = __42)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__40#matrix_to_atom[__41, c],__40#matrix_to_atom[__41, c],__40#matrix_to_atom[__41, c];int(1..)]) = __42))

--

__40#matrix_to_atom[__41, c], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__40#matrix_to_atom[__41, c] @ and([__inDomain(__41,int(1..3)),__inDomain(c,int(1..3));int(1..)])}

--

(true != (sum([__40#matrix_to_atom[__41, c],__40#matrix_to_atom[__41, c],{__40#matrix_to_atom[__41, c] @ and([__inDomain(__41,int(1..3)),__inDomain(c,int(1..3));int(1..)])};int(1..)]) = __42)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([__40#matrix_to_atom[__41, c],__40#matrix_to_atom[__41, c],__40#matrix_to_atom[__41, c];int(1..)]) = __42))

--

(true != (sum([__40#matrix_to_atom[__41, c],__40#matrix_to_atom[__41, c],__40#matrix_to_atom[__41, c];int(1..)]) = __42)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),product([1,(c - 1);int(1..)]),1;int(1..)])];int(1..)]) = __42))

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

product([1,(c - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(c - 1);int(1..)])

--

product([(c - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(c - 1)

--

(__41 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__41,-(1);int(1..)])

--

(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __42)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __42))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __42)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __42))

--

sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __42)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __42))

--

(__41 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__41,-(1);int(1..)])

--

(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __42)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __42))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __42)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __42))

--

sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __42)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(__41 - 1);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __42))

--

(__41 - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([__41,-(1);int(1..)])

--

(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-(1);int(1..)]);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __42)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),(c - 1),1;int(1..)])];int(1..)]) = __42))

--

(c - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([c,-(1);int(1..)])

--

(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),sum([c,-(1);int(1..)]),1;int(1..)])];int(1..)]) = __42)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)])];int(1..)]) = __42))

--

sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),sum([c,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])

--

(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c,-1,1;int(1..)])];int(1..)]) = __42)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __42))

--

(true != (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __42)), 
   ~~> flatten_generic ([("Minion", 4200)])
(true != __43)
new variables:
  find __43: bool
new constraints:
  __43 =aux (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __42)

--

__43 =aux (sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __42), 
   ~~> bool_eq_to_reify ([("Minion", 4400)])
Reify((sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __42), __43)

--

[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__44]
new variables:
  find __44: int(1..9)
new constraints:
  __44 =aux sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__44 =aux sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__45, c],__44),FlatWeightedSumGeq([3, 1],[__45, c],__44);int(1..)])
new variables:
  find __45: int(0..2)
new constraints:
  __45 =aux sum([__41,-1;int(1..)])

--

(true != __43),
Reify((sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__44],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __42), __43),
and([FlatWeightedSumLeq([3, 1],[__45, c],__44),FlatWeightedSumGeq([3, 1],[__45, c],__44);int(1..)]),
__45 =aux sum([__41,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __43),
Reify((sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__44],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __42), __43),
FlatWeightedSumLeq([3, 1],[__45, c],__44),
FlatWeightedSumGeq([3, 1],[__45, c],__44),
__45 =aux sum([__41,-1;int(1..)])

--

__45 =aux sum([__41,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __41], __45),SumGeq([-1, __41], __45);int(1..)])

--

(true != __43),
Reify((sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__44],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __42), __43),
FlatWeightedSumLeq([3, 1],[__45, c],__44),
FlatWeightedSumGeq([3, 1],[__45, c],__44),
and([SumLeq([-1, __41], __45),SumGeq([-1, __41], __45);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __43),
Reify((sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__44],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __42), __43),
FlatWeightedSumLeq([3, 1],[__45, c],__44),
FlatWeightedSumGeq([3, 1],[__45, c],__44),
SumLeq([-1, __41], __45),
SumGeq([-1, __41], __45)

--

[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__46]
new variables:
  find __46: int(1..9)
new constraints:
  __46 =aux sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__46 =aux sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__47, c],__46),FlatWeightedSumGeq([3, 1],[__47, c],__46);int(1..)])
new variables:
  find __47: int(0..2)
new constraints:
  __47 =aux sum([__41,-1;int(1..)])

--

(true != __43),
Reify((sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__44],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__46],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __42), __43),
FlatWeightedSumLeq([3, 1],[__45, c],__44),
FlatWeightedSumGeq([3, 1],[__45, c],__44),
SumLeq([-1, __41], __45),
SumGeq([-1, __41], __45),
and([FlatWeightedSumLeq([3, 1],[__47, c],__46),FlatWeightedSumGeq([3, 1],[__47, c],__46);int(1..)]),
__47 =aux sum([__41,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __43),
Reify((sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__44],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__46],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __42), __43),
FlatWeightedSumLeq([3, 1],[__45, c],__44),
FlatWeightedSumGeq([3, 1],[__45, c],__44),
SumLeq([-1, __41], __45),
SumGeq([-1, __41], __45),
FlatWeightedSumLeq([3, 1],[__47, c],__46),
FlatWeightedSumGeq([3, 1],[__47, c],__46),
__47 =aux sum([__41,-1;int(1..)])

--

__47 =aux sum([__41,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __41], __47),SumGeq([-1, __41], __47);int(1..)])

--

(true != __43),
Reify((sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__44],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__46],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __42), __43),
FlatWeightedSumLeq([3, 1],[__45, c],__44),
FlatWeightedSumGeq([3, 1],[__45, c],__44),
SumLeq([-1, __41], __45),
SumGeq([-1, __41], __45),
FlatWeightedSumLeq([3, 1],[__47, c],__46),
FlatWeightedSumGeq([3, 1],[__47, c],__46),
and([SumLeq([-1, __41], __47),SumGeq([-1, __41], __47);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __43),
Reify((sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__44],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__46],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])];int(1..)]) = __42), __43),
FlatWeightedSumLeq([3, 1],[__45, c],__44),
FlatWeightedSumGeq([3, 1],[__45, c],__44),
SumLeq([-1, __41], __45),
SumGeq([-1, __41], __45),
FlatWeightedSumLeq([3, 1],[__47, c],__46),
FlatWeightedSumGeq([3, 1],[__47, c],__46),
SumLeq([-1, __41], __47),
SumGeq([-1, __41], __47)

--

[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__48]
new variables:
  find __48: int(1..9)
new constraints:
  __48 =aux sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)])

--

__48 =aux sum([product([3,sum([__41,-1;int(1..)]);int(1..)]),c;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__49, c],__48),FlatWeightedSumGeq([3, 1],[__49, c],__48);int(1..)])
new variables:
  find __49: int(0..2)
new constraints:
  __49 =aux sum([__41,-1;int(1..)])

--

(true != __43),
Reify((sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__44],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__46],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__48];int(1..)]) = __42), __43),
FlatWeightedSumLeq([3, 1],[__45, c],__44),
FlatWeightedSumGeq([3, 1],[__45, c],__44),
SumLeq([-1, __41], __45),
SumGeq([-1, __41], __45),
FlatWeightedSumLeq([3, 1],[__47, c],__46),
FlatWeightedSumGeq([3, 1],[__47, c],__46),
SumLeq([-1, __41], __47),
SumGeq([-1, __41], __47),
and([FlatWeightedSumLeq([3, 1],[__49, c],__48),FlatWeightedSumGeq([3, 1],[__49, c],__48);int(1..)]),
__49 =aux sum([__41,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __43),
Reify((sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__44],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__46],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__48];int(1..)]) = __42), __43),
FlatWeightedSumLeq([3, 1],[__45, c],__44),
FlatWeightedSumGeq([3, 1],[__45, c],__44),
SumLeq([-1, __41], __45),
SumGeq([-1, __41], __45),
FlatWeightedSumLeq([3, 1],[__47, c],__46),
FlatWeightedSumGeq([3, 1],[__47, c],__46),
SumLeq([-1, __41], __47),
SumGeq([-1, __41], __47),
FlatWeightedSumLeq([3, 1],[__49, c],__48),
FlatWeightedSumGeq([3, 1],[__49, c],__48),
__49 =aux sum([__41,-1;int(1..)])

--

__49 =aux sum([__41,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, __41], __49),SumGeq([-1, __41], __49);int(1..)])

--

(true != __43),
Reify((sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__44],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__46],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__48];int(1..)]) = __42), __43),
FlatWeightedSumLeq([3, 1],[__45, c],__44),
FlatWeightedSumGeq([3, 1],[__45, c],__44),
SumLeq([-1, __41], __45),
SumGeq([-1, __41], __45),
FlatWeightedSumLeq([3, 1],[__47, c],__46),
FlatWeightedSumGeq([3, 1],[__47, c],__46),
SumLeq([-1, __41], __47),
SumGeq([-1, __41], __47),
FlatWeightedSumLeq([3, 1],[__49, c],__48),
FlatWeightedSumGeq([3, 1],[__49, c],__48),
and([SumLeq([-1, __41], __49),SumGeq([-1, __41], __49);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __43),
Reify((sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__44],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__46],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__48];int(1..)]) = __42), __43),
FlatWeightedSumLeq([3, 1],[__45, c],__44),
FlatWeightedSumGeq([3, 1],[__45, c],__44),
SumLeq([-1, __41], __45),
SumGeq([-1, __41], __45),
FlatWeightedSumLeq([3, 1],[__47, c],__46),
FlatWeightedSumGeq([3, 1],[__47, c],__46),
SumLeq([-1, __41], __47),
SumGeq([-1, __41], __47),
FlatWeightedSumLeq([3, 1],[__49, c],__48),
FlatWeightedSumGeq([3, 1],[__49, c],__48),
SumLeq([-1, __41], __49),
SumGeq([-1, __41], __49)

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: int(1..24)
find __13: bool
find __14: int(1..9)
find __15: int(0..2)
find __16: int(1..9)
find __17: int(0..2)
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: int(1..24)
find __23: bool
find __24: int(1..9)
find __25: int(0..2)
find __26: int(1..9)
find __27: int(0..2)
find __28: int(1..9)
find __29: int(0..2)
find __30: matrix indexed by [Index, Index] of Value
find __31: Index
find __32: int(1..24)
find __33: bool
find __34: int(1..9)
find __35: int(0..2)
find __36: int(1..9)
find __37: int(0..2)
find __38: int(1..9)
find __39: int(0..2)
find __40: matrix indexed by [Index, Index] of Value
find __41: Index
find __42: int(1..24)
find __43: bool
find __44: int(1..9)
find __45: int(0..2)
find __46: int(1..9)
find __47: int(0..2)
find __48: int(1..9)
find __49: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __30#matrix_to_atom_1_1: int(1..9)
find __30#matrix_to_atom_1_2: int(1..9)
find __30#matrix_to_atom_1_3: int(1..9)
find __30#matrix_to_atom_2_1: int(1..9)
find __30#matrix_to_atom_2_2: int(1..9)
find __30#matrix_to_atom_2_3: int(1..9)
find __30#matrix_to_atom_3_1: int(1..9)
find __30#matrix_to_atom_3_2: int(1..9)
find __30#matrix_to_atom_3_3: int(1..9)
find __40#matrix_to_atom_1_1: int(1..9)
find __40#matrix_to_atom_1_2: int(1..9)
find __40#matrix_to_atom_1_3: int(1..9)
find __40#matrix_to_atom_2_1: int(1..9)
find __40#matrix_to_atom_2_2: int(1..9)
find __40#matrix_to_atom_2_3: int(1..9)
find __40#matrix_to_atom_3_1: int(1..9)
find __40#matrix_to_atom_3_2: int(1..9)
find __40#matrix_to_atom_3_3: int(1..9)

such that

(true != __43),
Reify((sum([[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__44],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__46],[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__48];int(1..)]) = __42), __43),
FlatWeightedSumLeq([3, 1],[__45, c],__44),
FlatWeightedSumGeq([3, 1],[__45, c],__44),
SumLeq([-1, __41], __45),
SumGeq([-1, __41], __45),
FlatWeightedSumLeq([3, 1],[__47, c],__46),
FlatWeightedSumGeq([3, 1],[__47, c],__46),
SumLeq([-1, __41], __47),
SumGeq([-1, __41], __47),
FlatWeightedSumLeq([3, 1],[__49, c],__48),
FlatWeightedSumGeq([3, 1],[__49, c],__48),
SumLeq([-1, __41], __49),
SumGeq([-1, __41], __49)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(1..9)
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)

such that

(0 != __12[d, d])

--

(0 != __12#matrix_to_atom[d, d]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __12#matrix_to_atom[d, d])
new variables:
  find __12#matrix_to_atom_1_1: int(1..9)
  find __12#matrix_to_atom_1_2: int(1..9)
  find __12#matrix_to_atom_1_3: int(1..9)
  find __12#matrix_to_atom_2_1: int(1..9)
  find __12#matrix_to_atom_2_2: int(1..9)
  find __12#matrix_to_atom_2_3: int(1..9)
  find __12#matrix_to_atom_3_1: int(1..9)
  find __12#matrix_to_atom_3_2: int(1..9)
  find __12#matrix_to_atom_3_3: int(1..9)

--

__12#matrix_to_atom[d, d], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__12#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}

--

(0 != {__12#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __12#matrix_to_atom[d, d])

--

(0 != __12#matrix_to_atom[d, d]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(d - 1);int(1..)]),1;int(1..)])])

--

product([1,(d - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(d - 1);int(1..)])

--

product([(d - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(d - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(d - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(d - 1),1;int(1..)])])

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])

--

(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])])

--

[__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][__13]
new variables:
  find __13: int(1..9)
new constraints:
  __13 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])

--

__13 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__14, d],__13),FlatWeightedSumGeq([3, 1],[__14, d],__13);int(1..)])
new variables:
  find __14: int(0..2)
new constraints:
  __14 =aux sum([d,-1;int(1..)])

--

(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][__13]),
and([FlatWeightedSumLeq([3, 1],[__14, d],__13),FlatWeightedSumGeq([3, 1],[__14, d],__13);int(1..)]),
__14 =aux sum([d,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][__13]),
FlatWeightedSumLeq([3, 1],[__14, d],__13),
FlatWeightedSumGeq([3, 1],[__14, d],__13),
__14 =aux sum([d,-1;int(1..)])

--

__14 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __14),SumGeq([-1, d], __14);int(1..)])

--

(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][__13]),
FlatWeightedSumLeq([3, 1],[__14, d],__13),
FlatWeightedSumGeq([3, 1],[__14, d],__13),
and([SumLeq([-1, d], __14),SumGeq([-1, d], __14);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][__13]),
FlatWeightedSumLeq([3, 1],[__14, d],__13),
FlatWeightedSumGeq([3, 1],[__14, d],__13),
SumLeq([-1, d], __14),
SumGeq([-1, d], __14)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(1..9)
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(1..9)
find __14: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][__13]),
FlatWeightedSumLeq([3, 1],[__14, d],__13),
FlatWeightedSumGeq([3, 1],[__14, d],__13),
SumLeq([-1, d], __14),
SumGeq([-1, d], __14)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)

such that

(0 != __8[d, (4 - d)])

--

(4 - d), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([4,-(d);int(1..)])

--

(0 != __8#matrix_to_atom[d, sum([4,-(d);int(1..)])]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __8#matrix_to_atom[d, sum([4,-(d);int(1..)])])
new variables:
  find __8#matrix_to_atom_1_1: int(1..9)
  find __8#matrix_to_atom_1_2: int(1..9)
  find __8#matrix_to_atom_1_3: int(1..9)
  find __8#matrix_to_atom_2_1: int(1..9)
  find __8#matrix_to_atom_2_2: int(1..9)
  find __8#matrix_to_atom_2_3: int(1..9)
  find __8#matrix_to_atom_3_1: int(1..9)
  find __8#matrix_to_atom_3_2: int(1..9)
  find __8#matrix_to_atom_3_3: int(1..9)

--

__8#matrix_to_atom[d, sum([4,-(d);int(1..)])], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__8#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

(0 != {__8#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != {__8#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])})

--

(0 != {__8#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> bubble_up ([("Bubble", 8800)])
{(0 != __8#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

{(0 != __8#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}, 
   ~~> expand_bubble ([("Bubble", 8900)])
and([(0 != __8#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)])

--

and([(0 != __8#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __8#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])

--

(0 != __8#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __8#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(0 != __8#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__8#matrix_to_atom_1_1,__8#matrix_to_atom_1_2,__8#matrix_to_atom_1_3,__8#matrix_to_atom_2_1,__8#matrix_to_atom_2_2,__8#matrix_to_atom_2_3,__8#matrix_to_atom_3_1,__8#matrix_to_atom_3_2,__8#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(sum([4,-(d);int(1..)]) - 1);int(1..)])

--

product([(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(sum([4,-(d);int(1..)]) - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__8#matrix_to_atom_1_1,__8#matrix_to_atom_1_2,__8#matrix_to_atom_1_3,__8#matrix_to_atom_2_1,__8#matrix_to_atom_2_2,__8#matrix_to_atom_2_3,__8#matrix_to_atom_3_1,__8#matrix_to_atom_3_2,__8#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__8#matrix_to_atom_1_1,__8#matrix_to_atom_1_2,__8#matrix_to_atom_1_3,__8#matrix_to_atom_2_1,__8#matrix_to_atom_2_2,__8#matrix_to_atom_2_3,__8#matrix_to_atom_3_1,__8#matrix_to_atom_3_2,__8#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(sum([4,-(d);int(1..)]) - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([sum([4,-(d);int(1..)]),-(1);int(1..)])

--

(0 != [__8#matrix_to_atom_1_1,__8#matrix_to_atom_1_2,__8#matrix_to_atom_1_3,__8#matrix_to_atom_2_1,__8#matrix_to_atom_2_2,__8#matrix_to_atom_2_3,__8#matrix_to_atom_3_1,__8#matrix_to_atom_3_2,__8#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-(1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__8#matrix_to_atom_1_1,__8#matrix_to_atom_1_2,__8#matrix_to_atom_1_3,__8#matrix_to_atom_2_1,__8#matrix_to_atom_2_2,__8#matrix_to_atom_2_3,__8#matrix_to_atom_3_1,__8#matrix_to_atom_3_2,__8#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])

--

(0 != [__8#matrix_to_atom_1_1,__8#matrix_to_atom_1_2,__8#matrix_to_atom_1_3,__8#matrix_to_atom_2_1,__8#matrix_to_atom_2_2,__8#matrix_to_atom_2_3,__8#matrix_to_atom_3_1,__8#matrix_to_atom_3_2,__8#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__8#matrix_to_atom_1_1,__8#matrix_to_atom_1_2,__8#matrix_to_atom_1_3,__8#matrix_to_atom_2_1,__8#matrix_to_atom_2_2,__8#matrix_to_atom_2_3,__8#matrix_to_atom_3_1,__8#matrix_to_atom_3_2,__8#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([3,sum([d,-1;int(1..)]);int(1..)]), 
   ~~> flatten_product ([("Minion", 4200)])
product([3,__9;int(1..)])
new variables:
  find __9: int(0..2)
new constraints:
  __9 =aux sum([d,-1;int(1..)])

--

__9 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __9),SumGeq([-1, d], __9);int(1..)])

--

(0 != [__8#matrix_to_atom_1_1,__8#matrix_to_atom_1_2,__8#matrix_to_atom_1_3,__8#matrix_to_atom_2_1,__8#matrix_to_atom_2_2,__8#matrix_to_atom_2_3,__8#matrix_to_atom_3_1,__8#matrix_to_atom_3_2,__8#matrix_to_atom_3_3;int(1..)][sum([product([3,__9;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
and([SumLeq([-1, d], __9),SumGeq([-1, d], __9);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__8#matrix_to_atom_1_1,__8#matrix_to_atom_1_2,__8#matrix_to_atom_1_3,__8#matrix_to_atom_2_1,__8#matrix_to_atom_2_2,__8#matrix_to_atom_2_3,__8#matrix_to_atom_3_1,__8#matrix_to_atom_3_2,__8#matrix_to_atom_3_3;int(1..)][sum([product([3,__9;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __9),
SumGeq([-1, d], __9)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __9: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __8#matrix_to_atom_1_1: int(1..9)
find __8#matrix_to_atom_1_2: int(1..9)
find __8#matrix_to_atom_1_3: int(1..9)
find __8#matrix_to_atom_2_1: int(1..9)
find __8#matrix_to_atom_2_2: int(1..9)
find __8#matrix_to_atom_2_3: int(1..9)
find __8#matrix_to_atom_3_1: int(1..9)
find __8#matrix_to_atom_3_2: int(1..9)
find __8#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__8#matrix_to_atom_1_1,__8#matrix_to_atom_1_2,__8#matrix_to_atom_1_3,__8#matrix_to_atom_2_1,__8#matrix_to_atom_2_2,__8#matrix_to_atom_2_3,__8#matrix_to_atom_3_1,__8#matrix_to_atom_3_2,__8#matrix_to_atom_3_3;int(1..)][sum([product([3,__9;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __9),
SumGeq([-1, d], __9)

Via-solver generator model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: int(1..24)
find __13: bool
find __14: int(1..9)
find __15: int(0..2)
find __16: int(1..9)
find __17: int(0..2)
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: int(1..24)
find __23: bool
find __24: int(1..9)
find __25: int(0..2)
find __26: int(1..9)
find __27: int(0..2)
find __28: int(1..9)
find __29: int(0..2)
find __30: matrix indexed by [Index, Index] of Value
find __31: Index
find __32: int(1..24)
find __33: bool
find __34: int(1..9)
find __35: int(0..2)
find __36: int(1..9)
find __37: int(0..2)
find __38: int(1..9)
find __39: int(0..2)
find __40: matrix indexed by [Index, Index] of Value
find __41: Index
find __42: int(1..24)
find __43: bool
find __44: int(1..9)
find __45: int(0..2)
find __46: int(1..9)
find __47: int(0..2)
find __48: int(1..9)
find __49: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __30#matrix_to_atom_1_1: int(1..9)
find __30#matrix_to_atom_1_2: int(1..9)
find __30#matrix_to_atom_1_3: int(1..9)
find __30#matrix_to_atom_2_1: int(1..9)
find __30#matrix_to_atom_2_2: int(1..9)
find __30#matrix_to_atom_2_3: int(1..9)
find __30#matrix_to_atom_3_1: int(1..9)
find __30#matrix_to_atom_3_2: int(1..9)
find __30#matrix_to_atom_3_3: int(1..9)
find __40#matrix_to_atom_1_1: int(1..9)
find __40#matrix_to_atom_1_2: int(1..9)
find __40#matrix_to_atom_1_3: int(1..9)
find __40#matrix_to_atom_2_1: int(1..9)
find __40#matrix_to_atom_2_2: int(1..9)
find __40#matrix_to_atom_2_3: int(1..9)
find __40#matrix_to_atom_3_1: int(1..9)
find __40#matrix_to_atom_3_2: int(1..9)
find __40#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: int(1..24)
find __13: bool
find __14: int(1..9)
find __15: int(0..2)
find __16: int(1..9)
find __17: int(0..2)
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: int(1..24)
find __23: bool
find __24: int(1..9)
find __25: int(0..2)
find __26: int(1..9)
find __27: int(0..2)
find __28: int(1..9)
find __29: int(0..2)
find __30: matrix indexed by [Index, Index] of Value
find __31: Index
find __32: int(1..24)
find __33: bool
find __34: int(1..9)
find __35: int(0..2)
find __36: int(1..9)
find __37: int(0..2)
find __38: int(1..9)
find __39: int(0..2)
find __40: matrix indexed by [Index, Index] of Value
find __41: Index
find __42: int(1..24)
find __43: bool
find __44: int(1..9)
find __45: int(0..2)
find __46: int(1..9)
find __47: int(0..2)
find __48: int(1..9)
find __49: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __30#matrix_to_atom_1_1: int(1..9)
find __30#matrix_to_atom_1_2: int(1..9)
find __30#matrix_to_atom_1_3: int(1..9)
find __30#matrix_to_atom_2_1: int(1..9)
find __30#matrix_to_atom_2_2: int(1..9)
find __30#matrix_to_atom_2_3: int(1..9)
find __30#matrix_to_atom_3_1: int(1..9)
find __30#matrix_to_atom_3_2: int(1..9)
find __30#matrix_to_atom_3_3: int(1..9)
find __40#matrix_to_atom_1_1: int(1..9)
find __40#matrix_to_atom_1_2: int(1..9)
find __40#matrix_to_atom_1_3: int(1..9)
find __40#matrix_to_atom_2_1: int(1..9)
find __40#matrix_to_atom_2_2: int(1..9)
find __40#matrix_to_atom_2_3: int(1..9)
find __40#matrix_to_atom_3_1: int(1..9)
find __40#matrix_to_atom_3_2: int(1..9)
find __40#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find c: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: int(1..24)
find __3: bool
find __4: int(1..9)
find __5: int(0..2)
find __6: int(1..9)
find __7: int(0..2)
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: int(1..24)
find __13: bool
find __14: int(1..9)
find __15: int(0..2)
find __16: int(1..9)
find __17: int(0..2)
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: int(1..24)
find __23: bool
find __24: int(1..9)
find __25: int(0..2)
find __26: int(1..9)
find __27: int(0..2)
find __28: int(1..9)
find __29: int(0..2)
find __30: matrix indexed by [Index, Index] of Value
find __31: Index
find __32: int(1..24)
find __33: bool
find __34: int(1..9)
find __35: int(0..2)
find __36: int(1..9)
find __37: int(0..2)
find __38: int(1..9)
find __39: int(0..2)
find __40: matrix indexed by [Index, Index] of Value
find __41: Index
find __42: int(1..24)
find __43: bool
find __44: int(1..9)
find __45: int(0..2)
find __46: int(1..9)
find __47: int(0..2)
find __48: int(1..9)
find __49: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __30#matrix_to_atom_1_1: int(1..9)
find __30#matrix_to_atom_1_2: int(1..9)
find __30#matrix_to_atom_1_3: int(1..9)
find __30#matrix_to_atom_2_1: int(1..9)
find __30#matrix_to_atom_2_2: int(1..9)
find __30#matrix_to_atom_2_3: int(1..9)
find __30#matrix_to_atom_3_1: int(1..9)
find __30#matrix_to_atom_3_2: int(1..9)
find __30#matrix_to_atom_3_3: int(1..9)
find __40#matrix_to_atom_1_1: int(1..9)
find __40#matrix_to_atom_1_2: int(1..9)
find __40#matrix_to_atom_1_3: int(1..9)
find __40#matrix_to_atom_2_1: int(1..9)
find __40#matrix_to_atom_2_2: int(1..9)
find __40#matrix_to_atom_2_3: int(1..9)
find __40#matrix_to_atom_3_1: int(1..9)
find __40#matrix_to_atom_3_2: int(1..9)
find __40#matrix_to_atom_3_3: int(1..9)

such that

true

[ (sum([ square[r, c] | r : Index ]) = s) | c : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[(sum([ square[r, 1] | r : Index ]) = s),(sum([ square[r, 2] | r : Index ]) = s),(sum([ square[r, 3] | r : Index ]) = s);int(1..)]

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
and([(sum([ square[r, 1] | r : Index ]) = s),(sum([ square[r, 2] | r : Index ]) = s),(sum([ square[r, 3] | r : Index ]) = s);int(1..)]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([ square[r, 1] | r : Index ]) = s),
(sum([ square[r, 2] | r : Index ]) = s),
(sum([ square[r, 3] | r : Index ]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)

such that

(0 != __25[r, 1])

--

(0 != __25#matrix_to_atom[r, 1]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __25#matrix_to_atom[r, 1])
new variables:
  find __25#matrix_to_atom_1_1: int(1..9)
  find __25#matrix_to_atom_1_2: int(1..9)
  find __25#matrix_to_atom_1_3: int(1..9)
  find __25#matrix_to_atom_2_1: int(1..9)
  find __25#matrix_to_atom_2_2: int(1..9)
  find __25#matrix_to_atom_2_3: int(1..9)
  find __25#matrix_to_atom_3_1: int(1..9)
  find __25#matrix_to_atom_3_2: int(1..9)
  find __25#matrix_to_atom_3_3: int(1..9)

--

__25#matrix_to_atom[r, 1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__25#matrix_to_atom[r, 1] @ and([__inDomain(r,int(1..3)),__inDomain(1,int(1..3));int(1..)])}

--

(0 != {__25#matrix_to_atom[r, 1] @ and([__inDomain(r,int(1..3)),__inDomain(1,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __25#matrix_to_atom[r, 1])

--

(0 != __25#matrix_to_atom[r, 1]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__25#matrix_to_atom_1_1,__25#matrix_to_atom_1_2,__25#matrix_to_atom_1_3,__25#matrix_to_atom_2_1,__25#matrix_to_atom_2_2,__25#matrix_to_atom_2_3,__25#matrix_to_atom_3_1,__25#matrix_to_atom_3_2,__25#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(1 - 1);int(1..)]),1;int(1..)])])

--

(0 != [__25#matrix_to_atom_1_1,__25#matrix_to_atom_1_2,__25#matrix_to_atom_1_3,__25#matrix_to_atom_2_1,__25#matrix_to_atom_2_2,__25#matrix_to_atom_2_3,__25#matrix_to_atom_3_1,__25#matrix_to_atom_3_2,__25#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(1 - 1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__25#matrix_to_atom_1_1,__25#matrix_to_atom_1_2,__25#matrix_to_atom_1_3,__25#matrix_to_atom_2_1,__25#matrix_to_atom_2_2,__25#matrix_to_atom_2_3,__25#matrix_to_atom_3_1,__25#matrix_to_atom_3_2,__25#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),1;int(1..)])])

--

(r - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([r,-(1);int(1..)])

--

(0 != [__25#matrix_to_atom_1_1,__25#matrix_to_atom_1_2,__25#matrix_to_atom_1_3,__25#matrix_to_atom_2_1,__25#matrix_to_atom_2_2,__25#matrix_to_atom_2_3,__25#matrix_to_atom_3_1,__25#matrix_to_atom_3_2,__25#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-(1);int(1..)]);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__25#matrix_to_atom_1_1,__25#matrix_to_atom_1_2,__25#matrix_to_atom_1_3,__25#matrix_to_atom_2_1,__25#matrix_to_atom_2_2,__25#matrix_to_atom_2_3,__25#matrix_to_atom_3_1,__25#matrix_to_atom_3_2,__25#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),1;int(1..)])])

--

[__25#matrix_to_atom_1_1,__25#matrix_to_atom_1_2,__25#matrix_to_atom_1_3,__25#matrix_to_atom_2_1,__25#matrix_to_atom_2_2,__25#matrix_to_atom_2_3,__25#matrix_to_atom_3_1,__25#matrix_to_atom_3_2,__25#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),1;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__25#matrix_to_atom_1_1,__25#matrix_to_atom_1_2,__25#matrix_to_atom_1_3,__25#matrix_to_atom_2_1,__25#matrix_to_atom_2_2,__25#matrix_to_atom_2_3,__25#matrix_to_atom_3_1,__25#matrix_to_atom_3_2,__25#matrix_to_atom_3_3;int(1..)][__26]
new variables:
  find __26: int(1..7)
new constraints:
  __26 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),1;int(1..)])

--

__26 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[1, __27],__26),FlatWeightedSumGeq([1, 3],[1, __27],__26);int(1..)])
new variables:
  find __27: int(0..2)
new constraints:
  __27 =aux sum([r,-1;int(1..)])

--

(0 != [__25#matrix_to_atom_1_1,__25#matrix_to_atom_1_2,__25#matrix_to_atom_1_3,__25#matrix_to_atom_2_1,__25#matrix_to_atom_2_2,__25#matrix_to_atom_2_3,__25#matrix_to_atom_3_1,__25#matrix_to_atom_3_2,__25#matrix_to_atom_3_3;int(1..)][__26]),
and([FlatWeightedSumLeq([1, 3],[1, __27],__26),FlatWeightedSumGeq([1, 3],[1, __27],__26);int(1..)]),
__27 =aux sum([r,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__25#matrix_to_atom_1_1,__25#matrix_to_atom_1_2,__25#matrix_to_atom_1_3,__25#matrix_to_atom_2_1,__25#matrix_to_atom_2_2,__25#matrix_to_atom_2_3,__25#matrix_to_atom_3_1,__25#matrix_to_atom_3_2,__25#matrix_to_atom_3_3;int(1..)][__26]),
FlatWeightedSumLeq([1, 3],[1, __27],__26),
FlatWeightedSumGeq([1, 3],[1, __27],__26),
__27 =aux sum([r,-1;int(1..)])

--

__27 =aux sum([r,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, r], __27),SumGeq([-1, r], __27);int(1..)])

--

(0 != [__25#matrix_to_atom_1_1,__25#matrix_to_atom_1_2,__25#matrix_to_atom_1_3,__25#matrix_to_atom_2_1,__25#matrix_to_atom_2_2,__25#matrix_to_atom_2_3,__25#matrix_to_atom_3_1,__25#matrix_to_atom_3_2,__25#matrix_to_atom_3_3;int(1..)][__26]),
FlatWeightedSumLeq([1, 3],[1, __27],__26),
FlatWeightedSumGeq([1, 3],[1, __27],__26),
and([SumLeq([-1, r], __27),SumGeq([-1, r], __27);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__25#matrix_to_atom_1_1,__25#matrix_to_atom_1_2,__25#matrix_to_atom_1_3,__25#matrix_to_atom_2_1,__25#matrix_to_atom_2_2,__25#matrix_to_atom_2_3,__25#matrix_to_atom_3_1,__25#matrix_to_atom_3_2,__25#matrix_to_atom_3_3;int(1..)][__26]),
FlatWeightedSumLeq([1, 3],[1, __27],__26),
FlatWeightedSumGeq([1, 3],[1, __27],__26),
SumLeq([-1, r], __27),
SumGeq([-1, r], __27)

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__25#matrix_to_atom_1_1,__25#matrix_to_atom_1_2,__25#matrix_to_atom_1_3,__25#matrix_to_atom_2_1,__25#matrix_to_atom_2_2,__25#matrix_to_atom_2_3,__25#matrix_to_atom_3_1,__25#matrix_to_atom_3_2,__25#matrix_to_atom_3_3;int(1..)][__26]),
FlatWeightedSumLeq([1, 3],[1, __27],__26),
FlatWeightedSumGeq([1, 3],[1, __27],__26),
SumLeq([-1, r], __27),
SumGeq([-1, r], __27)

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)

such that

(0 != __28[r, 2])

--

(0 != __28#matrix_to_atom[r, 2]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __28#matrix_to_atom[r, 2])
new variables:
  find __28#matrix_to_atom_1_1: int(1..9)
  find __28#matrix_to_atom_1_2: int(1..9)
  find __28#matrix_to_atom_1_3: int(1..9)
  find __28#matrix_to_atom_2_1: int(1..9)
  find __28#matrix_to_atom_2_2: int(1..9)
  find __28#matrix_to_atom_2_3: int(1..9)
  find __28#matrix_to_atom_3_1: int(1..9)
  find __28#matrix_to_atom_3_2: int(1..9)
  find __28#matrix_to_atom_3_3: int(1..9)

--

__28#matrix_to_atom[r, 2], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__28#matrix_to_atom[r, 2] @ and([__inDomain(r,int(1..3)),__inDomain(2,int(1..3));int(1..)])}

--

(0 != {__28#matrix_to_atom[r, 2] @ and([__inDomain(r,int(1..3)),__inDomain(2,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __28#matrix_to_atom[r, 2])

--

(0 != __28#matrix_to_atom[r, 2]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__28#matrix_to_atom_1_1,__28#matrix_to_atom_1_2,__28#matrix_to_atom_1_3,__28#matrix_to_atom_2_1,__28#matrix_to_atom_2_2,__28#matrix_to_atom_2_3,__28#matrix_to_atom_3_1,__28#matrix_to_atom_3_2,__28#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(2 - 1);int(1..)]),1;int(1..)])])

--

(0 != [__28#matrix_to_atom_1_1,__28#matrix_to_atom_1_2,__28#matrix_to_atom_1_3,__28#matrix_to_atom_2_1,__28#matrix_to_atom_2_2,__28#matrix_to_atom_2_3,__28#matrix_to_atom_3_1,__28#matrix_to_atom_3_2,__28#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(2 - 1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__28#matrix_to_atom_1_1,__28#matrix_to_atom_1_2,__28#matrix_to_atom_1_3,__28#matrix_to_atom_2_1,__28#matrix_to_atom_2_2,__28#matrix_to_atom_2_3,__28#matrix_to_atom_3_1,__28#matrix_to_atom_3_2,__28#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),2;int(1..)])])

--

(r - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([r,-(1);int(1..)])

--

(0 != [__28#matrix_to_atom_1_1,__28#matrix_to_atom_1_2,__28#matrix_to_atom_1_3,__28#matrix_to_atom_2_1,__28#matrix_to_atom_2_2,__28#matrix_to_atom_2_3,__28#matrix_to_atom_3_1,__28#matrix_to_atom_3_2,__28#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-(1);int(1..)]);int(1..)]),2;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__28#matrix_to_atom_1_1,__28#matrix_to_atom_1_2,__28#matrix_to_atom_1_3,__28#matrix_to_atom_2_1,__28#matrix_to_atom_2_2,__28#matrix_to_atom_2_3,__28#matrix_to_atom_3_1,__28#matrix_to_atom_3_2,__28#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),2;int(1..)])])

--

[__28#matrix_to_atom_1_1,__28#matrix_to_atom_1_2,__28#matrix_to_atom_1_3,__28#matrix_to_atom_2_1,__28#matrix_to_atom_2_2,__28#matrix_to_atom_2_3,__28#matrix_to_atom_3_1,__28#matrix_to_atom_3_2,__28#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),2;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__28#matrix_to_atom_1_1,__28#matrix_to_atom_1_2,__28#matrix_to_atom_1_3,__28#matrix_to_atom_2_1,__28#matrix_to_atom_2_2,__28#matrix_to_atom_2_3,__28#matrix_to_atom_3_1,__28#matrix_to_atom_3_2,__28#matrix_to_atom_3_3;int(1..)][__29]
new variables:
  find __29: int(2..8)
new constraints:
  __29 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),2;int(1..)])

--

__29 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),2;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[2, __30],__29),FlatWeightedSumGeq([1, 3],[2, __30],__29);int(1..)])
new variables:
  find __30: int(0..2)
new constraints:
  __30 =aux sum([r,-1;int(1..)])

--

(0 != [__28#matrix_to_atom_1_1,__28#matrix_to_atom_1_2,__28#matrix_to_atom_1_3,__28#matrix_to_atom_2_1,__28#matrix_to_atom_2_2,__28#matrix_to_atom_2_3,__28#matrix_to_atom_3_1,__28#matrix_to_atom_3_2,__28#matrix_to_atom_3_3;int(1..)][__29]),
and([FlatWeightedSumLeq([1, 3],[2, __30],__29),FlatWeightedSumGeq([1, 3],[2, __30],__29);int(1..)]),
__30 =aux sum([r,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__28#matrix_to_atom_1_1,__28#matrix_to_atom_1_2,__28#matrix_to_atom_1_3,__28#matrix_to_atom_2_1,__28#matrix_to_atom_2_2,__28#matrix_to_atom_2_3,__28#matrix_to_atom_3_1,__28#matrix_to_atom_3_2,__28#matrix_to_atom_3_3;int(1..)][__29]),
FlatWeightedSumLeq([1, 3],[2, __30],__29),
FlatWeightedSumGeq([1, 3],[2, __30],__29),
__30 =aux sum([r,-1;int(1..)])

--

__30 =aux sum([r,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, r], __30),SumGeq([-1, r], __30);int(1..)])

--

(0 != [__28#matrix_to_atom_1_1,__28#matrix_to_atom_1_2,__28#matrix_to_atom_1_3,__28#matrix_to_atom_2_1,__28#matrix_to_atom_2_2,__28#matrix_to_atom_2_3,__28#matrix_to_atom_3_1,__28#matrix_to_atom_3_2,__28#matrix_to_atom_3_3;int(1..)][__29]),
FlatWeightedSumLeq([1, 3],[2, __30],__29),
FlatWeightedSumGeq([1, 3],[2, __30],__29),
and([SumLeq([-1, r], __30),SumGeq([-1, r], __30);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__28#matrix_to_atom_1_1,__28#matrix_to_atom_1_2,__28#matrix_to_atom_1_3,__28#matrix_to_atom_2_1,__28#matrix_to_atom_2_2,__28#matrix_to_atom_2_3,__28#matrix_to_atom_3_1,__28#matrix_to_atom_3_2,__28#matrix_to_atom_3_3;int(1..)][__29]),
FlatWeightedSumLeq([1, 3],[2, __30],__29),
FlatWeightedSumGeq([1, 3],[2, __30],__29),
SumLeq([-1, r], __30),
SumGeq([-1, r], __30)

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__28#matrix_to_atom_1_1,__28#matrix_to_atom_1_2,__28#matrix_to_atom_1_3,__28#matrix_to_atom_2_1,__28#matrix_to_atom_2_2,__28#matrix_to_atom_2_3,__28#matrix_to_atom_3_1,__28#matrix_to_atom_3_2,__28#matrix_to_atom_3_3;int(1..)][__29]),
FlatWeightedSumLeq([1, 3],[2, __30],__29),
FlatWeightedSumGeq([1, 3],[2, __30],__29),
SumLeq([-1, r], __30),
SumGeq([-1, r], __30)

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)

such that

(0 != __31[r, 3])

--

(0 != __31#matrix_to_atom[r, 3]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __31#matrix_to_atom[r, 3])
new variables:
  find __31#matrix_to_atom_1_1: int(1..9)
  find __31#matrix_to_atom_1_2: int(1..9)
  find __31#matrix_to_atom_1_3: int(1..9)
  find __31#matrix_to_atom_2_1: int(1..9)
  find __31#matrix_to_atom_2_2: int(1..9)
  find __31#matrix_to_atom_2_3: int(1..9)
  find __31#matrix_to_atom_3_1: int(1..9)
  find __31#matrix_to_atom_3_2: int(1..9)
  find __31#matrix_to_atom_3_3: int(1..9)

--

__31#matrix_to_atom[r, 3], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__31#matrix_to_atom[r, 3] @ and([__inDomain(r,int(1..3)),__inDomain(3,int(1..3));int(1..)])}

--

(0 != {__31#matrix_to_atom[r, 3] @ and([__inDomain(r,int(1..3)),__inDomain(3,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __31#matrix_to_atom[r, 3])

--

(0 != __31#matrix_to_atom[r, 3]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__31#matrix_to_atom_1_1,__31#matrix_to_atom_1_2,__31#matrix_to_atom_1_3,__31#matrix_to_atom_2_1,__31#matrix_to_atom_2_2,__31#matrix_to_atom_2_3,__31#matrix_to_atom_3_1,__31#matrix_to_atom_3_2,__31#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(3 - 1);int(1..)]),1;int(1..)])])

--

(0 != [__31#matrix_to_atom_1_1,__31#matrix_to_atom_1_2,__31#matrix_to_atom_1_3,__31#matrix_to_atom_2_1,__31#matrix_to_atom_2_2,__31#matrix_to_atom_2_3,__31#matrix_to_atom_3_1,__31#matrix_to_atom_3_2,__31#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(3 - 1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__31#matrix_to_atom_1_1,__31#matrix_to_atom_1_2,__31#matrix_to_atom_1_3,__31#matrix_to_atom_2_1,__31#matrix_to_atom_2_2,__31#matrix_to_atom_2_3,__31#matrix_to_atom_3_1,__31#matrix_to_atom_3_2,__31#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),3;int(1..)])])

--

(r - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([r,-(1);int(1..)])

--

(0 != [__31#matrix_to_atom_1_1,__31#matrix_to_atom_1_2,__31#matrix_to_atom_1_3,__31#matrix_to_atom_2_1,__31#matrix_to_atom_2_2,__31#matrix_to_atom_2_3,__31#matrix_to_atom_3_1,__31#matrix_to_atom_3_2,__31#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-(1);int(1..)]);int(1..)]),3;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__31#matrix_to_atom_1_1,__31#matrix_to_atom_1_2,__31#matrix_to_atom_1_3,__31#matrix_to_atom_2_1,__31#matrix_to_atom_2_2,__31#matrix_to_atom_2_3,__31#matrix_to_atom_3_1,__31#matrix_to_atom_3_2,__31#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),3;int(1..)])])

--

[__31#matrix_to_atom_1_1,__31#matrix_to_atom_1_2,__31#matrix_to_atom_1_3,__31#matrix_to_atom_2_1,__31#matrix_to_atom_2_2,__31#matrix_to_atom_2_3,__31#matrix_to_atom_3_1,__31#matrix_to_atom_3_2,__31#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),3;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__31#matrix_to_atom_1_1,__31#matrix_to_atom_1_2,__31#matrix_to_atom_1_3,__31#matrix_to_atom_2_1,__31#matrix_to_atom_2_2,__31#matrix_to_atom_2_3,__31#matrix_to_atom_3_1,__31#matrix_to_atom_3_2,__31#matrix_to_atom_3_3;int(1..)][__32]
new variables:
  find __32: int(3..9)
new constraints:
  __32 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),3;int(1..)])

--

__32 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),3;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[3, __33],__32),FlatWeightedSumGeq([1, 3],[3, __33],__32);int(1..)])
new variables:
  find __33: int(0..2)
new constraints:
  __33 =aux sum([r,-1;int(1..)])

--

(0 != [__31#matrix_to_atom_1_1,__31#matrix_to_atom_1_2,__31#matrix_to_atom_1_3,__31#matrix_to_atom_2_1,__31#matrix_to_atom_2_2,__31#matrix_to_atom_2_3,__31#matrix_to_atom_3_1,__31#matrix_to_atom_3_2,__31#matrix_to_atom_3_3;int(1..)][__32]),
and([FlatWeightedSumLeq([1, 3],[3, __33],__32),FlatWeightedSumGeq([1, 3],[3, __33],__32);int(1..)]),
__33 =aux sum([r,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__31#matrix_to_atom_1_1,__31#matrix_to_atom_1_2,__31#matrix_to_atom_1_3,__31#matrix_to_atom_2_1,__31#matrix_to_atom_2_2,__31#matrix_to_atom_2_3,__31#matrix_to_atom_3_1,__31#matrix_to_atom_3_2,__31#matrix_to_atom_3_3;int(1..)][__32]),
FlatWeightedSumLeq([1, 3],[3, __33],__32),
FlatWeightedSumGeq([1, 3],[3, __33],__32),
__33 =aux sum([r,-1;int(1..)])

--

__33 =aux sum([r,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, r], __33),SumGeq([-1, r], __33);int(1..)])

--

(0 != [__31#matrix_to_atom_1_1,__31#matrix_to_atom_1_2,__31#matrix_to_atom_1_3,__31#matrix_to_atom_2_1,__31#matrix_to_atom_2_2,__31#matrix_to_atom_2_3,__31#matrix_to_atom_3_1,__31#matrix_to_atom_3_2,__31#matrix_to_atom_3_3;int(1..)][__32]),
FlatWeightedSumLeq([1, 3],[3, __33],__32),
FlatWeightedSumGeq([1, 3],[3, __33],__32),
and([SumLeq([-1, r], __33),SumGeq([-1, r], __33);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__31#matrix_to_atom_1_1,__31#matrix_to_atom_1_2,__31#matrix_to_atom_1_3,__31#matrix_to_atom_2_1,__31#matrix_to_atom_2_2,__31#matrix_to_atom_2_3,__31#matrix_to_atom_3_1,__31#matrix_to_atom_3_2,__31#matrix_to_atom_3_3;int(1..)][__32]),
FlatWeightedSumLeq([1, 3],[3, __33],__32),
FlatWeightedSumGeq([1, 3],[3, __33],__32),
SumLeq([-1, r], __33),
SumGeq([-1, r], __33)

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__31#matrix_to_atom_1_1,__31#matrix_to_atom_1_2,__31#matrix_to_atom_1_3,__31#matrix_to_atom_2_1,__31#matrix_to_atom_2_2,__31#matrix_to_atom_2_3,__31#matrix_to_atom_3_1,__31#matrix_to_atom_3_2,__31#matrix_to_atom_3_3;int(1..)][__32]),
FlatWeightedSumLeq([1, 3],[3, __33],__32),
FlatWeightedSumGeq([1, 3],[3, __33],__32),
SumLeq([-1, r], __33),
SumGeq([-1, r], __33)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(1..9)
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)

such that

(0 != __15[d, d])

--

(0 != __15#matrix_to_atom[d, d]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __15#matrix_to_atom[d, d])
new variables:
  find __15#matrix_to_atom_1_1: int(1..9)
  find __15#matrix_to_atom_1_2: int(1..9)
  find __15#matrix_to_atom_1_3: int(1..9)
  find __15#matrix_to_atom_2_1: int(1..9)
  find __15#matrix_to_atom_2_2: int(1..9)
  find __15#matrix_to_atom_2_3: int(1..9)
  find __15#matrix_to_atom_3_1: int(1..9)
  find __15#matrix_to_atom_3_2: int(1..9)
  find __15#matrix_to_atom_3_3: int(1..9)

--

__15#matrix_to_atom[d, d], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__15#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}

--

(0 != {__15#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __15#matrix_to_atom[d, d])

--

(0 != __15#matrix_to_atom[d, d]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(d - 1);int(1..)]),1;int(1..)])])

--

product([1,(d - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(d - 1);int(1..)])

--

product([(d - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(d - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(d - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(d - 1),1;int(1..)])])

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])

--

(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])])

--

[__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][__16]
new variables:
  find __16: int(1..9)
new constraints:
  __16 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])

--

__16 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__17, d],__16),FlatWeightedSumGeq([3, 1],[__17, d],__16);int(1..)])
new variables:
  find __17: int(0..2)
new constraints:
  __17 =aux sum([d,-1;int(1..)])

--

(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][__16]),
and([FlatWeightedSumLeq([3, 1],[__17, d],__16),FlatWeightedSumGeq([3, 1],[__17, d],__16);int(1..)]),
__17 =aux sum([d,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][__16]),
FlatWeightedSumLeq([3, 1],[__17, d],__16),
FlatWeightedSumGeq([3, 1],[__17, d],__16),
__17 =aux sum([d,-1;int(1..)])

--

__17 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __17),SumGeq([-1, d], __17);int(1..)])

--

(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][__16]),
FlatWeightedSumLeq([3, 1],[__17, d],__16),
FlatWeightedSumGeq([3, 1],[__17, d],__16),
and([SumLeq([-1, d], __17),SumGeq([-1, d], __17);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][__16]),
FlatWeightedSumLeq([3, 1],[__17, d],__16),
FlatWeightedSumGeq([3, 1],[__17, d],__16),
SumLeq([-1, d], __17),
SumGeq([-1, d], __17)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(1..9)
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: int(1..9)
find __17: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__15#matrix_to_atom_1_1,__15#matrix_to_atom_1_2,__15#matrix_to_atom_1_3,__15#matrix_to_atom_2_1,__15#matrix_to_atom_2_2,__15#matrix_to_atom_2_3,__15#matrix_to_atom_3_1,__15#matrix_to_atom_3_2,__15#matrix_to_atom_3_3;int(1..)][__16]),
FlatWeightedSumLeq([3, 1],[__17, d],__16),
FlatWeightedSumGeq([3, 1],[__17, d],__16),
SumLeq([-1, d], __17),
SumGeq([-1, d], __17)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __8#matrix_to_atom_1_1: int(1..9)
find __8#matrix_to_atom_1_2: int(1..9)
find __8#matrix_to_atom_1_3: int(1..9)
find __8#matrix_to_atom_2_1: int(1..9)
find __8#matrix_to_atom_2_2: int(1..9)
find __8#matrix_to_atom_2_3: int(1..9)
find __8#matrix_to_atom_3_1: int(1..9)
find __8#matrix_to_atom_3_2: int(1..9)
find __8#matrix_to_atom_3_3: int(1..9)

such that

(0 != __10[d, (4 - d)])

--

(4 - d), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([4,-(d);int(1..)])

--

(0 != __10#matrix_to_atom[d, sum([4,-(d);int(1..)])]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __10#matrix_to_atom[d, sum([4,-(d);int(1..)])])
new variables:
  find __10#matrix_to_atom_1_1: int(1..9)
  find __10#matrix_to_atom_1_2: int(1..9)
  find __10#matrix_to_atom_1_3: int(1..9)
  find __10#matrix_to_atom_2_1: int(1..9)
  find __10#matrix_to_atom_2_2: int(1..9)
  find __10#matrix_to_atom_2_3: int(1..9)
  find __10#matrix_to_atom_3_1: int(1..9)
  find __10#matrix_to_atom_3_2: int(1..9)
  find __10#matrix_to_atom_3_3: int(1..9)

--

__10#matrix_to_atom[d, sum([4,-(d);int(1..)])], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__10#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

(0 != {__10#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != {__10#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])})

--

(0 != {__10#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> bubble_up ([("Bubble", 8800)])
{(0 != __10#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

{(0 != __10#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}, 
   ~~> expand_bubble ([("Bubble", 8900)])
and([(0 != __10#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)])

--

and([(0 != __10#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __10#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])

--

(0 != __10#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __10#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(0 != __10#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(sum([4,-(d);int(1..)]) - 1);int(1..)])

--

product([(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(sum([4,-(d);int(1..)]) - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(sum([4,-(d);int(1..)]) - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([sum([4,-(d);int(1..)]),-(1);int(1..)])

--

(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-(1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])

--

(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([3,sum([d,-1;int(1..)]);int(1..)]), 
   ~~> flatten_product ([("Minion", 4200)])
product([3,__11;int(1..)])
new variables:
  find __11: int(0..2)
new constraints:
  __11 =aux sum([d,-1;int(1..)])

--

__11 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __11),SumGeq([-1, d], __11);int(1..)])

--

(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,__11;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
and([SumLeq([-1, d], __11),SumGeq([-1, d], __11);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,__11;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __11),
SumGeq([-1, d], __11)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __8#matrix_to_atom_1_1: int(1..9)
find __8#matrix_to_atom_1_2: int(1..9)
find __8#matrix_to_atom_1_3: int(1..9)
find __8#matrix_to_atom_2_1: int(1..9)
find __8#matrix_to_atom_2_2: int(1..9)
find __8#matrix_to_atom_2_3: int(1..9)
find __8#matrix_to_atom_3_1: int(1..9)
find __8#matrix_to_atom_3_2: int(1..9)
find __8#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__10#matrix_to_atom_1_1,__10#matrix_to_atom_1_2,__10#matrix_to_atom_1_3,__10#matrix_to_atom_2_1,__10#matrix_to_atom_2_2,__10#matrix_to_atom_2_3,__10#matrix_to_atom_3_1,__10#matrix_to_atom_3_2,__10#matrix_to_atom_3_3;int(1..)][sum([product([3,__11;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __11),
SumGeq([-1, d], __11)

Via-solver generator model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)

such that

true

[ square[r, 1] | r : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[square[1, 1],square[2, 1],square[3, 1];int(1..)]

--

square[1, 1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[1, 1] @ and([__inDomain(1,int(1..3)),__inDomain(1,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([{square[1, 1] @ and([__inDomain(1,int(1..3)),__inDomain(1,int(1..3));int(1..)])},square[2, 1],square[3, 1];int(1..)]) = s),
(sum([ square[r, 2] | r : Index ]) = s),
(sum([ square[r, 3] | r : Index ]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([ square[r, 2] | r : Index ]) = s),
(sum([ square[r, 3] | r : Index ]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

square[2, 1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[2, 1] @ and([__inDomain(2,int(1..3)),__inDomain(1,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],{square[2, 1] @ and([__inDomain(2,int(1..3)),__inDomain(1,int(1..3));int(1..)])},square[3, 1];int(1..)]) = s),
(sum([ square[r, 2] | r : Index ]) = s),
(sum([ square[r, 3] | r : Index ]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([ square[r, 2] | r : Index ]) = s),
(sum([ square[r, 3] | r : Index ]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

square[3, 1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[3, 1] @ and([__inDomain(3,int(1..3)),__inDomain(1,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],{square[3, 1] @ and([__inDomain(3,int(1..3)),__inDomain(1,int(1..3));int(1..)])};int(1..)]) = s),
(sum([ square[r, 2] | r : Index ]) = s),
(sum([ square[r, 3] | r : Index ]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([ square[r, 2] | r : Index ]) = s),
(sum([ square[r, 3] | r : Index ]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __34: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)

such that

(0 != __34[r, 2])

--

(0 != __34#matrix_to_atom[r, 2]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __34#matrix_to_atom[r, 2])
new variables:
  find __34#matrix_to_atom_1_1: int(1..9)
  find __34#matrix_to_atom_1_2: int(1..9)
  find __34#matrix_to_atom_1_3: int(1..9)
  find __34#matrix_to_atom_2_1: int(1..9)
  find __34#matrix_to_atom_2_2: int(1..9)
  find __34#matrix_to_atom_2_3: int(1..9)
  find __34#matrix_to_atom_3_1: int(1..9)
  find __34#matrix_to_atom_3_2: int(1..9)
  find __34#matrix_to_atom_3_3: int(1..9)

--

__34#matrix_to_atom[r, 2], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__34#matrix_to_atom[r, 2] @ and([__inDomain(r,int(1..3)),__inDomain(2,int(1..3));int(1..)])}

--

(0 != {__34#matrix_to_atom[r, 2] @ and([__inDomain(r,int(1..3)),__inDomain(2,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __34#matrix_to_atom[r, 2])

--

(0 != __34#matrix_to_atom[r, 2]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__34#matrix_to_atom_1_1,__34#matrix_to_atom_1_2,__34#matrix_to_atom_1_3,__34#matrix_to_atom_2_1,__34#matrix_to_atom_2_2,__34#matrix_to_atom_2_3,__34#matrix_to_atom_3_1,__34#matrix_to_atom_3_2,__34#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(2 - 1);int(1..)]),1;int(1..)])])

--

(0 != [__34#matrix_to_atom_1_1,__34#matrix_to_atom_1_2,__34#matrix_to_atom_1_3,__34#matrix_to_atom_2_1,__34#matrix_to_atom_2_2,__34#matrix_to_atom_2_3,__34#matrix_to_atom_3_1,__34#matrix_to_atom_3_2,__34#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(2 - 1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__34#matrix_to_atom_1_1,__34#matrix_to_atom_1_2,__34#matrix_to_atom_1_3,__34#matrix_to_atom_2_1,__34#matrix_to_atom_2_2,__34#matrix_to_atom_2_3,__34#matrix_to_atom_3_1,__34#matrix_to_atom_3_2,__34#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),2;int(1..)])])

--

(r - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([r,-(1);int(1..)])

--

(0 != [__34#matrix_to_atom_1_1,__34#matrix_to_atom_1_2,__34#matrix_to_atom_1_3,__34#matrix_to_atom_2_1,__34#matrix_to_atom_2_2,__34#matrix_to_atom_2_3,__34#matrix_to_atom_3_1,__34#matrix_to_atom_3_2,__34#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-(1);int(1..)]);int(1..)]),2;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__34#matrix_to_atom_1_1,__34#matrix_to_atom_1_2,__34#matrix_to_atom_1_3,__34#matrix_to_atom_2_1,__34#matrix_to_atom_2_2,__34#matrix_to_atom_2_3,__34#matrix_to_atom_3_1,__34#matrix_to_atom_3_2,__34#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),2;int(1..)])])

--

[__34#matrix_to_atom_1_1,__34#matrix_to_atom_1_2,__34#matrix_to_atom_1_3,__34#matrix_to_atom_2_1,__34#matrix_to_atom_2_2,__34#matrix_to_atom_2_3,__34#matrix_to_atom_3_1,__34#matrix_to_atom_3_2,__34#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),2;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__34#matrix_to_atom_1_1,__34#matrix_to_atom_1_2,__34#matrix_to_atom_1_3,__34#matrix_to_atom_2_1,__34#matrix_to_atom_2_2,__34#matrix_to_atom_2_3,__34#matrix_to_atom_3_1,__34#matrix_to_atom_3_2,__34#matrix_to_atom_3_3;int(1..)][__35]
new variables:
  find __35: int(2..8)
new constraints:
  __35 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),2;int(1..)])

--

__35 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),2;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[2, __36],__35),FlatWeightedSumGeq([1, 3],[2, __36],__35);int(1..)])
new variables:
  find __36: int(0..2)
new constraints:
  __36 =aux sum([r,-1;int(1..)])

--

(0 != [__34#matrix_to_atom_1_1,__34#matrix_to_atom_1_2,__34#matrix_to_atom_1_3,__34#matrix_to_atom_2_1,__34#matrix_to_atom_2_2,__34#matrix_to_atom_2_3,__34#matrix_to_atom_3_1,__34#matrix_to_atom_3_2,__34#matrix_to_atom_3_3;int(1..)][__35]),
and([FlatWeightedSumLeq([1, 3],[2, __36],__35),FlatWeightedSumGeq([1, 3],[2, __36],__35);int(1..)]),
__36 =aux sum([r,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__34#matrix_to_atom_1_1,__34#matrix_to_atom_1_2,__34#matrix_to_atom_1_3,__34#matrix_to_atom_2_1,__34#matrix_to_atom_2_2,__34#matrix_to_atom_2_3,__34#matrix_to_atom_3_1,__34#matrix_to_atom_3_2,__34#matrix_to_atom_3_3;int(1..)][__35]),
FlatWeightedSumLeq([1, 3],[2, __36],__35),
FlatWeightedSumGeq([1, 3],[2, __36],__35),
__36 =aux sum([r,-1;int(1..)])

--

__36 =aux sum([r,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, r], __36),SumGeq([-1, r], __36);int(1..)])

--

(0 != [__34#matrix_to_atom_1_1,__34#matrix_to_atom_1_2,__34#matrix_to_atom_1_3,__34#matrix_to_atom_2_1,__34#matrix_to_atom_2_2,__34#matrix_to_atom_2_3,__34#matrix_to_atom_3_1,__34#matrix_to_atom_3_2,__34#matrix_to_atom_3_3;int(1..)][__35]),
FlatWeightedSumLeq([1, 3],[2, __36],__35),
FlatWeightedSumGeq([1, 3],[2, __36],__35),
and([SumLeq([-1, r], __36),SumGeq([-1, r], __36);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__34#matrix_to_atom_1_1,__34#matrix_to_atom_1_2,__34#matrix_to_atom_1_3,__34#matrix_to_atom_2_1,__34#matrix_to_atom_2_2,__34#matrix_to_atom_2_3,__34#matrix_to_atom_3_1,__34#matrix_to_atom_3_2,__34#matrix_to_atom_3_3;int(1..)][__35]),
FlatWeightedSumLeq([1, 3],[2, __36],__35),
FlatWeightedSumGeq([1, 3],[2, __36],__35),
SumLeq([-1, r], __36),
SumGeq([-1, r], __36)

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __34: matrix indexed by [Index, Index] of Value
find __35: int(2..8)
find __36: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)
find __34#matrix_to_atom_1_1: int(1..9)
find __34#matrix_to_atom_1_2: int(1..9)
find __34#matrix_to_atom_1_3: int(1..9)
find __34#matrix_to_atom_2_1: int(1..9)
find __34#matrix_to_atom_2_2: int(1..9)
find __34#matrix_to_atom_2_3: int(1..9)
find __34#matrix_to_atom_3_1: int(1..9)
find __34#matrix_to_atom_3_2: int(1..9)
find __34#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__34#matrix_to_atom_1_1,__34#matrix_to_atom_1_2,__34#matrix_to_atom_1_3,__34#matrix_to_atom_2_1,__34#matrix_to_atom_2_2,__34#matrix_to_atom_2_3,__34#matrix_to_atom_3_1,__34#matrix_to_atom_3_2,__34#matrix_to_atom_3_3;int(1..)][__35]),
FlatWeightedSumLeq([1, 3],[2, __36],__35),
FlatWeightedSumGeq([1, 3],[2, __36],__35),
SumLeq([-1, r], __36),
SumGeq([-1, r], __36)

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __34: matrix indexed by [Index, Index] of Value
find __35: int(2..8)
find __36: int(0..2)
find __37: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)
find __34#matrix_to_atom_1_1: int(1..9)
find __34#matrix_to_atom_1_2: int(1..9)
find __34#matrix_to_atom_1_3: int(1..9)
find __34#matrix_to_atom_2_1: int(1..9)
find __34#matrix_to_atom_2_2: int(1..9)
find __34#matrix_to_atom_2_3: int(1..9)
find __34#matrix_to_atom_3_1: int(1..9)
find __34#matrix_to_atom_3_2: int(1..9)
find __34#matrix_to_atom_3_3: int(1..9)

such that

(0 != __37[r, 3])

--

(0 != __37#matrix_to_atom[r, 3]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __37#matrix_to_atom[r, 3])
new variables:
  find __37#matrix_to_atom_1_1: int(1..9)
  find __37#matrix_to_atom_1_2: int(1..9)
  find __37#matrix_to_atom_1_3: int(1..9)
  find __37#matrix_to_atom_2_1: int(1..9)
  find __37#matrix_to_atom_2_2: int(1..9)
  find __37#matrix_to_atom_2_3: int(1..9)
  find __37#matrix_to_atom_3_1: int(1..9)
  find __37#matrix_to_atom_3_2: int(1..9)
  find __37#matrix_to_atom_3_3: int(1..9)

--

__37#matrix_to_atom[r, 3], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__37#matrix_to_atom[r, 3] @ and([__inDomain(r,int(1..3)),__inDomain(3,int(1..3));int(1..)])}

--

(0 != {__37#matrix_to_atom[r, 3] @ and([__inDomain(r,int(1..3)),__inDomain(3,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __37#matrix_to_atom[r, 3])

--

(0 != __37#matrix_to_atom[r, 3]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__37#matrix_to_atom_1_1,__37#matrix_to_atom_1_2,__37#matrix_to_atom_1_3,__37#matrix_to_atom_2_1,__37#matrix_to_atom_2_2,__37#matrix_to_atom_2_3,__37#matrix_to_atom_3_1,__37#matrix_to_atom_3_2,__37#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(3 - 1);int(1..)]),1;int(1..)])])

--

(0 != [__37#matrix_to_atom_1_1,__37#matrix_to_atom_1_2,__37#matrix_to_atom_1_3,__37#matrix_to_atom_2_1,__37#matrix_to_atom_2_2,__37#matrix_to_atom_2_3,__37#matrix_to_atom_3_1,__37#matrix_to_atom_3_2,__37#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(3 - 1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__37#matrix_to_atom_1_1,__37#matrix_to_atom_1_2,__37#matrix_to_atom_1_3,__37#matrix_to_atom_2_1,__37#matrix_to_atom_2_2,__37#matrix_to_atom_2_3,__37#matrix_to_atom_3_1,__37#matrix_to_atom_3_2,__37#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),3;int(1..)])])

--

(r - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([r,-(1);int(1..)])

--

(0 != [__37#matrix_to_atom_1_1,__37#matrix_to_atom_1_2,__37#matrix_to_atom_1_3,__37#matrix_to_atom_2_1,__37#matrix_to_atom_2_2,__37#matrix_to_atom_2_3,__37#matrix_to_atom_3_1,__37#matrix_to_atom_3_2,__37#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-(1);int(1..)]);int(1..)]),3;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__37#matrix_to_atom_1_1,__37#matrix_to_atom_1_2,__37#matrix_to_atom_1_3,__37#matrix_to_atom_2_1,__37#matrix_to_atom_2_2,__37#matrix_to_atom_2_3,__37#matrix_to_atom_3_1,__37#matrix_to_atom_3_2,__37#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),3;int(1..)])])

--

[__37#matrix_to_atom_1_1,__37#matrix_to_atom_1_2,__37#matrix_to_atom_1_3,__37#matrix_to_atom_2_1,__37#matrix_to_atom_2_2,__37#matrix_to_atom_2_3,__37#matrix_to_atom_3_1,__37#matrix_to_atom_3_2,__37#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),3;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__37#matrix_to_atom_1_1,__37#matrix_to_atom_1_2,__37#matrix_to_atom_1_3,__37#matrix_to_atom_2_1,__37#matrix_to_atom_2_2,__37#matrix_to_atom_2_3,__37#matrix_to_atom_3_1,__37#matrix_to_atom_3_2,__37#matrix_to_atom_3_3;int(1..)][__38]
new variables:
  find __38: int(3..9)
new constraints:
  __38 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),3;int(1..)])

--

__38 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),3;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[3, __39],__38),FlatWeightedSumGeq([1, 3],[3, __39],__38);int(1..)])
new variables:
  find __39: int(0..2)
new constraints:
  __39 =aux sum([r,-1;int(1..)])

--

(0 != [__37#matrix_to_atom_1_1,__37#matrix_to_atom_1_2,__37#matrix_to_atom_1_3,__37#matrix_to_atom_2_1,__37#matrix_to_atom_2_2,__37#matrix_to_atom_2_3,__37#matrix_to_atom_3_1,__37#matrix_to_atom_3_2,__37#matrix_to_atom_3_3;int(1..)][__38]),
and([FlatWeightedSumLeq([1, 3],[3, __39],__38),FlatWeightedSumGeq([1, 3],[3, __39],__38);int(1..)]),
__39 =aux sum([r,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__37#matrix_to_atom_1_1,__37#matrix_to_atom_1_2,__37#matrix_to_atom_1_3,__37#matrix_to_atom_2_1,__37#matrix_to_atom_2_2,__37#matrix_to_atom_2_3,__37#matrix_to_atom_3_1,__37#matrix_to_atom_3_2,__37#matrix_to_atom_3_3;int(1..)][__38]),
FlatWeightedSumLeq([1, 3],[3, __39],__38),
FlatWeightedSumGeq([1, 3],[3, __39],__38),
__39 =aux sum([r,-1;int(1..)])

--

__39 =aux sum([r,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, r], __39),SumGeq([-1, r], __39);int(1..)])

--

(0 != [__37#matrix_to_atom_1_1,__37#matrix_to_atom_1_2,__37#matrix_to_atom_1_3,__37#matrix_to_atom_2_1,__37#matrix_to_atom_2_2,__37#matrix_to_atom_2_3,__37#matrix_to_atom_3_1,__37#matrix_to_atom_3_2,__37#matrix_to_atom_3_3;int(1..)][__38]),
FlatWeightedSumLeq([1, 3],[3, __39],__38),
FlatWeightedSumGeq([1, 3],[3, __39],__38),
and([SumLeq([-1, r], __39),SumGeq([-1, r], __39);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__37#matrix_to_atom_1_1,__37#matrix_to_atom_1_2,__37#matrix_to_atom_1_3,__37#matrix_to_atom_2_1,__37#matrix_to_atom_2_2,__37#matrix_to_atom_2_3,__37#matrix_to_atom_3_1,__37#matrix_to_atom_3_2,__37#matrix_to_atom_3_3;int(1..)][__38]),
FlatWeightedSumLeq([1, 3],[3, __39],__38),
FlatWeightedSumGeq([1, 3],[3, __39],__38),
SumLeq([-1, r], __39),
SumGeq([-1, r], __39)

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __34: matrix indexed by [Index, Index] of Value
find __35: int(2..8)
find __36: int(0..2)
find __37: matrix indexed by [Index, Index] of Value
find __38: int(3..9)
find __39: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)
find __34#matrix_to_atom_1_1: int(1..9)
find __34#matrix_to_atom_1_2: int(1..9)
find __34#matrix_to_atom_1_3: int(1..9)
find __34#matrix_to_atom_2_1: int(1..9)
find __34#matrix_to_atom_2_2: int(1..9)
find __34#matrix_to_atom_2_3: int(1..9)
find __34#matrix_to_atom_3_1: int(1..9)
find __34#matrix_to_atom_3_2: int(1..9)
find __34#matrix_to_atom_3_3: int(1..9)
find __37#matrix_to_atom_1_1: int(1..9)
find __37#matrix_to_atom_1_2: int(1..9)
find __37#matrix_to_atom_1_3: int(1..9)
find __37#matrix_to_atom_2_1: int(1..9)
find __37#matrix_to_atom_2_2: int(1..9)
find __37#matrix_to_atom_2_3: int(1..9)
find __37#matrix_to_atom_3_1: int(1..9)
find __37#matrix_to_atom_3_2: int(1..9)
find __37#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__37#matrix_to_atom_1_1,__37#matrix_to_atom_1_2,__37#matrix_to_atom_1_3,__37#matrix_to_atom_2_1,__37#matrix_to_atom_2_2,__37#matrix_to_atom_2_3,__37#matrix_to_atom_3_1,__37#matrix_to_atom_3_2,__37#matrix_to_atom_3_3;int(1..)][__38]),
FlatWeightedSumLeq([1, 3],[3, __39],__38),
FlatWeightedSumGeq([1, 3],[3, __39],__38),
SumLeq([-1, r], __39),
SumGeq([-1, r], __39)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(1..9)
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: int(1..9)
find __17: int(0..2)
find __18: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)

such that

(0 != __18[d, d])

--

(0 != __18#matrix_to_atom[d, d]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __18#matrix_to_atom[d, d])
new variables:
  find __18#matrix_to_atom_1_1: int(1..9)
  find __18#matrix_to_atom_1_2: int(1..9)
  find __18#matrix_to_atom_1_3: int(1..9)
  find __18#matrix_to_atom_2_1: int(1..9)
  find __18#matrix_to_atom_2_2: int(1..9)
  find __18#matrix_to_atom_2_3: int(1..9)
  find __18#matrix_to_atom_3_1: int(1..9)
  find __18#matrix_to_atom_3_2: int(1..9)
  find __18#matrix_to_atom_3_3: int(1..9)

--

__18#matrix_to_atom[d, d], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__18#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}

--

(0 != {__18#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __18#matrix_to_atom[d, d])

--

(0 != __18#matrix_to_atom[d, d]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(d - 1);int(1..)]),1;int(1..)])])

--

product([1,(d - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(d - 1);int(1..)])

--

product([(d - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(d - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(d - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(d - 1),1;int(1..)])])

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])

--

(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])])

--

[__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][__19]
new variables:
  find __19: int(1..9)
new constraints:
  __19 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])

--

__19 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__20, d],__19),FlatWeightedSumGeq([3, 1],[__20, d],__19);int(1..)])
new variables:
  find __20: int(0..2)
new constraints:
  __20 =aux sum([d,-1;int(1..)])

--

(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][__19]),
and([FlatWeightedSumLeq([3, 1],[__20, d],__19),FlatWeightedSumGeq([3, 1],[__20, d],__19);int(1..)]),
__20 =aux sum([d,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][__19]),
FlatWeightedSumLeq([3, 1],[__20, d],__19),
FlatWeightedSumGeq([3, 1],[__20, d],__19),
__20 =aux sum([d,-1;int(1..)])

--

__20 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __20),SumGeq([-1, d], __20);int(1..)])

--

(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][__19]),
FlatWeightedSumLeq([3, 1],[__20, d],__19),
FlatWeightedSumGeq([3, 1],[__20, d],__19),
and([SumLeq([-1, d], __20),SumGeq([-1, d], __20);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][__19]),
FlatWeightedSumLeq([3, 1],[__20, d],__19),
FlatWeightedSumGeq([3, 1],[__20, d],__19),
SumLeq([-1, d], __20),
SumGeq([-1, d], __20)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(1..9)
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: int(1..9)
find __17: int(0..2)
find __18: matrix indexed by [Index, Index] of Value
find __19: int(1..9)
find __20: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __18#matrix_to_atom_1_1: int(1..9)
find __18#matrix_to_atom_1_2: int(1..9)
find __18#matrix_to_atom_1_3: int(1..9)
find __18#matrix_to_atom_2_1: int(1..9)
find __18#matrix_to_atom_2_2: int(1..9)
find __18#matrix_to_atom_2_3: int(1..9)
find __18#matrix_to_atom_3_1: int(1..9)
find __18#matrix_to_atom_3_2: int(1..9)
find __18#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][__19]),
FlatWeightedSumLeq([3, 1],[__20, d],__19),
FlatWeightedSumGeq([3, 1],[__20, d],__19),
SumLeq([-1, d], __20),
SumGeq([-1, d], __20)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __8#matrix_to_atom_1_1: int(1..9)
find __8#matrix_to_atom_1_2: int(1..9)
find __8#matrix_to_atom_1_3: int(1..9)
find __8#matrix_to_atom_2_1: int(1..9)
find __8#matrix_to_atom_2_2: int(1..9)
find __8#matrix_to_atom_2_3: int(1..9)
find __8#matrix_to_atom_3_1: int(1..9)
find __8#matrix_to_atom_3_2: int(1..9)
find __8#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)

such that

(0 != __12[d, (4 - d)])

--

(4 - d), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([4,-(d);int(1..)])

--

(0 != __12#matrix_to_atom[d, sum([4,-(d);int(1..)])]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __12#matrix_to_atom[d, sum([4,-(d);int(1..)])])
new variables:
  find __12#matrix_to_atom_1_1: int(1..9)
  find __12#matrix_to_atom_1_2: int(1..9)
  find __12#matrix_to_atom_1_3: int(1..9)
  find __12#matrix_to_atom_2_1: int(1..9)
  find __12#matrix_to_atom_2_2: int(1..9)
  find __12#matrix_to_atom_2_3: int(1..9)
  find __12#matrix_to_atom_3_1: int(1..9)
  find __12#matrix_to_atom_3_2: int(1..9)
  find __12#matrix_to_atom_3_3: int(1..9)

--

__12#matrix_to_atom[d, sum([4,-(d);int(1..)])], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__12#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

(0 != {__12#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != {__12#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])})

--

(0 != {__12#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> bubble_up ([("Bubble", 8800)])
{(0 != __12#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

{(0 != __12#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}, 
   ~~> expand_bubble ([("Bubble", 8900)])
and([(0 != __12#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)])

--

and([(0 != __12#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __12#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])

--

(0 != __12#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __12#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(0 != __12#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(sum([4,-(d);int(1..)]) - 1);int(1..)])

--

product([(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(sum([4,-(d);int(1..)]) - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(sum([4,-(d);int(1..)]) - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([sum([4,-(d);int(1..)]),-(1);int(1..)])

--

(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-(1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])

--

(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([3,sum([d,-1;int(1..)]);int(1..)]), 
   ~~> flatten_product ([("Minion", 4200)])
product([3,__13;int(1..)])
new variables:
  find __13: int(0..2)
new constraints:
  __13 =aux sum([d,-1;int(1..)])

--

__13 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __13),SumGeq([-1, d], __13);int(1..)])

--

(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,__13;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
and([SumLeq([-1, d], __13),SumGeq([-1, d], __13);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,__13;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __13),
SumGeq([-1, d], __13)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __8#matrix_to_atom_1_1: int(1..9)
find __8#matrix_to_atom_1_2: int(1..9)
find __8#matrix_to_atom_1_3: int(1..9)
find __8#matrix_to_atom_2_1: int(1..9)
find __8#matrix_to_atom_2_2: int(1..9)
find __8#matrix_to_atom_2_3: int(1..9)
find __8#matrix_to_atom_3_1: int(1..9)
find __8#matrix_to_atom_3_2: int(1..9)
find __8#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__12#matrix_to_atom_1_1,__12#matrix_to_atom_1_2,__12#matrix_to_atom_1_3,__12#matrix_to_atom_2_1,__12#matrix_to_atom_2_2,__12#matrix_to_atom_2_3,__12#matrix_to_atom_3_1,__12#matrix_to_atom_3_2,__12#matrix_to_atom_3_3;int(1..)][sum([product([3,__13;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __13),
SumGeq([-1, d], __13)

Via-solver generator model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __34: matrix indexed by [Index, Index] of Value
find __35: int(2..8)
find __36: int(0..2)
find __37: matrix indexed by [Index, Index] of Value
find __38: int(3..9)
find __39: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)
find __34#matrix_to_atom_1_1: int(1..9)
find __34#matrix_to_atom_1_2: int(1..9)
find __34#matrix_to_atom_1_3: int(1..9)
find __34#matrix_to_atom_2_1: int(1..9)
find __34#matrix_to_atom_2_2: int(1..9)
find __34#matrix_to_atom_2_3: int(1..9)
find __34#matrix_to_atom_3_1: int(1..9)
find __34#matrix_to_atom_3_2: int(1..9)
find __34#matrix_to_atom_3_3: int(1..9)
find __37#matrix_to_atom_1_1: int(1..9)
find __37#matrix_to_atom_1_2: int(1..9)
find __37#matrix_to_atom_1_3: int(1..9)
find __37#matrix_to_atom_2_1: int(1..9)
find __37#matrix_to_atom_2_2: int(1..9)
find __37#matrix_to_atom_2_3: int(1..9)
find __37#matrix_to_atom_3_1: int(1..9)
find __37#matrix_to_atom_3_2: int(1..9)
find __37#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __34: matrix indexed by [Index, Index] of Value
find __35: int(2..8)
find __36: int(0..2)
find __37: matrix indexed by [Index, Index] of Value
find __38: int(3..9)
find __39: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)
find __34#matrix_to_atom_1_1: int(1..9)
find __34#matrix_to_atom_1_2: int(1..9)
find __34#matrix_to_atom_1_3: int(1..9)
find __34#matrix_to_atom_2_1: int(1..9)
find __34#matrix_to_atom_2_2: int(1..9)
find __34#matrix_to_atom_2_3: int(1..9)
find __34#matrix_to_atom_3_1: int(1..9)
find __34#matrix_to_atom_3_2: int(1..9)
find __34#matrix_to_atom_3_3: int(1..9)
find __37#matrix_to_atom_1_1: int(1..9)
find __37#matrix_to_atom_1_2: int(1..9)
find __37#matrix_to_atom_1_3: int(1..9)
find __37#matrix_to_atom_2_1: int(1..9)
find __37#matrix_to_atom_2_2: int(1..9)
find __37#matrix_to_atom_2_3: int(1..9)
find __37#matrix_to_atom_3_1: int(1..9)
find __37#matrix_to_atom_3_2: int(1..9)
find __37#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __34: matrix indexed by [Index, Index] of Value
find __35: int(2..8)
find __36: int(0..2)
find __37: matrix indexed by [Index, Index] of Value
find __38: int(3..9)
find __39: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)
find __34#matrix_to_atom_1_1: int(1..9)
find __34#matrix_to_atom_1_2: int(1..9)
find __34#matrix_to_atom_1_3: int(1..9)
find __34#matrix_to_atom_2_1: int(1..9)
find __34#matrix_to_atom_2_2: int(1..9)
find __34#matrix_to_atom_2_3: int(1..9)
find __34#matrix_to_atom_3_1: int(1..9)
find __34#matrix_to_atom_3_2: int(1..9)
find __34#matrix_to_atom_3_3: int(1..9)
find __37#matrix_to_atom_1_1: int(1..9)
find __37#matrix_to_atom_1_2: int(1..9)
find __37#matrix_to_atom_1_3: int(1..9)
find __37#matrix_to_atom_2_1: int(1..9)
find __37#matrix_to_atom_2_2: int(1..9)
find __37#matrix_to_atom_2_3: int(1..9)
find __37#matrix_to_atom_3_1: int(1..9)
find __37#matrix_to_atom_3_2: int(1..9)
find __37#matrix_to_atom_3_3: int(1..9)

such that

true

[ square[r, 2] | r : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[square[1, 2],square[2, 2],square[3, 2];int(1..)]

--

square[1, 2], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[1, 2] @ and([__inDomain(1,int(1..3)),__inDomain(2,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([{square[1, 2] @ and([__inDomain(1,int(1..3)),__inDomain(2,int(1..3));int(1..)])},square[2, 2],square[3, 2];int(1..)]) = s),
(sum([ square[r, 3] | r : Index ]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([ square[r, 3] | r : Index ]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

square[2, 2], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[2, 2] @ and([__inDomain(2,int(1..3)),__inDomain(2,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],{square[2, 2] @ and([__inDomain(2,int(1..3)),__inDomain(2,int(1..3));int(1..)])},square[3, 2];int(1..)]) = s),
(sum([ square[r, 3] | r : Index ]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([ square[r, 3] | r : Index ]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

square[3, 2], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[3, 2] @ and([__inDomain(3,int(1..3)),__inDomain(2,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],{square[3, 2] @ and([__inDomain(3,int(1..3)),__inDomain(2,int(1..3));int(1..)])};int(1..)]) = s),
(sum([ square[r, 3] | r : Index ]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([ square[r, 3] | r : Index ]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __34: matrix indexed by [Index, Index] of Value
find __35: int(2..8)
find __36: int(0..2)
find __37: matrix indexed by [Index, Index] of Value
find __38: int(3..9)
find __39: int(0..2)
find __40: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)
find __34#matrix_to_atom_1_1: int(1..9)
find __34#matrix_to_atom_1_2: int(1..9)
find __34#matrix_to_atom_1_3: int(1..9)
find __34#matrix_to_atom_2_1: int(1..9)
find __34#matrix_to_atom_2_2: int(1..9)
find __34#matrix_to_atom_2_3: int(1..9)
find __34#matrix_to_atom_3_1: int(1..9)
find __34#matrix_to_atom_3_2: int(1..9)
find __34#matrix_to_atom_3_3: int(1..9)
find __37#matrix_to_atom_1_1: int(1..9)
find __37#matrix_to_atom_1_2: int(1..9)
find __37#matrix_to_atom_1_3: int(1..9)
find __37#matrix_to_atom_2_1: int(1..9)
find __37#matrix_to_atom_2_2: int(1..9)
find __37#matrix_to_atom_2_3: int(1..9)
find __37#matrix_to_atom_3_1: int(1..9)
find __37#matrix_to_atom_3_2: int(1..9)
find __37#matrix_to_atom_3_3: int(1..9)

such that

(0 != __40[r, 3])

--

(0 != __40#matrix_to_atom[r, 3]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __40#matrix_to_atom[r, 3])
new variables:
  find __40#matrix_to_atom_1_1: int(1..9)
  find __40#matrix_to_atom_1_2: int(1..9)
  find __40#matrix_to_atom_1_3: int(1..9)
  find __40#matrix_to_atom_2_1: int(1..9)
  find __40#matrix_to_atom_2_2: int(1..9)
  find __40#matrix_to_atom_2_3: int(1..9)
  find __40#matrix_to_atom_3_1: int(1..9)
  find __40#matrix_to_atom_3_2: int(1..9)
  find __40#matrix_to_atom_3_3: int(1..9)

--

__40#matrix_to_atom[r, 3], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__40#matrix_to_atom[r, 3] @ and([__inDomain(r,int(1..3)),__inDomain(3,int(1..3));int(1..)])}

--

(0 != {__40#matrix_to_atom[r, 3] @ and([__inDomain(r,int(1..3)),__inDomain(3,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __40#matrix_to_atom[r, 3])

--

(0 != __40#matrix_to_atom[r, 3]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(3 - 1);int(1..)]),1;int(1..)])])

--

(0 != [__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),product([1,(3 - 1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,(r - 1);int(1..)]),3;int(1..)])])

--

(r - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([r,-(1);int(1..)])

--

(0 != [__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-(1);int(1..)]);int(1..)]),3;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),3;int(1..)])])

--

[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([r,-1;int(1..)]);int(1..)]),3;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__41]
new variables:
  find __41: int(3..9)
new constraints:
  __41 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),3;int(1..)])

--

__41 =aux sum([product([3,sum([r,-1;int(1..)]);int(1..)]),3;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([1, 3],[3, __42],__41),FlatWeightedSumGeq([1, 3],[3, __42],__41);int(1..)])
new variables:
  find __42: int(0..2)
new constraints:
  __42 =aux sum([r,-1;int(1..)])

--

(0 != [__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__41]),
and([FlatWeightedSumLeq([1, 3],[3, __42],__41),FlatWeightedSumGeq([1, 3],[3, __42],__41);int(1..)]),
__42 =aux sum([r,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__41]),
FlatWeightedSumLeq([1, 3],[3, __42],__41),
FlatWeightedSumGeq([1, 3],[3, __42],__41),
__42 =aux sum([r,-1;int(1..)])

--

__42 =aux sum([r,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, r], __42),SumGeq([-1, r], __42);int(1..)])

--

(0 != [__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__41]),
FlatWeightedSumLeq([1, 3],[3, __42],__41),
FlatWeightedSumGeq([1, 3],[3, __42],__41),
and([SumLeq([-1, r], __42),SumGeq([-1, r], __42);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__41]),
FlatWeightedSumLeq([1, 3],[3, __42],__41),
FlatWeightedSumGeq([1, 3],[3, __42],__41),
SumLeq([-1, r], __42),
SumGeq([-1, r], __42)

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __34: matrix indexed by [Index, Index] of Value
find __35: int(2..8)
find __36: int(0..2)
find __37: matrix indexed by [Index, Index] of Value
find __38: int(3..9)
find __39: int(0..2)
find __40: matrix indexed by [Index, Index] of Value
find __41: int(3..9)
find __42: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)
find __34#matrix_to_atom_1_1: int(1..9)
find __34#matrix_to_atom_1_2: int(1..9)
find __34#matrix_to_atom_1_3: int(1..9)
find __34#matrix_to_atom_2_1: int(1..9)
find __34#matrix_to_atom_2_2: int(1..9)
find __34#matrix_to_atom_2_3: int(1..9)
find __34#matrix_to_atom_3_1: int(1..9)
find __34#matrix_to_atom_3_2: int(1..9)
find __34#matrix_to_atom_3_3: int(1..9)
find __37#matrix_to_atom_1_1: int(1..9)
find __37#matrix_to_atom_1_2: int(1..9)
find __37#matrix_to_atom_1_3: int(1..9)
find __37#matrix_to_atom_2_1: int(1..9)
find __37#matrix_to_atom_2_2: int(1..9)
find __37#matrix_to_atom_2_3: int(1..9)
find __37#matrix_to_atom_3_1: int(1..9)
find __37#matrix_to_atom_3_2: int(1..9)
find __37#matrix_to_atom_3_3: int(1..9)
find __40#matrix_to_atom_1_1: int(1..9)
find __40#matrix_to_atom_1_2: int(1..9)
find __40#matrix_to_atom_1_3: int(1..9)
find __40#matrix_to_atom_2_1: int(1..9)
find __40#matrix_to_atom_2_2: int(1..9)
find __40#matrix_to_atom_2_3: int(1..9)
find __40#matrix_to_atom_3_1: int(1..9)
find __40#matrix_to_atom_3_2: int(1..9)
find __40#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__40#matrix_to_atom_1_1,__40#matrix_to_atom_1_2,__40#matrix_to_atom_1_3,__40#matrix_to_atom_2_1,__40#matrix_to_atom_2_2,__40#matrix_to_atom_2_3,__40#matrix_to_atom_3_1,__40#matrix_to_atom_3_2,__40#matrix_to_atom_3_3;int(1..)][__41]),
FlatWeightedSumLeq([1, 3],[3, __42],__41),
FlatWeightedSumGeq([1, 3],[3, __42],__41),
SumLeq([-1, r], __42),
SumGeq([-1, r], __42)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(1..9)
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: int(1..9)
find __17: int(0..2)
find __18: matrix indexed by [Index, Index] of Value
find __19: int(1..9)
find __20: int(0..2)
find __21: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __18#matrix_to_atom_1_1: int(1..9)
find __18#matrix_to_atom_1_2: int(1..9)
find __18#matrix_to_atom_1_3: int(1..9)
find __18#matrix_to_atom_2_1: int(1..9)
find __18#matrix_to_atom_2_2: int(1..9)
find __18#matrix_to_atom_2_3: int(1..9)
find __18#matrix_to_atom_3_1: int(1..9)
find __18#matrix_to_atom_3_2: int(1..9)
find __18#matrix_to_atom_3_3: int(1..9)

such that

(0 != __21[d, d])

--

(0 != __21#matrix_to_atom[d, d]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __21#matrix_to_atom[d, d])
new variables:
  find __21#matrix_to_atom_1_1: int(1..9)
  find __21#matrix_to_atom_1_2: int(1..9)
  find __21#matrix_to_atom_1_3: int(1..9)
  find __21#matrix_to_atom_2_1: int(1..9)
  find __21#matrix_to_atom_2_2: int(1..9)
  find __21#matrix_to_atom_2_3: int(1..9)
  find __21#matrix_to_atom_3_1: int(1..9)
  find __21#matrix_to_atom_3_2: int(1..9)
  find __21#matrix_to_atom_3_3: int(1..9)

--

__21#matrix_to_atom[d, d], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__21#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}

--

(0 != {__21#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __21#matrix_to_atom[d, d])

--

(0 != __21#matrix_to_atom[d, d]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__21#matrix_to_atom_1_1,__21#matrix_to_atom_1_2,__21#matrix_to_atom_1_3,__21#matrix_to_atom_2_1,__21#matrix_to_atom_2_2,__21#matrix_to_atom_2_3,__21#matrix_to_atom_3_1,__21#matrix_to_atom_3_2,__21#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(d - 1);int(1..)]),1;int(1..)])])

--

product([1,(d - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(d - 1);int(1..)])

--

product([(d - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(d - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__21#matrix_to_atom_1_1,__21#matrix_to_atom_1_2,__21#matrix_to_atom_1_3,__21#matrix_to_atom_2_1,__21#matrix_to_atom_2_2,__21#matrix_to_atom_2_3,__21#matrix_to_atom_3_1,__21#matrix_to_atom_3_2,__21#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(d - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__21#matrix_to_atom_1_1,__21#matrix_to_atom_1_2,__21#matrix_to_atom_1_3,__21#matrix_to_atom_2_1,__21#matrix_to_atom_2_2,__21#matrix_to_atom_2_3,__21#matrix_to_atom_3_1,__21#matrix_to_atom_3_2,__21#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(d - 1),1;int(1..)])])

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__21#matrix_to_atom_1_1,__21#matrix_to_atom_1_2,__21#matrix_to_atom_1_3,__21#matrix_to_atom_2_1,__21#matrix_to_atom_2_2,__21#matrix_to_atom_2_3,__21#matrix_to_atom_3_1,__21#matrix_to_atom_3_2,__21#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__21#matrix_to_atom_1_1,__21#matrix_to_atom_1_2,__21#matrix_to_atom_1_3,__21#matrix_to_atom_2_1,__21#matrix_to_atom_2_2,__21#matrix_to_atom_2_3,__21#matrix_to_atom_3_1,__21#matrix_to_atom_3_2,__21#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])

--

(0 != [__21#matrix_to_atom_1_1,__21#matrix_to_atom_1_2,__21#matrix_to_atom_1_3,__21#matrix_to_atom_2_1,__21#matrix_to_atom_2_2,__21#matrix_to_atom_2_3,__21#matrix_to_atom_3_1,__21#matrix_to_atom_3_2,__21#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__21#matrix_to_atom_1_1,__21#matrix_to_atom_1_2,__21#matrix_to_atom_1_3,__21#matrix_to_atom_2_1,__21#matrix_to_atom_2_2,__21#matrix_to_atom_2_3,__21#matrix_to_atom_3_1,__21#matrix_to_atom_3_2,__21#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])])

--

[__21#matrix_to_atom_1_1,__21#matrix_to_atom_1_2,__21#matrix_to_atom_1_3,__21#matrix_to_atom_2_1,__21#matrix_to_atom_2_2,__21#matrix_to_atom_2_3,__21#matrix_to_atom_3_1,__21#matrix_to_atom_3_2,__21#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__21#matrix_to_atom_1_1,__21#matrix_to_atom_1_2,__21#matrix_to_atom_1_3,__21#matrix_to_atom_2_1,__21#matrix_to_atom_2_2,__21#matrix_to_atom_2_3,__21#matrix_to_atom_3_1,__21#matrix_to_atom_3_2,__21#matrix_to_atom_3_3;int(1..)][__22]
new variables:
  find __22: int(1..9)
new constraints:
  __22 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])

--

__22 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__23, d],__22),FlatWeightedSumGeq([3, 1],[__23, d],__22);int(1..)])
new variables:
  find __23: int(0..2)
new constraints:
  __23 =aux sum([d,-1;int(1..)])

--

(0 != [__21#matrix_to_atom_1_1,__21#matrix_to_atom_1_2,__21#matrix_to_atom_1_3,__21#matrix_to_atom_2_1,__21#matrix_to_atom_2_2,__21#matrix_to_atom_2_3,__21#matrix_to_atom_3_1,__21#matrix_to_atom_3_2,__21#matrix_to_atom_3_3;int(1..)][__22]),
and([FlatWeightedSumLeq([3, 1],[__23, d],__22),FlatWeightedSumGeq([3, 1],[__23, d],__22);int(1..)]),
__23 =aux sum([d,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__21#matrix_to_atom_1_1,__21#matrix_to_atom_1_2,__21#matrix_to_atom_1_3,__21#matrix_to_atom_2_1,__21#matrix_to_atom_2_2,__21#matrix_to_atom_2_3,__21#matrix_to_atom_3_1,__21#matrix_to_atom_3_2,__21#matrix_to_atom_3_3;int(1..)][__22]),
FlatWeightedSumLeq([3, 1],[__23, d],__22),
FlatWeightedSumGeq([3, 1],[__23, d],__22),
__23 =aux sum([d,-1;int(1..)])

--

__23 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __23),SumGeq([-1, d], __23);int(1..)])

--

(0 != [__21#matrix_to_atom_1_1,__21#matrix_to_atom_1_2,__21#matrix_to_atom_1_3,__21#matrix_to_atom_2_1,__21#matrix_to_atom_2_2,__21#matrix_to_atom_2_3,__21#matrix_to_atom_3_1,__21#matrix_to_atom_3_2,__21#matrix_to_atom_3_3;int(1..)][__22]),
FlatWeightedSumLeq([3, 1],[__23, d],__22),
FlatWeightedSumGeq([3, 1],[__23, d],__22),
and([SumLeq([-1, d], __23),SumGeq([-1, d], __23);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__21#matrix_to_atom_1_1,__21#matrix_to_atom_1_2,__21#matrix_to_atom_1_3,__21#matrix_to_atom_2_1,__21#matrix_to_atom_2_2,__21#matrix_to_atom_2_3,__21#matrix_to_atom_3_1,__21#matrix_to_atom_3_2,__21#matrix_to_atom_3_3;int(1..)][__22]),
FlatWeightedSumLeq([3, 1],[__23, d],__22),
FlatWeightedSumGeq([3, 1],[__23, d],__22),
SumLeq([-1, d], __23),
SumGeq([-1, d], __23)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(1..9)
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: int(1..9)
find __17: int(0..2)
find __18: matrix indexed by [Index, Index] of Value
find __19: int(1..9)
find __20: int(0..2)
find __21: matrix indexed by [Index, Index] of Value
find __22: int(1..9)
find __23: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __18#matrix_to_atom_1_1: int(1..9)
find __18#matrix_to_atom_1_2: int(1..9)
find __18#matrix_to_atom_1_3: int(1..9)
find __18#matrix_to_atom_2_1: int(1..9)
find __18#matrix_to_atom_2_2: int(1..9)
find __18#matrix_to_atom_2_3: int(1..9)
find __18#matrix_to_atom_3_1: int(1..9)
find __18#matrix_to_atom_3_2: int(1..9)
find __18#matrix_to_atom_3_3: int(1..9)
find __21#matrix_to_atom_1_1: int(1..9)
find __21#matrix_to_atom_1_2: int(1..9)
find __21#matrix_to_atom_1_3: int(1..9)
find __21#matrix_to_atom_2_1: int(1..9)
find __21#matrix_to_atom_2_2: int(1..9)
find __21#matrix_to_atom_2_3: int(1..9)
find __21#matrix_to_atom_3_1: int(1..9)
find __21#matrix_to_atom_3_2: int(1..9)
find __21#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__21#matrix_to_atom_1_1,__21#matrix_to_atom_1_2,__21#matrix_to_atom_1_3,__21#matrix_to_atom_2_1,__21#matrix_to_atom_2_2,__21#matrix_to_atom_2_3,__21#matrix_to_atom_3_1,__21#matrix_to_atom_3_2,__21#matrix_to_atom_3_3;int(1..)][__22]),
FlatWeightedSumLeq([3, 1],[__23, d],__22),
FlatWeightedSumGeq([3, 1],[__23, d],__22),
SumLeq([-1, d], __23),
SumGeq([-1, d], __23)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(0..2)
find __14: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __8#matrix_to_atom_1_1: int(1..9)
find __8#matrix_to_atom_1_2: int(1..9)
find __8#matrix_to_atom_1_3: int(1..9)
find __8#matrix_to_atom_2_1: int(1..9)
find __8#matrix_to_atom_2_2: int(1..9)
find __8#matrix_to_atom_2_3: int(1..9)
find __8#matrix_to_atom_3_1: int(1..9)
find __8#matrix_to_atom_3_2: int(1..9)
find __8#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)

such that

(0 != __14[d, (4 - d)])

--

(4 - d), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([4,-(d);int(1..)])

--

(0 != __14#matrix_to_atom[d, sum([4,-(d);int(1..)])]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __14#matrix_to_atom[d, sum([4,-(d);int(1..)])])
new variables:
  find __14#matrix_to_atom_1_1: int(1..9)
  find __14#matrix_to_atom_1_2: int(1..9)
  find __14#matrix_to_atom_1_3: int(1..9)
  find __14#matrix_to_atom_2_1: int(1..9)
  find __14#matrix_to_atom_2_2: int(1..9)
  find __14#matrix_to_atom_2_3: int(1..9)
  find __14#matrix_to_atom_3_1: int(1..9)
  find __14#matrix_to_atom_3_2: int(1..9)
  find __14#matrix_to_atom_3_3: int(1..9)

--

__14#matrix_to_atom[d, sum([4,-(d);int(1..)])], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__14#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

(0 != {__14#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != {__14#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])})

--

(0 != {__14#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> bubble_up ([("Bubble", 8800)])
{(0 != __14#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

{(0 != __14#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}, 
   ~~> expand_bubble ([("Bubble", 8900)])
and([(0 != __14#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)])

--

and([(0 != __14#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __14#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])

--

(0 != __14#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __14#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(0 != __14#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__14#matrix_to_atom_1_1,__14#matrix_to_atom_1_2,__14#matrix_to_atom_1_3,__14#matrix_to_atom_2_1,__14#matrix_to_atom_2_2,__14#matrix_to_atom_2_3,__14#matrix_to_atom_3_1,__14#matrix_to_atom_3_2,__14#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(sum([4,-(d);int(1..)]) - 1);int(1..)])

--

product([(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(sum([4,-(d);int(1..)]) - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__14#matrix_to_atom_1_1,__14#matrix_to_atom_1_2,__14#matrix_to_atom_1_3,__14#matrix_to_atom_2_1,__14#matrix_to_atom_2_2,__14#matrix_to_atom_2_3,__14#matrix_to_atom_3_1,__14#matrix_to_atom_3_2,__14#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__14#matrix_to_atom_1_1,__14#matrix_to_atom_1_2,__14#matrix_to_atom_1_3,__14#matrix_to_atom_2_1,__14#matrix_to_atom_2_2,__14#matrix_to_atom_2_3,__14#matrix_to_atom_3_1,__14#matrix_to_atom_3_2,__14#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(sum([4,-(d);int(1..)]) - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([sum([4,-(d);int(1..)]),-(1);int(1..)])

--

(0 != [__14#matrix_to_atom_1_1,__14#matrix_to_atom_1_2,__14#matrix_to_atom_1_3,__14#matrix_to_atom_2_1,__14#matrix_to_atom_2_2,__14#matrix_to_atom_2_3,__14#matrix_to_atom_3_1,__14#matrix_to_atom_3_2,__14#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-(1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__14#matrix_to_atom_1_1,__14#matrix_to_atom_1_2,__14#matrix_to_atom_1_3,__14#matrix_to_atom_2_1,__14#matrix_to_atom_2_2,__14#matrix_to_atom_2_3,__14#matrix_to_atom_3_1,__14#matrix_to_atom_3_2,__14#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])

--

(0 != [__14#matrix_to_atom_1_1,__14#matrix_to_atom_1_2,__14#matrix_to_atom_1_3,__14#matrix_to_atom_2_1,__14#matrix_to_atom_2_2,__14#matrix_to_atom_2_3,__14#matrix_to_atom_3_1,__14#matrix_to_atom_3_2,__14#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__14#matrix_to_atom_1_1,__14#matrix_to_atom_1_2,__14#matrix_to_atom_1_3,__14#matrix_to_atom_2_1,__14#matrix_to_atom_2_2,__14#matrix_to_atom_2_3,__14#matrix_to_atom_3_1,__14#matrix_to_atom_3_2,__14#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([3,sum([d,-1;int(1..)]);int(1..)]), 
   ~~> flatten_product ([("Minion", 4200)])
product([3,__15;int(1..)])
new variables:
  find __15: int(0..2)
new constraints:
  __15 =aux sum([d,-1;int(1..)])

--

__15 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __15),SumGeq([-1, d], __15);int(1..)])

--

(0 != [__14#matrix_to_atom_1_1,__14#matrix_to_atom_1_2,__14#matrix_to_atom_1_3,__14#matrix_to_atom_2_1,__14#matrix_to_atom_2_2,__14#matrix_to_atom_2_3,__14#matrix_to_atom_3_1,__14#matrix_to_atom_3_2,__14#matrix_to_atom_3_3;int(1..)][sum([product([3,__15;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
and([SumLeq([-1, d], __15),SumGeq([-1, d], __15);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__14#matrix_to_atom_1_1,__14#matrix_to_atom_1_2,__14#matrix_to_atom_1_3,__14#matrix_to_atom_2_1,__14#matrix_to_atom_2_2,__14#matrix_to_atom_2_3,__14#matrix_to_atom_3_1,__14#matrix_to_atom_3_2,__14#matrix_to_atom_3_3;int(1..)][sum([product([3,__15;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __15),
SumGeq([-1, d], __15)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(0..2)
find __14: matrix indexed by [Index, Index] of Value
find __15: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __8#matrix_to_atom_1_1: int(1..9)
find __8#matrix_to_atom_1_2: int(1..9)
find __8#matrix_to_atom_1_3: int(1..9)
find __8#matrix_to_atom_2_1: int(1..9)
find __8#matrix_to_atom_2_2: int(1..9)
find __8#matrix_to_atom_2_3: int(1..9)
find __8#matrix_to_atom_3_1: int(1..9)
find __8#matrix_to_atom_3_2: int(1..9)
find __8#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __14#matrix_to_atom_1_1: int(1..9)
find __14#matrix_to_atom_1_2: int(1..9)
find __14#matrix_to_atom_1_3: int(1..9)
find __14#matrix_to_atom_2_1: int(1..9)
find __14#matrix_to_atom_2_2: int(1..9)
find __14#matrix_to_atom_2_3: int(1..9)
find __14#matrix_to_atom_3_1: int(1..9)
find __14#matrix_to_atom_3_2: int(1..9)
find __14#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__14#matrix_to_atom_1_1,__14#matrix_to_atom_1_2,__14#matrix_to_atom_1_3,__14#matrix_to_atom_2_1,__14#matrix_to_atom_2_2,__14#matrix_to_atom_2_3,__14#matrix_to_atom_3_1,__14#matrix_to_atom_3_2,__14#matrix_to_atom_3_3;int(1..)][sum([product([3,__15;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __15),
SumGeq([-1, d], __15)

Via-solver generator model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __34: matrix indexed by [Index, Index] of Value
find __35: int(2..8)
find __36: int(0..2)
find __37: matrix indexed by [Index, Index] of Value
find __38: int(3..9)
find __39: int(0..2)
find __40: matrix indexed by [Index, Index] of Value
find __41: int(3..9)
find __42: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)
find __34#matrix_to_atom_1_1: int(1..9)
find __34#matrix_to_atom_1_2: int(1..9)
find __34#matrix_to_atom_1_3: int(1..9)
find __34#matrix_to_atom_2_1: int(1..9)
find __34#matrix_to_atom_2_2: int(1..9)
find __34#matrix_to_atom_2_3: int(1..9)
find __34#matrix_to_atom_3_1: int(1..9)
find __34#matrix_to_atom_3_2: int(1..9)
find __34#matrix_to_atom_3_3: int(1..9)
find __37#matrix_to_atom_1_1: int(1..9)
find __37#matrix_to_atom_1_2: int(1..9)
find __37#matrix_to_atom_1_3: int(1..9)
find __37#matrix_to_atom_2_1: int(1..9)
find __37#matrix_to_atom_2_2: int(1..9)
find __37#matrix_to_atom_2_3: int(1..9)
find __37#matrix_to_atom_3_1: int(1..9)
find __37#matrix_to_atom_3_2: int(1..9)
find __37#matrix_to_atom_3_3: int(1..9)
find __40#matrix_to_atom_1_1: int(1..9)
find __40#matrix_to_atom_1_2: int(1..9)
find __40#matrix_to_atom_1_3: int(1..9)
find __40#matrix_to_atom_2_1: int(1..9)
find __40#matrix_to_atom_2_2: int(1..9)
find __40#matrix_to_atom_2_3: int(1..9)
find __40#matrix_to_atom_3_1: int(1..9)
find __40#matrix_to_atom_3_2: int(1..9)
find __40#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __34: matrix indexed by [Index, Index] of Value
find __35: int(2..8)
find __36: int(0..2)
find __37: matrix indexed by [Index, Index] of Value
find __38: int(3..9)
find __39: int(0..2)
find __40: matrix indexed by [Index, Index] of Value
find __41: int(3..9)
find __42: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)
find __34#matrix_to_atom_1_1: int(1..9)
find __34#matrix_to_atom_1_2: int(1..9)
find __34#matrix_to_atom_1_3: int(1..9)
find __34#matrix_to_atom_2_1: int(1..9)
find __34#matrix_to_atom_2_2: int(1..9)
find __34#matrix_to_atom_2_3: int(1..9)
find __34#matrix_to_atom_3_1: int(1..9)
find __34#matrix_to_atom_3_2: int(1..9)
find __34#matrix_to_atom_3_3: int(1..9)
find __37#matrix_to_atom_1_1: int(1..9)
find __37#matrix_to_atom_1_2: int(1..9)
find __37#matrix_to_atom_1_3: int(1..9)
find __37#matrix_to_atom_2_1: int(1..9)
find __37#matrix_to_atom_2_2: int(1..9)
find __37#matrix_to_atom_2_3: int(1..9)
find __37#matrix_to_atom_3_1: int(1..9)
find __37#matrix_to_atom_3_2: int(1..9)
find __37#matrix_to_atom_3_3: int(1..9)
find __40#matrix_to_atom_1_1: int(1..9)
find __40#matrix_to_atom_1_2: int(1..9)
find __40#matrix_to_atom_1_3: int(1..9)
find __40#matrix_to_atom_2_1: int(1..9)
find __40#matrix_to_atom_2_2: int(1..9)
find __40#matrix_to_atom_2_3: int(1..9)
find __40#matrix_to_atom_3_1: int(1..9)
find __40#matrix_to_atom_3_2: int(1..9)
find __40#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find r: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: Index
find __2: Index
find __3: int(1..9)
find __4: int(0..2)
find __5: matrix indexed by [Index, Index] of Value
find __6: Index
find __7: Index
find __8: int(1..9)
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: Index
find __12: Index
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: Index
find __17: Index
find __18: int(1..9)
find __19: int(0..2)
find __20: matrix indexed by [Index, Index] of Value
find __21: Index
find __22: Index
find __23: int(1..9)
find __24: int(0..2)
find __25: matrix indexed by [Index, Index] of Value
find __26: int(1..7)
find __27: int(0..2)
find __28: matrix indexed by [Index, Index] of Value
find __29: int(2..8)
find __30: int(0..2)
find __31: matrix indexed by [Index, Index] of Value
find __32: int(3..9)
find __33: int(0..2)
find __34: matrix indexed by [Index, Index] of Value
find __35: int(2..8)
find __36: int(0..2)
find __37: matrix indexed by [Index, Index] of Value
find __38: int(3..9)
find __39: int(0..2)
find __40: matrix indexed by [Index, Index] of Value
find __41: int(3..9)
find __42: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __5#matrix_to_atom_1_1: int(1..9)
find __5#matrix_to_atom_1_2: int(1..9)
find __5#matrix_to_atom_1_3: int(1..9)
find __5#matrix_to_atom_2_1: int(1..9)
find __5#matrix_to_atom_2_2: int(1..9)
find __5#matrix_to_atom_2_3: int(1..9)
find __5#matrix_to_atom_3_1: int(1..9)
find __5#matrix_to_atom_3_2: int(1..9)
find __5#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __20#matrix_to_atom_1_1: int(1..9)
find __20#matrix_to_atom_1_2: int(1..9)
find __20#matrix_to_atom_1_3: int(1..9)
find __20#matrix_to_atom_2_1: int(1..9)
find __20#matrix_to_atom_2_2: int(1..9)
find __20#matrix_to_atom_2_3: int(1..9)
find __20#matrix_to_atom_3_1: int(1..9)
find __20#matrix_to_atom_3_2: int(1..9)
find __20#matrix_to_atom_3_3: int(1..9)
find __25#matrix_to_atom_1_1: int(1..9)
find __25#matrix_to_atom_1_2: int(1..9)
find __25#matrix_to_atom_1_3: int(1..9)
find __25#matrix_to_atom_2_1: int(1..9)
find __25#matrix_to_atom_2_2: int(1..9)
find __25#matrix_to_atom_2_3: int(1..9)
find __25#matrix_to_atom_3_1: int(1..9)
find __25#matrix_to_atom_3_2: int(1..9)
find __25#matrix_to_atom_3_3: int(1..9)
find __28#matrix_to_atom_1_1: int(1..9)
find __28#matrix_to_atom_1_2: int(1..9)
find __28#matrix_to_atom_1_3: int(1..9)
find __28#matrix_to_atom_2_1: int(1..9)
find __28#matrix_to_atom_2_2: int(1..9)
find __28#matrix_to_atom_2_3: int(1..9)
find __28#matrix_to_atom_3_1: int(1..9)
find __28#matrix_to_atom_3_2: int(1..9)
find __28#matrix_to_atom_3_3: int(1..9)
find __31#matrix_to_atom_1_1: int(1..9)
find __31#matrix_to_atom_1_2: int(1..9)
find __31#matrix_to_atom_1_3: int(1..9)
find __31#matrix_to_atom_2_1: int(1..9)
find __31#matrix_to_atom_2_2: int(1..9)
find __31#matrix_to_atom_2_3: int(1..9)
find __31#matrix_to_atom_3_1: int(1..9)
find __31#matrix_to_atom_3_2: int(1..9)
find __31#matrix_to_atom_3_3: int(1..9)
find __34#matrix_to_atom_1_1: int(1..9)
find __34#matrix_to_atom_1_2: int(1..9)
find __34#matrix_to_atom_1_3: int(1..9)
find __34#matrix_to_atom_2_1: int(1..9)
find __34#matrix_to_atom_2_2: int(1..9)
find __34#matrix_to_atom_2_3: int(1..9)
find __34#matrix_to_atom_3_1: int(1..9)
find __34#matrix_to_atom_3_2: int(1..9)
find __34#matrix_to_atom_3_3: int(1..9)
find __37#matrix_to_atom_1_1: int(1..9)
find __37#matrix_to_atom_1_2: int(1..9)
find __37#matrix_to_atom_1_3: int(1..9)
find __37#matrix_to_atom_2_1: int(1..9)
find __37#matrix_to_atom_2_2: int(1..9)
find __37#matrix_to_atom_2_3: int(1..9)
find __37#matrix_to_atom_3_1: int(1..9)
find __37#matrix_to_atom_3_2: int(1..9)
find __37#matrix_to_atom_3_3: int(1..9)
find __40#matrix_to_atom_1_1: int(1..9)
find __40#matrix_to_atom_1_2: int(1..9)
find __40#matrix_to_atom_1_3: int(1..9)
find __40#matrix_to_atom_2_1: int(1..9)
find __40#matrix_to_atom_2_2: int(1..9)
find __40#matrix_to_atom_2_3: int(1..9)
find __40#matrix_to_atom_3_1: int(1..9)
find __40#matrix_to_atom_3_2: int(1..9)
find __40#matrix_to_atom_3_3: int(1..9)

such that

true

[ square[r, 3] | r : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[square[1, 3],square[2, 3],square[3, 3];int(1..)]

--

square[1, 3], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[1, 3] @ and([__inDomain(1,int(1..3)),__inDomain(3,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([{square[1, 3] @ and([__inDomain(1,int(1..3)),__inDomain(3,int(1..3));int(1..)])},square[2, 3],square[3, 3];int(1..)]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

square[2, 3], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[2, 3] @ and([__inDomain(2,int(1..3)),__inDomain(3,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],{square[2, 3] @ and([__inDomain(2,int(1..3)),__inDomain(3,int(1..3));int(1..)])},square[3, 3];int(1..)]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

square[3, 3], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[3, 3] @ and([__inDomain(3,int(1..3)),__inDomain(3,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],{square[3, 3] @ and([__inDomain(3,int(1..3)),__inDomain(3,int(1..3));int(1..)])};int(1..)]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(1..9)
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: int(1..9)
find __17: int(0..2)
find __18: matrix indexed by [Index, Index] of Value
find __19: int(1..9)
find __20: int(0..2)
find __21: matrix indexed by [Index, Index] of Value
find __22: int(1..9)
find __23: int(0..2)
find __24: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __18#matrix_to_atom_1_1: int(1..9)
find __18#matrix_to_atom_1_2: int(1..9)
find __18#matrix_to_atom_1_3: int(1..9)
find __18#matrix_to_atom_2_1: int(1..9)
find __18#matrix_to_atom_2_2: int(1..9)
find __18#matrix_to_atom_2_3: int(1..9)
find __18#matrix_to_atom_3_1: int(1..9)
find __18#matrix_to_atom_3_2: int(1..9)
find __18#matrix_to_atom_3_3: int(1..9)
find __21#matrix_to_atom_1_1: int(1..9)
find __21#matrix_to_atom_1_2: int(1..9)
find __21#matrix_to_atom_1_3: int(1..9)
find __21#matrix_to_atom_2_1: int(1..9)
find __21#matrix_to_atom_2_2: int(1..9)
find __21#matrix_to_atom_2_3: int(1..9)
find __21#matrix_to_atom_3_1: int(1..9)
find __21#matrix_to_atom_3_2: int(1..9)
find __21#matrix_to_atom_3_3: int(1..9)

such that

(0 != __24[d, d])

--

(0 != __24#matrix_to_atom[d, d]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __24#matrix_to_atom[d, d])
new variables:
  find __24#matrix_to_atom_1_1: int(1..9)
  find __24#matrix_to_atom_1_2: int(1..9)
  find __24#matrix_to_atom_1_3: int(1..9)
  find __24#matrix_to_atom_2_1: int(1..9)
  find __24#matrix_to_atom_2_2: int(1..9)
  find __24#matrix_to_atom_2_3: int(1..9)
  find __24#matrix_to_atom_3_1: int(1..9)
  find __24#matrix_to_atom_3_2: int(1..9)
  find __24#matrix_to_atom_3_3: int(1..9)

--

__24#matrix_to_atom[d, d], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__24#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}

--

(0 != {__24#matrix_to_atom[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __24#matrix_to_atom[d, d])

--

(0 != __24#matrix_to_atom[d, d]), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__24#matrix_to_atom_1_1,__24#matrix_to_atom_1_2,__24#matrix_to_atom_1_3,__24#matrix_to_atom_2_1,__24#matrix_to_atom_2_2,__24#matrix_to_atom_2_3,__24#matrix_to_atom_3_1,__24#matrix_to_atom_3_2,__24#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(d - 1);int(1..)]),1;int(1..)])])

--

product([1,(d - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(d - 1);int(1..)])

--

product([(d - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(d - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__24#matrix_to_atom_1_1,__24#matrix_to_atom_1_2,__24#matrix_to_atom_1_3,__24#matrix_to_atom_2_1,__24#matrix_to_atom_2_2,__24#matrix_to_atom_2_3,__24#matrix_to_atom_3_1,__24#matrix_to_atom_3_2,__24#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(d - 1),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__24#matrix_to_atom_1_1,__24#matrix_to_atom_1_2,__24#matrix_to_atom_1_3,__24#matrix_to_atom_2_1,__24#matrix_to_atom_2_2,__24#matrix_to_atom_2_3,__24#matrix_to_atom_3_1,__24#matrix_to_atom_3_2,__24#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(d - 1),1;int(1..)])])

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__24#matrix_to_atom_1_1,__24#matrix_to_atom_1_2,__24#matrix_to_atom_1_3,__24#matrix_to_atom_2_1,__24#matrix_to_atom_2_2,__24#matrix_to_atom_2_3,__24#matrix_to_atom_3_1,__24#matrix_to_atom_3_2,__24#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-(1);int(1..)]),1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__24#matrix_to_atom_1_1,__24#matrix_to_atom_1_2,__24#matrix_to_atom_1_3,__24#matrix_to_atom_2_1,__24#matrix_to_atom_2_2,__24#matrix_to_atom_2_3,__24#matrix_to_atom_3_1,__24#matrix_to_atom_3_2,__24#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)])])

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([d,-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])

--

(0 != [__24#matrix_to_atom_1_1,__24#matrix_to_atom_1_2,__24#matrix_to_atom_1_3,__24#matrix_to_atom_2_1,__24#matrix_to_atom_2_2,__24#matrix_to_atom_2_3,__24#matrix_to_atom_3_1,__24#matrix_to_atom_3_2,__24#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d,-1,1;int(1..)])]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__24#matrix_to_atom_1_1,__24#matrix_to_atom_1_2,__24#matrix_to_atom_1_3,__24#matrix_to_atom_2_1,__24#matrix_to_atom_2_2,__24#matrix_to_atom_2_3,__24#matrix_to_atom_3_1,__24#matrix_to_atom_3_2,__24#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])])

--

[__24#matrix_to_atom_1_1,__24#matrix_to_atom_1_2,__24#matrix_to_atom_1_3,__24#matrix_to_atom_2_1,__24#matrix_to_atom_2_2,__24#matrix_to_atom_2_3,__24#matrix_to_atom_3_1,__24#matrix_to_atom_3_2,__24#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__24#matrix_to_atom_1_1,__24#matrix_to_atom_1_2,__24#matrix_to_atom_1_3,__24#matrix_to_atom_2_1,__24#matrix_to_atom_2_2,__24#matrix_to_atom_2_3,__24#matrix_to_atom_3_1,__24#matrix_to_atom_3_2,__24#matrix_to_atom_3_3;int(1..)][__25]
new variables:
  find __25: int(1..9)
new constraints:
  __25 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)])

--

__25 =aux sum([product([3,sum([d,-1;int(1..)]);int(1..)]),d;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([FlatWeightedSumLeq([3, 1],[__26, d],__25),FlatWeightedSumGeq([3, 1],[__26, d],__25);int(1..)])
new variables:
  find __26: int(0..2)
new constraints:
  __26 =aux sum([d,-1;int(1..)])

--

(0 != [__24#matrix_to_atom_1_1,__24#matrix_to_atom_1_2,__24#matrix_to_atom_1_3,__24#matrix_to_atom_2_1,__24#matrix_to_atom_2_2,__24#matrix_to_atom_2_3,__24#matrix_to_atom_3_1,__24#matrix_to_atom_3_2,__24#matrix_to_atom_3_3;int(1..)][__25]),
and([FlatWeightedSumLeq([3, 1],[__26, d],__25),FlatWeightedSumGeq([3, 1],[__26, d],__25);int(1..)]),
__26 =aux sum([d,-1;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__24#matrix_to_atom_1_1,__24#matrix_to_atom_1_2,__24#matrix_to_atom_1_3,__24#matrix_to_atom_2_1,__24#matrix_to_atom_2_2,__24#matrix_to_atom_2_3,__24#matrix_to_atom_3_1,__24#matrix_to_atom_3_2,__24#matrix_to_atom_3_3;int(1..)][__25]),
FlatWeightedSumLeq([3, 1],[__26, d],__25),
FlatWeightedSumGeq([3, 1],[__26, d],__25),
__26 =aux sum([d,-1;int(1..)])

--

__26 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __26),SumGeq([-1, d], __26);int(1..)])

--

(0 != [__24#matrix_to_atom_1_1,__24#matrix_to_atom_1_2,__24#matrix_to_atom_1_3,__24#matrix_to_atom_2_1,__24#matrix_to_atom_2_2,__24#matrix_to_atom_2_3,__24#matrix_to_atom_3_1,__24#matrix_to_atom_3_2,__24#matrix_to_atom_3_3;int(1..)][__25]),
FlatWeightedSumLeq([3, 1],[__26, d],__25),
FlatWeightedSumGeq([3, 1],[__26, d],__25),
and([SumLeq([-1, d], __26),SumGeq([-1, d], __26);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__24#matrix_to_atom_1_1,__24#matrix_to_atom_1_2,__24#matrix_to_atom_1_3,__24#matrix_to_atom_2_1,__24#matrix_to_atom_2_2,__24#matrix_to_atom_2_3,__24#matrix_to_atom_3_1,__24#matrix_to_atom_3_2,__24#matrix_to_atom_3_3;int(1..)][__25]),
FlatWeightedSumLeq([3, 1],[__26, d],__25),
FlatWeightedSumGeq([3, 1],[__26, d],__25),
SumLeq([-1, d], __26),
SumGeq([-1, d], __26)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(1..9)
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: int(1..9)
find __17: int(0..2)
find __18: matrix indexed by [Index, Index] of Value
find __19: int(1..9)
find __20: int(0..2)
find __21: matrix indexed by [Index, Index] of Value
find __22: int(1..9)
find __23: int(0..2)
find __24: matrix indexed by [Index, Index] of Value
find __25: int(1..9)
find __26: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __18#matrix_to_atom_1_1: int(1..9)
find __18#matrix_to_atom_1_2: int(1..9)
find __18#matrix_to_atom_1_3: int(1..9)
find __18#matrix_to_atom_2_1: int(1..9)
find __18#matrix_to_atom_2_2: int(1..9)
find __18#matrix_to_atom_2_3: int(1..9)
find __18#matrix_to_atom_3_1: int(1..9)
find __18#matrix_to_atom_3_2: int(1..9)
find __18#matrix_to_atom_3_3: int(1..9)
find __21#matrix_to_atom_1_1: int(1..9)
find __21#matrix_to_atom_1_2: int(1..9)
find __21#matrix_to_atom_1_3: int(1..9)
find __21#matrix_to_atom_2_1: int(1..9)
find __21#matrix_to_atom_2_2: int(1..9)
find __21#matrix_to_atom_2_3: int(1..9)
find __21#matrix_to_atom_3_1: int(1..9)
find __21#matrix_to_atom_3_2: int(1..9)
find __21#matrix_to_atom_3_3: int(1..9)
find __24#matrix_to_atom_1_1: int(1..9)
find __24#matrix_to_atom_1_2: int(1..9)
find __24#matrix_to_atom_1_3: int(1..9)
find __24#matrix_to_atom_2_1: int(1..9)
find __24#matrix_to_atom_2_2: int(1..9)
find __24#matrix_to_atom_2_3: int(1..9)
find __24#matrix_to_atom_3_1: int(1..9)
find __24#matrix_to_atom_3_2: int(1..9)
find __24#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__24#matrix_to_atom_1_1,__24#matrix_to_atom_1_2,__24#matrix_to_atom_1_3,__24#matrix_to_atom_2_1,__24#matrix_to_atom_2_2,__24#matrix_to_atom_2_3,__24#matrix_to_atom_3_1,__24#matrix_to_atom_3_2,__24#matrix_to_atom_3_3;int(1..)][__25]),
FlatWeightedSumLeq([3, 1],[__26, d],__25),
FlatWeightedSumGeq([3, 1],[__26, d],__25),
SumLeq([-1, d], __26),
SumGeq([-1, d], __26)

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(0..2)
find __14: matrix indexed by [Index, Index] of Value
find __15: int(0..2)
find __16: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __8#matrix_to_atom_1_1: int(1..9)
find __8#matrix_to_atom_1_2: int(1..9)
find __8#matrix_to_atom_1_3: int(1..9)
find __8#matrix_to_atom_2_1: int(1..9)
find __8#matrix_to_atom_2_2: int(1..9)
find __8#matrix_to_atom_2_3: int(1..9)
find __8#matrix_to_atom_3_1: int(1..9)
find __8#matrix_to_atom_3_2: int(1..9)
find __8#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __14#matrix_to_atom_1_1: int(1..9)
find __14#matrix_to_atom_1_2: int(1..9)
find __14#matrix_to_atom_1_3: int(1..9)
find __14#matrix_to_atom_2_1: int(1..9)
find __14#matrix_to_atom_2_2: int(1..9)
find __14#matrix_to_atom_2_3: int(1..9)
find __14#matrix_to_atom_3_1: int(1..9)
find __14#matrix_to_atom_3_2: int(1..9)
find __14#matrix_to_atom_3_3: int(1..9)

such that

(0 != __16[d, (4 - d)])

--

(4 - d), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([4,-(d);int(1..)])

--

(0 != __16#matrix_to_atom[d, sum([4,-(d);int(1..)])]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __16#matrix_to_atom[d, sum([4,-(d);int(1..)])])
new variables:
  find __16#matrix_to_atom_1_1: int(1..9)
  find __16#matrix_to_atom_1_2: int(1..9)
  find __16#matrix_to_atom_1_3: int(1..9)
  find __16#matrix_to_atom_2_1: int(1..9)
  find __16#matrix_to_atom_2_2: int(1..9)
  find __16#matrix_to_atom_2_3: int(1..9)
  find __16#matrix_to_atom_3_1: int(1..9)
  find __16#matrix_to_atom_3_2: int(1..9)
  find __16#matrix_to_atom_3_3: int(1..9)

--

__16#matrix_to_atom[d, sum([4,-(d);int(1..)])], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__16#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

(0 != {__16#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != {__16#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])})

--

(0 != {__16#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> bubble_up ([("Bubble", 8800)])
{(0 != __16#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

{(0 != __16#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}, 
   ~~> expand_bubble ([("Bubble", 8900)])
and([(0 != __16#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)])

--

and([(0 != __16#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __16#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])

--

(0 != __16#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __16#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(0 != __16#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__16#matrix_to_atom_1_1,__16#matrix_to_atom_1_2,__16#matrix_to_atom_1_3,__16#matrix_to_atom_2_1,__16#matrix_to_atom_2_2,__16#matrix_to_atom_2_3,__16#matrix_to_atom_3_1,__16#matrix_to_atom_3_2,__16#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(sum([4,-(d);int(1..)]) - 1);int(1..)])

--

product([(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(sum([4,-(d);int(1..)]) - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__16#matrix_to_atom_1_1,__16#matrix_to_atom_1_2,__16#matrix_to_atom_1_3,__16#matrix_to_atom_2_1,__16#matrix_to_atom_2_2,__16#matrix_to_atom_2_3,__16#matrix_to_atom_3_1,__16#matrix_to_atom_3_2,__16#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__16#matrix_to_atom_1_1,__16#matrix_to_atom_1_2,__16#matrix_to_atom_1_3,__16#matrix_to_atom_2_1,__16#matrix_to_atom_2_2,__16#matrix_to_atom_2_3,__16#matrix_to_atom_3_1,__16#matrix_to_atom_3_2,__16#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(sum([4,-(d);int(1..)]) - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([sum([4,-(d);int(1..)]),-(1);int(1..)])

--

(0 != [__16#matrix_to_atom_1_1,__16#matrix_to_atom_1_2,__16#matrix_to_atom_1_3,__16#matrix_to_atom_2_1,__16#matrix_to_atom_2_2,__16#matrix_to_atom_2_3,__16#matrix_to_atom_3_1,__16#matrix_to_atom_3_2,__16#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-(1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__16#matrix_to_atom_1_1,__16#matrix_to_atom_1_2,__16#matrix_to_atom_1_3,__16#matrix_to_atom_2_1,__16#matrix_to_atom_2_2,__16#matrix_to_atom_2_3,__16#matrix_to_atom_3_1,__16#matrix_to_atom_3_2,__16#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])

--

(0 != [__16#matrix_to_atom_1_1,__16#matrix_to_atom_1_2,__16#matrix_to_atom_1_3,__16#matrix_to_atom_2_1,__16#matrix_to_atom_2_2,__16#matrix_to_atom_2_3,__16#matrix_to_atom_3_1,__16#matrix_to_atom_3_2,__16#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__16#matrix_to_atom_1_1,__16#matrix_to_atom_1_2,__16#matrix_to_atom_1_3,__16#matrix_to_atom_2_1,__16#matrix_to_atom_2_2,__16#matrix_to_atom_2_3,__16#matrix_to_atom_3_1,__16#matrix_to_atom_3_2,__16#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([3,sum([d,-1;int(1..)]);int(1..)]), 
   ~~> flatten_product ([("Minion", 4200)])
product([3,__17;int(1..)])
new variables:
  find __17: int(0..2)
new constraints:
  __17 =aux sum([d,-1;int(1..)])

--

__17 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __17),SumGeq([-1, d], __17);int(1..)])

--

(0 != [__16#matrix_to_atom_1_1,__16#matrix_to_atom_1_2,__16#matrix_to_atom_1_3,__16#matrix_to_atom_2_1,__16#matrix_to_atom_2_2,__16#matrix_to_atom_2_3,__16#matrix_to_atom_3_1,__16#matrix_to_atom_3_2,__16#matrix_to_atom_3_3;int(1..)][sum([product([3,__17;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
and([SumLeq([-1, d], __17),SumGeq([-1, d], __17);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__16#matrix_to_atom_1_1,__16#matrix_to_atom_1_2,__16#matrix_to_atom_1_3,__16#matrix_to_atom_2_1,__16#matrix_to_atom_2_2,__16#matrix_to_atom_2_3,__16#matrix_to_atom_3_1,__16#matrix_to_atom_3_2,__16#matrix_to_atom_3_3;int(1..)][sum([product([3,__17;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __17),
SumGeq([-1, d], __17)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(0..2)
find __14: matrix indexed by [Index, Index] of Value
find __15: int(0..2)
find __16: matrix indexed by [Index, Index] of Value
find __17: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __8#matrix_to_atom_1_1: int(1..9)
find __8#matrix_to_atom_1_2: int(1..9)
find __8#matrix_to_atom_1_3: int(1..9)
find __8#matrix_to_atom_2_1: int(1..9)
find __8#matrix_to_atom_2_2: int(1..9)
find __8#matrix_to_atom_2_3: int(1..9)
find __8#matrix_to_atom_3_1: int(1..9)
find __8#matrix_to_atom_3_2: int(1..9)
find __8#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __14#matrix_to_atom_1_1: int(1..9)
find __14#matrix_to_atom_1_2: int(1..9)
find __14#matrix_to_atom_1_3: int(1..9)
find __14#matrix_to_atom_2_1: int(1..9)
find __14#matrix_to_atom_2_2: int(1..9)
find __14#matrix_to_atom_2_3: int(1..9)
find __14#matrix_to_atom_3_1: int(1..9)
find __14#matrix_to_atom_3_2: int(1..9)
find __14#matrix_to_atom_3_3: int(1..9)
find __16#matrix_to_atom_1_1: int(1..9)
find __16#matrix_to_atom_1_2: int(1..9)
find __16#matrix_to_atom_1_3: int(1..9)
find __16#matrix_to_atom_2_1: int(1..9)
find __16#matrix_to_atom_2_2: int(1..9)
find __16#matrix_to_atom_2_3: int(1..9)
find __16#matrix_to_atom_3_1: int(1..9)
find __16#matrix_to_atom_3_2: int(1..9)
find __16#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__16#matrix_to_atom_1_1,__16#matrix_to_atom_1_2,__16#matrix_to_atom_1_3,__16#matrix_to_atom_2_1,__16#matrix_to_atom_2_2,__16#matrix_to_atom_2_3,__16#matrix_to_atom_3_1,__16#matrix_to_atom_3_2,__16#matrix_to_atom_3_3;int(1..)][sum([product([3,__17;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __17),
SumGeq([-1, d], __17)

Via-solver generator model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(1..9)
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: int(1..9)
find __17: int(0..2)
find __18: matrix indexed by [Index, Index] of Value
find __19: int(1..9)
find __20: int(0..2)
find __21: matrix indexed by [Index, Index] of Value
find __22: int(1..9)
find __23: int(0..2)
find __24: matrix indexed by [Index, Index] of Value
find __25: int(1..9)
find __26: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __18#matrix_to_atom_1_1: int(1..9)
find __18#matrix_to_atom_1_2: int(1..9)
find __18#matrix_to_atom_1_3: int(1..9)
find __18#matrix_to_atom_2_1: int(1..9)
find __18#matrix_to_atom_2_2: int(1..9)
find __18#matrix_to_atom_2_3: int(1..9)
find __18#matrix_to_atom_3_1: int(1..9)
find __18#matrix_to_atom_3_2: int(1..9)
find __18#matrix_to_atom_3_3: int(1..9)
find __21#matrix_to_atom_1_1: int(1..9)
find __21#matrix_to_atom_1_2: int(1..9)
find __21#matrix_to_atom_1_3: int(1..9)
find __21#matrix_to_atom_2_1: int(1..9)
find __21#matrix_to_atom_2_2: int(1..9)
find __21#matrix_to_atom_2_3: int(1..9)
find __21#matrix_to_atom_3_1: int(1..9)
find __21#matrix_to_atom_3_2: int(1..9)
find __21#matrix_to_atom_3_3: int(1..9)
find __24#matrix_to_atom_1_1: int(1..9)
find __24#matrix_to_atom_1_2: int(1..9)
find __24#matrix_to_atom_1_3: int(1..9)
find __24#matrix_to_atom_2_1: int(1..9)
find __24#matrix_to_atom_2_2: int(1..9)
find __24#matrix_to_atom_2_3: int(1..9)
find __24#matrix_to_atom_3_1: int(1..9)
find __24#matrix_to_atom_3_2: int(1..9)
find __24#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(1..9)
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: int(1..9)
find __17: int(0..2)
find __18: matrix indexed by [Index, Index] of Value
find __19: int(1..9)
find __20: int(0..2)
find __21: matrix indexed by [Index, Index] of Value
find __22: int(1..9)
find __23: int(0..2)
find __24: matrix indexed by [Index, Index] of Value
find __25: int(1..9)
find __26: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __18#matrix_to_atom_1_1: int(1..9)
find __18#matrix_to_atom_1_2: int(1..9)
find __18#matrix_to_atom_1_3: int(1..9)
find __18#matrix_to_atom_2_1: int(1..9)
find __18#matrix_to_atom_2_2: int(1..9)
find __18#matrix_to_atom_2_3: int(1..9)
find __18#matrix_to_atom_3_1: int(1..9)
find __18#matrix_to_atom_3_2: int(1..9)
find __18#matrix_to_atom_3_3: int(1..9)
find __21#matrix_to_atom_1_1: int(1..9)
find __21#matrix_to_atom_1_2: int(1..9)
find __21#matrix_to_atom_1_3: int(1..9)
find __21#matrix_to_atom_2_1: int(1..9)
find __21#matrix_to_atom_2_2: int(1..9)
find __21#matrix_to_atom_2_3: int(1..9)
find __21#matrix_to_atom_3_1: int(1..9)
find __21#matrix_to_atom_3_2: int(1..9)
find __21#matrix_to_atom_3_3: int(1..9)
find __24#matrix_to_atom_1_1: int(1..9)
find __24#matrix_to_atom_1_2: int(1..9)
find __24#matrix_to_atom_1_3: int(1..9)
find __24#matrix_to_atom_2_1: int(1..9)
find __24#matrix_to_atom_2_2: int(1..9)
find __24#matrix_to_atom_2_3: int(1..9)
find __24#matrix_to_atom_3_1: int(1..9)
find __24#matrix_to_atom_3_2: int(1..9)
find __24#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(1..9)
find __2: int(0..2)
find __3: matrix indexed by [Index, Index] of Value
find __4: int(1..9)
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(1..9)
find __8: int(0..2)
find __9: matrix indexed by [Index, Index] of Value
find __10: int(1..9)
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(1..9)
find __14: int(0..2)
find __15: matrix indexed by [Index, Index] of Value
find __16: int(1..9)
find __17: int(0..2)
find __18: matrix indexed by [Index, Index] of Value
find __19: int(1..9)
find __20: int(0..2)
find __21: matrix indexed by [Index, Index] of Value
find __22: int(1..9)
find __23: int(0..2)
find __24: matrix indexed by [Index, Index] of Value
find __25: int(1..9)
find __26: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __3#matrix_to_atom_1_1: int(1..9)
find __3#matrix_to_atom_1_2: int(1..9)
find __3#matrix_to_atom_1_3: int(1..9)
find __3#matrix_to_atom_2_1: int(1..9)
find __3#matrix_to_atom_2_2: int(1..9)
find __3#matrix_to_atom_2_3: int(1..9)
find __3#matrix_to_atom_3_1: int(1..9)
find __3#matrix_to_atom_3_2: int(1..9)
find __3#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __9#matrix_to_atom_1_1: int(1..9)
find __9#matrix_to_atom_1_2: int(1..9)
find __9#matrix_to_atom_1_3: int(1..9)
find __9#matrix_to_atom_2_1: int(1..9)
find __9#matrix_to_atom_2_2: int(1..9)
find __9#matrix_to_atom_2_3: int(1..9)
find __9#matrix_to_atom_3_1: int(1..9)
find __9#matrix_to_atom_3_2: int(1..9)
find __9#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __15#matrix_to_atom_1_1: int(1..9)
find __15#matrix_to_atom_1_2: int(1..9)
find __15#matrix_to_atom_1_3: int(1..9)
find __15#matrix_to_atom_2_1: int(1..9)
find __15#matrix_to_atom_2_2: int(1..9)
find __15#matrix_to_atom_2_3: int(1..9)
find __15#matrix_to_atom_3_1: int(1..9)
find __15#matrix_to_atom_3_2: int(1..9)
find __15#matrix_to_atom_3_3: int(1..9)
find __18#matrix_to_atom_1_1: int(1..9)
find __18#matrix_to_atom_1_2: int(1..9)
find __18#matrix_to_atom_1_3: int(1..9)
find __18#matrix_to_atom_2_1: int(1..9)
find __18#matrix_to_atom_2_2: int(1..9)
find __18#matrix_to_atom_2_3: int(1..9)
find __18#matrix_to_atom_3_1: int(1..9)
find __18#matrix_to_atom_3_2: int(1..9)
find __18#matrix_to_atom_3_3: int(1..9)
find __21#matrix_to_atom_1_1: int(1..9)
find __21#matrix_to_atom_1_2: int(1..9)
find __21#matrix_to_atom_1_3: int(1..9)
find __21#matrix_to_atom_2_1: int(1..9)
find __21#matrix_to_atom_2_2: int(1..9)
find __21#matrix_to_atom_2_3: int(1..9)
find __21#matrix_to_atom_3_1: int(1..9)
find __21#matrix_to_atom_3_2: int(1..9)
find __21#matrix_to_atom_3_3: int(1..9)
find __24#matrix_to_atom_1_1: int(1..9)
find __24#matrix_to_atom_1_2: int(1..9)
find __24#matrix_to_atom_1_3: int(1..9)
find __24#matrix_to_atom_2_1: int(1..9)
find __24#matrix_to_atom_2_2: int(1..9)
find __24#matrix_to_atom_2_3: int(1..9)
find __24#matrix_to_atom_3_1: int(1..9)
find __24#matrix_to_atom_3_2: int(1..9)
find __24#matrix_to_atom_3_3: int(1..9)

such that

true

[ square[d, d] | d : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[square[1, 1],square[2, 2],square[3, 3];int(1..)]

--

square[1, 1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[1, 1] @ and([__inDomain(1,int(1..3)),__inDomain(1,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([{square[1, 1] @ and([__inDomain(1,int(1..3)),__inDomain(1,int(1..3));int(1..)])},square[2, 2],square[3, 3];int(1..)]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

square[2, 2], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[2, 2] @ and([__inDomain(2,int(1..3)),__inDomain(2,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],{square[2, 2] @ and([__inDomain(2,int(1..3)),__inDomain(2,int(1..3));int(1..)])},square[3, 3];int(1..)]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

square[3, 3], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[3, 3] @ and([__inDomain(3,int(1..3)),__inDomain(3,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 2],{square[3, 3] @ and([__inDomain(3,int(1..3)),__inDomain(3,int(1..3));int(1..)])};int(1..)]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(0..2)
find __14: matrix indexed by [Index, Index] of Value
find __15: int(0..2)
find __16: matrix indexed by [Index, Index] of Value
find __17: int(0..2)
find __18: matrix indexed by [Index, Index] of Value
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __8#matrix_to_atom_1_1: int(1..9)
find __8#matrix_to_atom_1_2: int(1..9)
find __8#matrix_to_atom_1_3: int(1..9)
find __8#matrix_to_atom_2_1: int(1..9)
find __8#matrix_to_atom_2_2: int(1..9)
find __8#matrix_to_atom_2_3: int(1..9)
find __8#matrix_to_atom_3_1: int(1..9)
find __8#matrix_to_atom_3_2: int(1..9)
find __8#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __14#matrix_to_atom_1_1: int(1..9)
find __14#matrix_to_atom_1_2: int(1..9)
find __14#matrix_to_atom_1_3: int(1..9)
find __14#matrix_to_atom_2_1: int(1..9)
find __14#matrix_to_atom_2_2: int(1..9)
find __14#matrix_to_atom_2_3: int(1..9)
find __14#matrix_to_atom_3_1: int(1..9)
find __14#matrix_to_atom_3_2: int(1..9)
find __14#matrix_to_atom_3_3: int(1..9)
find __16#matrix_to_atom_1_1: int(1..9)
find __16#matrix_to_atom_1_2: int(1..9)
find __16#matrix_to_atom_1_3: int(1..9)
find __16#matrix_to_atom_2_1: int(1..9)
find __16#matrix_to_atom_2_2: int(1..9)
find __16#matrix_to_atom_2_3: int(1..9)
find __16#matrix_to_atom_3_1: int(1..9)
find __16#matrix_to_atom_3_2: int(1..9)
find __16#matrix_to_atom_3_3: int(1..9)

such that

(0 != __18[d, (4 - d)])

--

(4 - d), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([4,-(d);int(1..)])

--

(0 != __18#matrix_to_atom[d, sum([4,-(d);int(1..)])]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(0 != __18#matrix_to_atom[d, sum([4,-(d);int(1..)])])
new variables:
  find __18#matrix_to_atom_1_1: int(1..9)
  find __18#matrix_to_atom_1_2: int(1..9)
  find __18#matrix_to_atom_1_3: int(1..9)
  find __18#matrix_to_atom_2_1: int(1..9)
  find __18#matrix_to_atom_2_2: int(1..9)
  find __18#matrix_to_atom_2_3: int(1..9)
  find __18#matrix_to_atom_3_1: int(1..9)
  find __18#matrix_to_atom_3_2: int(1..9)
  find __18#matrix_to_atom_3_3: int(1..9)

--

__18#matrix_to_atom[d, sum([4,-(d);int(1..)])], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__18#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

(0 != {__18#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != {__18#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])})

--

(0 != {__18#matrix_to_atom[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}), 
   ~~> bubble_up ([("Bubble", 8800)])
{(0 != __18#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}

--

{(0 != __18#matrix_to_atom[d, sum([4,-(d);int(1..)])]) @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}, 
   ~~> expand_bubble ([("Bubble", 8900)])
and([(0 != __18#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)])

--

and([(0 != __18#matrix_to_atom[d, sum([4,-(d);int(1..)])]),and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __18#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])

--

(0 != __18#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != __18#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(0 != __18#matrix_to_atom[d, sum([4,-(d);int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,(d - 1);int(1..)]),product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([1,(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> reorder_product ([("Base", 8800)])
product([(sum([4,-(d);int(1..)]) - 1);int(1..)])

--

product([(sum([4,-(d);int(1..)]) - 1);int(1..)]), 
   ~~> remove_unit_vector_products ([("Base", 8800)])
(sum([4,-(d);int(1..)]) - 1)

--

(d - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([d,-(1);int(1..)])

--

(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-(1);int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),(sum([4,-(d);int(1..)]) - 1),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

(sum([4,-(d);int(1..)]) - 1), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([sum([4,-(d);int(1..)]),-(1);int(1..)])

--

(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-(1);int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

sum([product([3,sum([d,-1;int(1..)]);int(1..)]),sum([sum([4,-(d);int(1..)]),-1;int(1..)]),1;int(1..)]), 
   ~~> normalise_associative_commutative ([("Base", 8900)])
sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])

--

(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),4,-(d),-1,1;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,sum([d,-1;int(1..)]);int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3))

--

product([3,sum([d,-1;int(1..)]);int(1..)]), 
   ~~> flatten_product ([("Minion", 4200)])
product([3,__19;int(1..)])
new variables:
  find __19: int(0..2)
new constraints:
  __19 =aux sum([d,-1;int(1..)])

--

__19 =aux sum([d,-1;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([-1, d], __19),SumGeq([-1, d], __19);int(1..)])

--

(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,__19;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
and([SumLeq([-1, d], __19),SumGeq([-1, d], __19);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,__19;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __19),
SumGeq([-1, d], __19)

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(0..2)
find __14: matrix indexed by [Index, Index] of Value
find __15: int(0..2)
find __16: matrix indexed by [Index, Index] of Value
find __17: int(0..2)
find __18: matrix indexed by [Index, Index] of Value
find __19: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __8#matrix_to_atom_1_1: int(1..9)
find __8#matrix_to_atom_1_2: int(1..9)
find __8#matrix_to_atom_1_3: int(1..9)
find __8#matrix_to_atom_2_1: int(1..9)
find __8#matrix_to_atom_2_2: int(1..9)
find __8#matrix_to_atom_2_3: int(1..9)
find __8#matrix_to_atom_3_1: int(1..9)
find __8#matrix_to_atom_3_2: int(1..9)
find __8#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __14#matrix_to_atom_1_1: int(1..9)
find __14#matrix_to_atom_1_2: int(1..9)
find __14#matrix_to_atom_1_3: int(1..9)
find __14#matrix_to_atom_2_1: int(1..9)
find __14#matrix_to_atom_2_2: int(1..9)
find __14#matrix_to_atom_2_3: int(1..9)
find __14#matrix_to_atom_3_1: int(1..9)
find __14#matrix_to_atom_3_2: int(1..9)
find __14#matrix_to_atom_3_3: int(1..9)
find __16#matrix_to_atom_1_1: int(1..9)
find __16#matrix_to_atom_1_2: int(1..9)
find __16#matrix_to_atom_1_3: int(1..9)
find __16#matrix_to_atom_2_1: int(1..9)
find __16#matrix_to_atom_2_2: int(1..9)
find __16#matrix_to_atom_2_3: int(1..9)
find __16#matrix_to_atom_3_1: int(1..9)
find __16#matrix_to_atom_3_2: int(1..9)
find __16#matrix_to_atom_3_3: int(1..9)
find __18#matrix_to_atom_1_1: int(1..9)
find __18#matrix_to_atom_1_2: int(1..9)
find __18#matrix_to_atom_1_3: int(1..9)
find __18#matrix_to_atom_2_1: int(1..9)
find __18#matrix_to_atom_2_2: int(1..9)
find __18#matrix_to_atom_2_3: int(1..9)
find __18#matrix_to_atom_3_1: int(1..9)
find __18#matrix_to_atom_3_2: int(1..9)
find __18#matrix_to_atom_3_3: int(1..9)

such that

(0 != [__18#matrix_to_atom_1_1,__18#matrix_to_atom_1_2,__18#matrix_to_atom_1_3,__18#matrix_to_atom_2_1,__18#matrix_to_atom_2_2,__18#matrix_to_atom_2_3,__18#matrix_to_atom_3_1,__18#matrix_to_atom_3_2,__18#matrix_to_atom_3_3;int(1..)][sum([product([3,__19;int(1..)]),-(d),4;int(1..)])]),
__inDomain(sum([4,-(d);int(1..)]),int(1..3)),
SumLeq([-1, d], __19),
SumGeq([-1, d], __19)

Via-solver generator model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(0..2)
find __14: matrix indexed by [Index, Index] of Value
find __15: int(0..2)
find __16: matrix indexed by [Index, Index] of Value
find __17: int(0..2)
find __18: matrix indexed by [Index, Index] of Value
find __19: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __8#matrix_to_atom_1_1: int(1..9)
find __8#matrix_to_atom_1_2: int(1..9)
find __8#matrix_to_atom_1_3: int(1..9)
find __8#matrix_to_atom_2_1: int(1..9)
find __8#matrix_to_atom_2_2: int(1..9)
find __8#matrix_to_atom_2_3: int(1..9)
find __8#matrix_to_atom_3_1: int(1..9)
find __8#matrix_to_atom_3_2: int(1..9)
find __8#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __14#matrix_to_atom_1_1: int(1..9)
find __14#matrix_to_atom_1_2: int(1..9)
find __14#matrix_to_atom_1_3: int(1..9)
find __14#matrix_to_atom_2_1: int(1..9)
find __14#matrix_to_atom_2_2: int(1..9)
find __14#matrix_to_atom_2_3: int(1..9)
find __14#matrix_to_atom_3_1: int(1..9)
find __14#matrix_to_atom_3_2: int(1..9)
find __14#matrix_to_atom_3_3: int(1..9)
find __16#matrix_to_atom_1_1: int(1..9)
find __16#matrix_to_atom_1_2: int(1..9)
find __16#matrix_to_atom_1_3: int(1..9)
find __16#matrix_to_atom_2_1: int(1..9)
find __16#matrix_to_atom_2_2: int(1..9)
find __16#matrix_to_atom_2_3: int(1..9)
find __16#matrix_to_atom_3_1: int(1..9)
find __16#matrix_to_atom_3_2: int(1..9)
find __16#matrix_to_atom_3_3: int(1..9)
find __18#matrix_to_atom_1_1: int(1..9)
find __18#matrix_to_atom_1_2: int(1..9)
find __18#matrix_to_atom_1_3: int(1..9)
find __18#matrix_to_atom_2_1: int(1..9)
find __18#matrix_to_atom_2_2: int(1..9)
find __18#matrix_to_atom_2_3: int(1..9)
find __18#matrix_to_atom_3_1: int(1..9)
find __18#matrix_to_atom_3_2: int(1..9)
find __18#matrix_to_atom_3_3: int(1..9)

--

Model before rewriting:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(0..2)
find __14: matrix indexed by [Index, Index] of Value
find __15: int(0..2)
find __16: matrix indexed by [Index, Index] of Value
find __17: int(0..2)
find __18: matrix indexed by [Index, Index] of Value
find __19: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __8#matrix_to_atom_1_1: int(1..9)
find __8#matrix_to_atom_1_2: int(1..9)
find __8#matrix_to_atom_1_3: int(1..9)
find __8#matrix_to_atom_2_1: int(1..9)
find __8#matrix_to_atom_2_2: int(1..9)
find __8#matrix_to_atom_2_3: int(1..9)
find __8#matrix_to_atom_3_1: int(1..9)
find __8#matrix_to_atom_3_2: int(1..9)
find __8#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __14#matrix_to_atom_1_1: int(1..9)
find __14#matrix_to_atom_1_2: int(1..9)
find __14#matrix_to_atom_1_3: int(1..9)
find __14#matrix_to_atom_2_1: int(1..9)
find __14#matrix_to_atom_2_2: int(1..9)
find __14#matrix_to_atom_2_3: int(1..9)
find __14#matrix_to_atom_3_1: int(1..9)
find __14#matrix_to_atom_3_2: int(1..9)
find __14#matrix_to_atom_3_3: int(1..9)
find __16#matrix_to_atom_1_1: int(1..9)
find __16#matrix_to_atom_1_2: int(1..9)
find __16#matrix_to_atom_1_3: int(1..9)
find __16#matrix_to_atom_2_1: int(1..9)
find __16#matrix_to_atom_2_2: int(1..9)
find __16#matrix_to_atom_2_3: int(1..9)
find __16#matrix_to_atom_3_1: int(1..9)
find __16#matrix_to_atom_3_2: int(1..9)
find __16#matrix_to_atom_3_3: int(1..9)
find __18#matrix_to_atom_1_1: int(1..9)
find __18#matrix_to_atom_1_2: int(1..9)
find __18#matrix_to_atom_1_3: int(1..9)
find __18#matrix_to_atom_2_1: int(1..9)
find __18#matrix_to_atom_2_2: int(1..9)
find __18#matrix_to_atom_2_3: int(1..9)
find __18#matrix_to_atom_3_1: int(1..9)
find __18#matrix_to_atom_3_2: int(1..9)
find __18#matrix_to_atom_3_3: int(1..9)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find d: Index
find __0: matrix indexed by [Index, Index] of Value
find __1: int(0..2)
find __2: matrix indexed by [Index, Index] of Value
find __3: int(0..2)
find __4: matrix indexed by [Index, Index] of Value
find __5: int(0..2)
find __6: matrix indexed by [Index, Index] of Value
find __7: int(0..2)
find __8: matrix indexed by [Index, Index] of Value
find __9: int(0..2)
find __10: matrix indexed by [Index, Index] of Value
find __11: int(0..2)
find __12: matrix indexed by [Index, Index] of Value
find __13: int(0..2)
find __14: matrix indexed by [Index, Index] of Value
find __15: int(0..2)
find __16: matrix indexed by [Index, Index] of Value
find __17: int(0..2)
find __18: matrix indexed by [Index, Index] of Value
find __19: int(0..2)
find __0#matrix_to_atom_1_1: int(1..9)
find __0#matrix_to_atom_1_2: int(1..9)
find __0#matrix_to_atom_1_3: int(1..9)
find __0#matrix_to_atom_2_1: int(1..9)
find __0#matrix_to_atom_2_2: int(1..9)
find __0#matrix_to_atom_2_3: int(1..9)
find __0#matrix_to_atom_3_1: int(1..9)
find __0#matrix_to_atom_3_2: int(1..9)
find __0#matrix_to_atom_3_3: int(1..9)
find __2#matrix_to_atom_1_1: int(1..9)
find __2#matrix_to_atom_1_2: int(1..9)
find __2#matrix_to_atom_1_3: int(1..9)
find __2#matrix_to_atom_2_1: int(1..9)
find __2#matrix_to_atom_2_2: int(1..9)
find __2#matrix_to_atom_2_3: int(1..9)
find __2#matrix_to_atom_3_1: int(1..9)
find __2#matrix_to_atom_3_2: int(1..9)
find __2#matrix_to_atom_3_3: int(1..9)
find __4#matrix_to_atom_1_1: int(1..9)
find __4#matrix_to_atom_1_2: int(1..9)
find __4#matrix_to_atom_1_3: int(1..9)
find __4#matrix_to_atom_2_1: int(1..9)
find __4#matrix_to_atom_2_2: int(1..9)
find __4#matrix_to_atom_2_3: int(1..9)
find __4#matrix_to_atom_3_1: int(1..9)
find __4#matrix_to_atom_3_2: int(1..9)
find __4#matrix_to_atom_3_3: int(1..9)
find __6#matrix_to_atom_1_1: int(1..9)
find __6#matrix_to_atom_1_2: int(1..9)
find __6#matrix_to_atom_1_3: int(1..9)
find __6#matrix_to_atom_2_1: int(1..9)
find __6#matrix_to_atom_2_2: int(1..9)
find __6#matrix_to_atom_2_3: int(1..9)
find __6#matrix_to_atom_3_1: int(1..9)
find __6#matrix_to_atom_3_2: int(1..9)
find __6#matrix_to_atom_3_3: int(1..9)
find __8#matrix_to_atom_1_1: int(1..9)
find __8#matrix_to_atom_1_2: int(1..9)
find __8#matrix_to_atom_1_3: int(1..9)
find __8#matrix_to_atom_2_1: int(1..9)
find __8#matrix_to_atom_2_2: int(1..9)
find __8#matrix_to_atom_2_3: int(1..9)
find __8#matrix_to_atom_3_1: int(1..9)
find __8#matrix_to_atom_3_2: int(1..9)
find __8#matrix_to_atom_3_3: int(1..9)
find __10#matrix_to_atom_1_1: int(1..9)
find __10#matrix_to_atom_1_2: int(1..9)
find __10#matrix_to_atom_1_3: int(1..9)
find __10#matrix_to_atom_2_1: int(1..9)
find __10#matrix_to_atom_2_2: int(1..9)
find __10#matrix_to_atom_2_3: int(1..9)
find __10#matrix_to_atom_3_1: int(1..9)
find __10#matrix_to_atom_3_2: int(1..9)
find __10#matrix_to_atom_3_3: int(1..9)
find __12#matrix_to_atom_1_1: int(1..9)
find __12#matrix_to_atom_1_2: int(1..9)
find __12#matrix_to_atom_1_3: int(1..9)
find __12#matrix_to_atom_2_1: int(1..9)
find __12#matrix_to_atom_2_2: int(1..9)
find __12#matrix_to_atom_2_3: int(1..9)
find __12#matrix_to_atom_3_1: int(1..9)
find __12#matrix_to_atom_3_2: int(1..9)
find __12#matrix_to_atom_3_3: int(1..9)
find __14#matrix_to_atom_1_1: int(1..9)
find __14#matrix_to_atom_1_2: int(1..9)
find __14#matrix_to_atom_1_3: int(1..9)
find __14#matrix_to_atom_2_1: int(1..9)
find __14#matrix_to_atom_2_2: int(1..9)
find __14#matrix_to_atom_2_3: int(1..9)
find __14#matrix_to_atom_3_1: int(1..9)
find __14#matrix_to_atom_3_2: int(1..9)
find __14#matrix_to_atom_3_3: int(1..9)
find __16#matrix_to_atom_1_1: int(1..9)
find __16#matrix_to_atom_1_2: int(1..9)
find __16#matrix_to_atom_1_3: int(1..9)
find __16#matrix_to_atom_2_1: int(1..9)
find __16#matrix_to_atom_2_2: int(1..9)
find __16#matrix_to_atom_2_3: int(1..9)
find __16#matrix_to_atom_3_1: int(1..9)
find __16#matrix_to_atom_3_2: int(1..9)
find __16#matrix_to_atom_3_3: int(1..9)
find __18#matrix_to_atom_1_1: int(1..9)
find __18#matrix_to_atom_1_2: int(1..9)
find __18#matrix_to_atom_1_3: int(1..9)
find __18#matrix_to_atom_2_1: int(1..9)
find __18#matrix_to_atom_2_2: int(1..9)
find __18#matrix_to_atom_2_3: int(1..9)
find __18#matrix_to_atom_3_1: int(1..9)
find __18#matrix_to_atom_3_2: int(1..9)
find __18#matrix_to_atom_3_3: int(1..9)

such that

true

[ square[d, (4 - d)] | d : Index ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[square[1, 3],square[2, 2],square[3, 1];int(1..)]

--

square[1, 3], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[1, 3] @ and([__inDomain(1,int(1..3)),__inDomain(3,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([{square[1, 3] @ and([__inDomain(1,int(1..3)),__inDomain(3,int(1..3));int(1..)])},square[2, 2],square[3, 1];int(1..)]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 3],square[2, 2],square[3, 1];int(1..)]) = s)

--

square[2, 2], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[2, 2] @ and([__inDomain(2,int(1..3)),__inDomain(2,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 3],{square[2, 2] @ and([__inDomain(2,int(1..3)),__inDomain(2,int(1..3));int(1..)])},square[3, 1];int(1..)]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 3],square[2, 2],square[3, 1];int(1..)]) = s)

--

square[3, 1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{square[3, 1] @ and([__inDomain(3,int(1..3)),__inDomain(1,int(1..3));int(1..)])}

--

allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 3],square[2, 2],{square[3, 1] @ and([__inDomain(3,int(1..3)),__inDomain(1,int(1..3));int(1..)])};int(1..)]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)])
allDiff(flatten(square)),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 3],square[2, 2],square[3, 1];int(1..)]) = s)

--

flatten(square), 
   ~~> unwrap_flatten_matrix_nonatomic ([("Smt", 999)])
[square[1, 1],square[1, 2],square[1, 3],square[2, 1],square[2, 2],square[2, 3],square[3, 1],square[3, 2],square[3, 3];int(1..9)]

--

allDiff([square[1, 1],square[1, 2],square[1, 3],square[2, 1],square[2, 2],square[2, 3],square[3, 1],square[3, 2],square[3, 3];int(1..9)]), 
   ~~> matrix_to_list ([("Base", 2000)])
allDiff([square[1, 1],square[1, 2],square[1, 3],square[2, 1],square[2, 2],square[2, 3],square[3, 1],square[3, 2],square[3, 3];int(1..)])

--

Final model:

letting Index be domain int(1..3)
letting Value be domain int(1..9)
letting n be 3
find s: int(1..24)
find square: matrix indexed by [Index, Index] of Value

such that

allDiff([square[1, 1],square[1, 2],square[1, 3],square[2, 1],square[2, 2],square[2, 3],square[3, 1],square[3, 2],square[3, 3];int(1..)]),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 3],square[2, 2],square[3, 1];int(1..)]) = s)

