Model before rewriting:

letting Index be domain int(1..3)
letting Value be domain int(1..9)
letting n be 3
find s: int(1..24)
find square: matrix indexed by [[Index, Index]] of Value

such that

allDiff(flatten(square)),
and([ (sum([ square[r, c] | c : Index ]) = s) | r : Index ]),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([ square[d, d] | d : Index ]) = s),
(sum([ square[d, (4 - d)] | d : Index ]) = s)

--

Model before rewriting:

find d: Index
find __0: Value

such that

(0 != __0)

--

Final model:

find d: Index
find __0: Value

such that

(0 != __0)

Model before rewriting:

quantified d: Index

such that

square[d, d]

--

square[d, d], 
   ~~> index_to_bubble ([("Bubble", 6000)]) 
{square[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])} 

--

{square[d, d] @ and([__inDomain(d,int(1..3)),__inDomain(d,int(1..3));int(1..)])}, 
   ~~> constant_evaluator ([("Constant", 9001)]) 
square[d, d] 

--

Final model:

quantified d: Index

such that

square[d, d]

sum([ square[d, d] | d : Index ]), 
   ~~> expand_comprehension_via_solver_ac ([("Base", 2002)]) 
sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) 

--

Model before rewriting:

find d: Index
find __0: Value

such that

(0 != __0)

--

Final model:

find d: Index
find __0: Value

such that

(0 != __0)

Model before rewriting:

quantified d: Index

such that

square[d, (4 - d)]

--

(4 - d), 
   ~~> minus_to_sum ([("Base", 8400)]) 
sum([4,-(d);int(1..)]) 

--

square[d, sum([4,-(d);int(1..)])], 
   ~~> index_to_bubble ([("Bubble", 6000)]) 
{square[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])} 

--

{square[d, sum([4,-(d);int(1..)])] @ and([__inDomain(d,int(1..3)),__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])}, 
   ~~> constant_evaluator ([("Constant", 9001)]) 
{square[d, sum([4,-(d);int(1..)])] @ and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)])} 

--

and([__inDomain(sum([4,-(d);int(1..)]),int(1..3));int(1..)]), 
   ~~> remove_unit_vector_and ([("Base", 8800)]) 
__inDomain(sum([4,-(d);int(1..)]),int(1..3)) 

--

Final model:

quantified d: Index

such that

{square[d, sum([4,-(d);int(1..)])] @ __inDomain(sum([4,-(d);int(1..)]),int(1..3))}

sum([ square[d, (4 - d)] | d : Index ]), 
   ~~> expand_comprehension_via_solver_ac ([("Base", 2002)]) 
sum([{square[1, sum([4,-(1);int(1..)])] @ __inDomain(sum([4,-(1);int(1..)]),int(1..3))},{square[2, sum([4,-(2);int(1..)])] @ __inDomain(sum([4,-(2);int(1..)]),int(1..3))},{square[3, sum([4,-(3);int(1..)])] @ __inDomain(sum([4,-(3);int(1..)]),int(1..3))};int(1..)]) 

--

allDiff(flatten(square)),
and([ (sum([ square[r, c] | c : Index ]) = s) | r : Index ]),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([{square[1, sum([4,-(1);int(1..)])] @ __inDomain(sum([4,-(1);int(1..)]),int(1..3))},{square[2, sum([4,-(2);int(1..)])] @ __inDomain(sum([4,-(2);int(1..)]),int(1..3))},{square[3, sum([4,-(3);int(1..)])] @ __inDomain(sum([4,-(3);int(1..)]),int(1..3))};int(1..)]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)]) 
allDiff(flatten(square)),
and([ (sum([ square[r, c] | c : Index ]) = s) | r : Index ]),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 3],square[2, 2],square[3, 1];int(1..)]) = s) 

--

flatten(square), 
   ~~> unwrap_flatten_matrix_nonatomic ([("Smt", 999)]) 
[square[1, 1],square[1, 2],square[1, 3],square[2, 1],square[2, 2],square[2, 3],square[3, 1],square[3, 2],square[3, 3];int(1..9)] 

--

allDiff([square[1, 1],square[1, 2],square[1, 3],square[2, 1],square[2, 2],square[2, 3],square[3, 1],square[3, 2],square[3, 3];int(1..9)]), 
   ~~> matrix_to_list ([("Base", 2000)]) 
allDiff([square[1, 1],square[1, 2],square[1, 3],square[2, 1],square[2, 2],square[2, 3],square[3, 1],square[3, 2],square[3, 3];int(1..)]) 

--

Model before rewriting:

find c: Index
find __0: Value

such that

(0 != __0)

--

Final model:

find c: Index
find __0: Value

such that

(0 != __0)

Model before rewriting:

quantified c: Index

such that

square[r, c]

--

square[r, c], 
   ~~> index_to_bubble ([("Bubble", 6000)]) 
{square[r, c] @ and([__inDomain(r,int(1..3)),__inDomain(c,int(1..3));int(1..)])} 

--

{square[r, c] @ and([__inDomain(r,int(1..3)),__inDomain(c,int(1..3));int(1..)])}, 
   ~~> constant_evaluator ([("Constant", 9001)]) 
square[r, c] 

--

Final model:

quantified c: Index

such that

square[r, c]

sum([ square[r, c] | c : Index ]), 
   ~~> expand_comprehension_via_solver_ac ([("Base", 2002)]) 
sum([square[r, 1],square[r, 2],square[r, 3];int(1..)]) 

--

Model before rewriting:

find r: Index
find __0: bool

such that

(true != __0)

--

Final model:

find r: Index
find __0: bool

such that

(true != __0)

Model before rewriting:

quantified r: Index

such that

(sum([square[r, 1],square[r, 2],square[r, 3];int(1..)]) = s)

--

Final model:

quantified r: Index

such that

(sum([square[r, 1],square[r, 2],square[r, 3];int(1..)]) = s)

and([ (sum([square[r, 1],square[r, 2],square[r, 3];int(1..)]) = s) | r : Index ]), 
   ~~> expand_comprehension_via_solver_ac ([("Base", 2002)]) 
and([(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s);int(1..)]) 

--

allDiff([square[1, 1],square[1, 2],square[1, 3],square[2, 1],square[2, 2],square[2, 3],square[3, 1],square[3, 2],square[3, 3];int(1..)]),
and([(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s);int(1..)]),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 3],square[2, 2],square[3, 1];int(1..)]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)]) 
allDiff([square[1, 1],square[1, 2],square[1, 3],square[2, 1],square[2, 2],square[2, 3],square[3, 1],square[3, 2],square[3, 3];int(1..)]),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
and([ (sum([ square[r, c] | r : Index ]) = s) | c : Index ]),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 3],square[2, 2],square[3, 1];int(1..)]) = s) 

--

Model before rewriting:

find r: Index
find __0: Value

such that

(0 != __0)

--

Final model:

find r: Index
find __0: Value

such that

(0 != __0)

Model before rewriting:

quantified r: Index

such that

square[r, c]

--

square[r, c], 
   ~~> index_to_bubble ([("Bubble", 6000)]) 
{square[r, c] @ and([__inDomain(r,int(1..3)),__inDomain(c,int(1..3));int(1..)])} 

--

{square[r, c] @ and([__inDomain(r,int(1..3)),__inDomain(c,int(1..3));int(1..)])}, 
   ~~> constant_evaluator ([("Constant", 9001)]) 
square[r, c] 

--

Final model:

quantified r: Index

such that

square[r, c]

sum([ square[r, c] | r : Index ]), 
   ~~> expand_comprehension_via_solver_ac ([("Base", 2002)]) 
sum([square[1, c],square[2, c],square[3, c];int(1..)]) 

--

Model before rewriting:

find c: Index
find __0: bool

such that

(true != __0)

--

Final model:

find c: Index
find __0: bool

such that

(true != __0)

Model before rewriting:

quantified c: Index

such that

(sum([square[1, c],square[2, c],square[3, c];int(1..)]) = s)

--

Final model:

quantified c: Index

such that

(sum([square[1, c],square[2, c],square[3, c];int(1..)]) = s)

and([ (sum([square[1, c],square[2, c],square[3, c];int(1..)]) = s) | c : Index ]), 
   ~~> expand_comprehension_via_solver_ac ([("Base", 2002)]) 
and([(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s);int(1..)]) 

--

allDiff([square[1, 1],square[1, 2],square[1, 3],square[2, 1],square[2, 2],square[2, 3],square[3, 1],square[3, 2],square[3, 3];int(1..)]),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
and([(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s);int(1..)]),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 3],square[2, 2],square[3, 1];int(1..)]) = s), 
   ~~> constant_evaluator ([("Constant", 9001)]) 
allDiff([square[1, 1],square[1, 2],square[1, 3],square[2, 1],square[2, 2],square[2, 3],square[3, 1],square[3, 2],square[3, 3];int(1..)]),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 3],square[2, 2],square[3, 1];int(1..)]) = s) 

--

Final model:

letting Index be domain int(1..3)
letting Value be domain int(1..9)
letting n be 3
find s: int(1..24)
find square: matrix indexed by [[Index, Index]] of Value

such that

allDiff([square[1, 1],square[1, 2],square[1, 3],square[2, 1],square[2, 2],square[2, 3],square[3, 1],square[3, 2],square[3, 3];int(1..)]),
(sum([square[1, 1],square[1, 2],square[1, 3];int(1..)]) = s),
(sum([square[2, 1],square[2, 2],square[2, 3];int(1..)]) = s),
(sum([square[3, 1],square[3, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 1],square[3, 1];int(1..)]) = s),
(sum([square[1, 2],square[2, 2],square[3, 2];int(1..)]) = s),
(sum([square[1, 3],square[2, 3],square[3, 3];int(1..)]) = s),
(sum([square[1, 1],square[2, 2],square[3, 3];int(1..)]) = s),
(sum([square[1, 3],square[2, 2],square[3, 1];int(1..)]) = s)

