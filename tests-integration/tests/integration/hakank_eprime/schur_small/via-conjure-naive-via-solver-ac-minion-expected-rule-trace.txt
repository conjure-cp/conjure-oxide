Model before rewriting:

letting n be 2
letting num_boxes be 3
find schur: matrix indexed by [int(1..n)] of int(1..num_boxes)

such that

and([ ((sum([i,j;int(1..2)]) = k)) -> (!(and([(schur[i] = schur[j]),(schur[j] = schur[k]);int(1..2)]))) | i : int(1..n), j : int(1..n), k : int(1..n) ])

--

and([ ((sum([i,j;int(1..2)]) = k)) -> (!(and([(schur[i] = schur[j]),(schur[j] = schur[k]);int(1..2)]))) | i : int(1..n), j : int(1..n), k : int(1..n) ]), 
   ~~> select_representation_matrix ([("Representations", 8001)])
and([ ((sum([i,j;int(1..2)]) = k)) -> (!(and([(schur[i] = schur[j]),(schur[j] = schur[k]);int(1..2)]))) | i : int(1..n), j : int(1..n), k : int(1..n) ])
new variables:
  find schur#matrix_to_atom_1: int(1..3)
  find schur#matrix_to_atom_2: int(1..3)

--

Model before rewriting:

find i: int(1..n)
find j: int(1..n)
find k: int(1..n)
find __0: matrix indexed by [int(1..n)] of int(1..num_boxes)

such that

(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([(__0[i] = __0[j]),(__0[j] = __0[k]);int(1..2)]))))

--

(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([(__0#matrix_to_atom[i] = __0#matrix_to_atom[j]),(__0#matrix_to_atom[j] = __0#matrix_to_atom[k]);int(1..2)])))), 
   ~~> select_representation_matrix ([("Representations", 8001)])
(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([(__0#matrix_to_atom[i] = __0#matrix_to_atom[j]),(__0#matrix_to_atom[j] = __0#matrix_to_atom[k]);int(1..2)]))))
new variables:
  find __0#matrix_to_atom_1: int(1..3)
  find __0#matrix_to_atom_2: int(1..3)

--

__0#matrix_to_atom[i], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__0#matrix_to_atom[i] @ and([__inDomain(i,int(1..2));int(1..)])}

--

(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([({__0#matrix_to_atom[i] @ and([__inDomain(i,int(1..2));int(1..)])} = __0#matrix_to_atom[j]),(__0#matrix_to_atom[j] = __0#matrix_to_atom[k]);int(1..2)])))), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([(__0#matrix_to_atom[i] = __0#matrix_to_atom[j]),(__0#matrix_to_atom[j] = __0#matrix_to_atom[k]);int(1..2)]))))

--

__0#matrix_to_atom[j], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__0#matrix_to_atom[j] @ and([__inDomain(j,int(1..2));int(1..)])}

--

(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([(__0#matrix_to_atom[i] = {__0#matrix_to_atom[j] @ and([__inDomain(j,int(1..2));int(1..)])}),(__0#matrix_to_atom[j] = __0#matrix_to_atom[k]);int(1..2)])))), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([(__0#matrix_to_atom[i] = __0#matrix_to_atom[j]),(__0#matrix_to_atom[j] = __0#matrix_to_atom[k]);int(1..2)]))))

--

__0#matrix_to_atom[j], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__0#matrix_to_atom[j] @ and([__inDomain(j,int(1..2));int(1..)])}

--

(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([(__0#matrix_to_atom[i] = __0#matrix_to_atom[j]),({__0#matrix_to_atom[j] @ and([__inDomain(j,int(1..2));int(1..)])} = __0#matrix_to_atom[k]);int(1..2)])))), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([(__0#matrix_to_atom[i] = __0#matrix_to_atom[j]),(__0#matrix_to_atom[j] = __0#matrix_to_atom[k]);int(1..2)]))))

--

__0#matrix_to_atom[k], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{__0#matrix_to_atom[k] @ and([__inDomain(k,int(1..2));int(1..)])}

--

(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([(__0#matrix_to_atom[i] = __0#matrix_to_atom[j]),(__0#matrix_to_atom[j] = {__0#matrix_to_atom[k] @ and([__inDomain(k,int(1..2));int(1..)])});int(1..2)])))), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([(__0#matrix_to_atom[i] = __0#matrix_to_atom[j]),(__0#matrix_to_atom[j] = __0#matrix_to_atom[k]);int(1..2)]))))

--

(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([(__0#matrix_to_atom[i] = __0#matrix_to_atom[j]),(__0#matrix_to_atom[j] = __0#matrix_to_atom[k]);int(1..2)])))), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(i - 0)] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(j - 0)]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(j - 0)] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(k - 0)]);int(1..2)]))))

--

(i - 0), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([i,-(0);int(1..)])

--

(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,-(0);int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(j - 0)]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(j - 0)] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(k - 0)]);int(1..2)])))), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(j - 0)]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(j - 0)] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(k - 0)]);int(1..2)]))))

--

(j - 0), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([j,-(0);int(1..)])

--

(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,-(0);int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(j - 0)] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(k - 0)]);int(1..2)])))), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(j - 0)] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(k - 0)]);int(1..2)]))))

--

(j - 0), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([j,-(0);int(1..)])

--

(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,-(0);int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(k - 0)]);int(1..2)])))), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][(k - 0)]);int(1..2)]))))

--

(k - 0), 
   ~~> minus_to_sum ([("Base", 8400)])
sum([k,-(0);int(1..)])

--

(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,-(0);int(1..)])]);int(1..2)])))), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)]))))

--

(true != ((sum([i,j;int(1..2)]) = k)) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)])))), 
   ~~> flatten_generic ([("Minion", 4200)])
(true != __1)
new variables:
  find __1: bool
new constraints:
  __1 =aux ((sum([i,j;int(1..2)]) = k)) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)])))

--

__1 =aux ((sum([i,j;int(1..2)]) = k)) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)]))), 
   ~~> bool_eq_to_reify ([("Minion", 4400)])
Reify(((sum([i,j;int(1..2)]) = k)) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)]))), __1)

--

((sum([i,j;int(1..2)]) = k)) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)]))), 
   ~~> flatten_imply ([("Minion", 4200)])
(__2) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)])))
new variables:
  find __2: bool
new constraints:
  __2 =aux (sum([i,j;int(1..2)]) = k)

--

(__2) -> (!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)]))), 
   ~~> introduce_reifyimply_ineq_from_imply ([("Minion", 4400)])
ReifyImply(!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)])), __2)

--

__2 =aux (sum([i,j;int(1..2)]) = k), 
   ~~> bool_eq_to_reify ([("Minion", 4400)])
Reify((sum([i,j;int(1..2)]) = k), __2)

--

!(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)])), 
   ~~> flatten_generic ([("Minion", 4200)])
!(__3)
new variables:
  find __3: bool
new constraints:
  __3 =aux and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)])

--

__3 =aux and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)]), 
   ~~> bool_eq_to_reify ([("Minion", 4400)])
Reify(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)]), __3)

--

[__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([i,0;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__4]
new variables:
  find __4: int(1..2)
new constraints:
  __4 =aux sum([i,0;int(1..)])

--

__4 =aux sum([i,0;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([0, i], __4),SumGeq([0, i], __4);int(1..)])

--

(true != __1),
Reify(ReifyImply(!(__3), __2), __1),
Reify((sum([i,j;int(1..2)]) = k), __2),
Reify(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__4] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)]), __3),
and([SumLeq([0, i], __4),SumGeq([0, i], __4);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __1),
Reify(ReifyImply(!(__3), __2), __1),
Reify((sum([i,j;int(1..2)]) = k), __2),
Reify(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__4] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)]), __3),
SumLeq([0, i], __4),
SumGeq([0, i], __4)

--

[__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__5]
new variables:
  find __5: int(1..2)
new constraints:
  __5 =aux sum([j,0;int(1..)])

--

__5 =aux sum([j,0;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([0, j], __5),SumGeq([0, j], __5);int(1..)])

--

(true != __1),
Reify(ReifyImply(!(__3), __2), __1),
Reify((sum([i,j;int(1..2)]) = k), __2),
Reify(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__4] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__5]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)]), __3),
SumLeq([0, i], __4),
SumGeq([0, i], __4),
and([SumLeq([0, j], __5),SumGeq([0, j], __5);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __1),
Reify(ReifyImply(!(__3), __2), __1),
Reify((sum([i,j;int(1..2)]) = k), __2),
Reify(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__4] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__5]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)]), __3),
SumLeq([0, i], __4),
SumGeq([0, i], __4),
SumLeq([0, j], __5),
SumGeq([0, j], __5)

--

[__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([j,0;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__6]
new variables:
  find __6: int(1..2)
new constraints:
  __6 =aux sum([j,0;int(1..)])

--

__6 =aux sum([j,0;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([0, j], __6),SumGeq([0, j], __6);int(1..)])

--

(true != __1),
Reify(ReifyImply(!(__3), __2), __1),
Reify((sum([i,j;int(1..2)]) = k), __2),
Reify(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__4] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__5]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__6] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)]), __3),
SumLeq([0, i], __4),
SumGeq([0, i], __4),
SumLeq([0, j], __5),
SumGeq([0, j], __5),
and([SumLeq([0, j], __6),SumGeq([0, j], __6);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __1),
Reify(ReifyImply(!(__3), __2), __1),
Reify((sum([i,j;int(1..2)]) = k), __2),
Reify(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__4] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__5]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__6] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])]);int(1..2)]), __3),
SumLeq([0, i], __4),
SumGeq([0, i], __4),
SumLeq([0, j], __5),
SumGeq([0, j], __5),
SumLeq([0, j], __6),
SumGeq([0, j], __6)

--

[__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][sum([k,0;int(1..)])], 
   ~~> flatten_generic ([("Minion", 4200)])
[__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__7]
new variables:
  find __7: int(1..2)
new constraints:
  __7 =aux sum([k,0;int(1..)])

--

__7 =aux sum([k,0;int(1..)]), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([0, k], __7),SumGeq([0, k], __7);int(1..)])

--

(true != __1),
Reify(ReifyImply(!(__3), __2), __1),
Reify((sum([i,j;int(1..2)]) = k), __2),
Reify(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__4] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__5]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__6] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__7]);int(1..2)]), __3),
SumLeq([0, i], __4),
SumGeq([0, i], __4),
SumLeq([0, j], __5),
SumGeq([0, j], __5),
SumLeq([0, j], __6),
SumGeq([0, j], __6),
and([SumLeq([0, k], __7),SumGeq([0, k], __7);int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
(true != __1),
Reify(ReifyImply(!(__3), __2), __1),
Reify((sum([i,j;int(1..2)]) = k), __2),
Reify(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__4] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__5]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__6] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__7]);int(1..2)]), __3),
SumLeq([0, i], __4),
SumGeq([0, i], __4),
SumLeq([0, j], __5),
SumGeq([0, j], __5),
SumLeq([0, j], __6),
SumGeq([0, j], __6),
SumLeq([0, k], __7),
SumGeq([0, k], __7)

--

!(__3), 
   ~~> not_literal_to_wliteral ([("Minion", 4100)])
WatchedLiteral(__3,false)

--

sum([i,j;int(1..2)]), 
   ~~> matrix_to_list ([("Base", 2000)])
sum([i,j;int(1..)])

--

(sum([i,j;int(1..)]) = k), 
   ~~> introduce_weighted_sumleq_sumgeq ([("Minion", 4600)])
and([SumLeq([i, j], k),SumGeq([i, j], k);int(1..)])

--

and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__4] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__5]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__6] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__7]);int(1..2)]), 
   ~~> matrix_to_list ([("Base", 2000)])
and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__4] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__5]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__6] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__7]);int(1..)])

--

Final model:

find i: int(1..n)
find j: int(1..n)
find k: int(1..n)
find __0: matrix indexed by [int(1..n)] of int(1..num_boxes)
find __1: bool
find __2: bool
find __3: bool
find __4: int(1..2)
find __5: int(1..2)
find __6: int(1..2)
find __7: int(1..2)
find __0#matrix_to_atom_1: int(1..3)
find __0#matrix_to_atom_2: int(1..3)

such that

(true != __1),
Reify(ReifyImply(WatchedLiteral(__3,false), __2), __1),
Reify(and([SumLeq([i, j], k),SumGeq([i, j], k);int(1..)]), __2),
Reify(and([([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__4] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__5]),([__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__6] = [__0#matrix_to_atom_1,__0#matrix_to_atom_2;int(1..)][__7]);int(1..)]), __3),
SumLeq([0, i], __4),
SumGeq([0, i], __4),
SumLeq([0, j], __5),
SumGeq([0, j], __5),
SumLeq([0, j], __6),
SumGeq([0, j], __6),
SumLeq([0, k], __7),
SumGeq([0, k], __7)

Via-solver generator model before rewriting:

find i: int(1..n)
find j: int(1..n)
find k: int(1..n)
find __0: matrix indexed by [int(1..n)] of int(1..num_boxes)
find __1: bool
find __2: bool
find __3: bool
find __4: int(1..2)
find __5: int(1..2)
find __6: int(1..2)
find __7: int(1..2)
find __0#matrix_to_atom_1: int(1..3)
find __0#matrix_to_atom_2: int(1..3)

--

Model before rewriting:

find i: int(1..n)
find j: int(1..n)
find k: int(1..n)
find __0: matrix indexed by [int(1..n)] of int(1..num_boxes)
find __1: bool
find __2: bool
find __3: bool
find __4: int(1..2)
find __5: int(1..2)
find __6: int(1..2)
find __7: int(1..2)
find __0#matrix_to_atom_1: int(1..3)
find __0#matrix_to_atom_2: int(1..3)

--

, 
   ~~> eval_root ([("Constant", 9001)])
true

--

Final model:

find i: int(1..n)
find j: int(1..n)
find k: int(1..n)
find __0: matrix indexed by [int(1..n)] of int(1..num_boxes)
find __1: bool
find __2: bool
find __3: bool
find __4: int(1..2)
find __5: int(1..2)
find __6: int(1..2)
find __7: int(1..2)
find __0#matrix_to_atom_1: int(1..3)
find __0#matrix_to_atom_2: int(1..3)

such that

true

[ ((sum([i,j;int(1..2)]) = k)) -> (!(and([(schur[i] = schur[j]),(schur[j] = schur[k]);int(1..2)]))) | i : int(1..n), j : int(1..n), k : int(1..n) ], 
   ~~> expand_comprehension_via_solver ([("Base", 2000)])
[true,!(and([(schur[1] = schur[1]),(schur[1] = schur[2]);int(1..2)])),true,true,true,true,true,true;int(1..)]

--

and([true,!(and([(schur[1] = schur[1]),(schur[1] = schur[2]);int(1..2)])),true,true,true,true,true,true;int(1..)]), 
   ~~> constant_evaluator ([("Constant", 9001)])
!(and([(schur[1] = schur[1]),(schur[1] = schur[2]);int(1..2)]))

--

!(and([(schur#matrix_to_atom[1] = schur#matrix_to_atom[1]),(schur#matrix_to_atom[1] = schur#matrix_to_atom[2]);int(1..2)])), 
   ~~> select_representation_matrix ([("Representations", 8001)])
!(and([(schur#matrix_to_atom[1] = schur#matrix_to_atom[1]),(schur#matrix_to_atom[1] = schur#matrix_to_atom[2]);int(1..2)]))

--

schur#matrix_to_atom[1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{schur#matrix_to_atom[1] @ and([__inDomain(1,int(1..2));int(1..)])}

--

!(and([({schur#matrix_to_atom[1] @ and([__inDomain(1,int(1..2));int(1..)])} = schur#matrix_to_atom[1]),(schur#matrix_to_atom[1] = schur#matrix_to_atom[2]);int(1..2)])), 
   ~~> constant_evaluator ([("Constant", 9001)])
!(and([(schur#matrix_to_atom[1] = schur#matrix_to_atom[1]),(schur#matrix_to_atom[1] = schur#matrix_to_atom[2]);int(1..2)]))

--

schur#matrix_to_atom[1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{schur#matrix_to_atom[1] @ and([__inDomain(1,int(1..2));int(1..)])}

--

!(and([(schur#matrix_to_atom[1] = {schur#matrix_to_atom[1] @ and([__inDomain(1,int(1..2));int(1..)])}),(schur#matrix_to_atom[1] = schur#matrix_to_atom[2]);int(1..2)])), 
   ~~> constant_evaluator ([("Constant", 9001)])
!(and([(schur#matrix_to_atom[1] = schur#matrix_to_atom[1]),(schur#matrix_to_atom[1] = schur#matrix_to_atom[2]);int(1..2)]))

--

schur#matrix_to_atom[1], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{schur#matrix_to_atom[1] @ and([__inDomain(1,int(1..2));int(1..)])}

--

!(and([(schur#matrix_to_atom[1] = schur#matrix_to_atom[1]),({schur#matrix_to_atom[1] @ and([__inDomain(1,int(1..2));int(1..)])} = schur#matrix_to_atom[2]);int(1..2)])), 
   ~~> constant_evaluator ([("Constant", 9001)])
!(and([(schur#matrix_to_atom[1] = schur#matrix_to_atom[1]),(schur#matrix_to_atom[1] = schur#matrix_to_atom[2]);int(1..2)]))

--

schur#matrix_to_atom[2], 
   ~~> index_to_bubble ([("Bubble", 6000)])
{schur#matrix_to_atom[2] @ and([__inDomain(2,int(1..2));int(1..)])}

--

!(and([(schur#matrix_to_atom[1] = schur#matrix_to_atom[1]),(schur#matrix_to_atom[1] = {schur#matrix_to_atom[2] @ and([__inDomain(2,int(1..2));int(1..)])});int(1..2)])), 
   ~~> constant_evaluator ([("Constant", 9001)])
!(and([(schur#matrix_to_atom[1] = schur#matrix_to_atom[1]),(schur#matrix_to_atom[1] = schur#matrix_to_atom[2]);int(1..2)]))

--

!(and([(schur#matrix_to_atom[1] = schur#matrix_to_atom[1]),(schur#matrix_to_atom[1] = schur#matrix_to_atom[2]);int(1..2)])), 
   ~~> index_matrix_to_atom ([("Base", 5000)])
!(and([(schur#matrix_to_atom_1 = schur#matrix_to_atom_1),(schur#matrix_to_atom_1 = schur#matrix_to_atom_2);int(1..2)]))

--

!(and([(schur#matrix_to_atom_1 = schur#matrix_to_atom_1),(schur#matrix_to_atom_1 = schur#matrix_to_atom_2);int(1..2)])), 
   ~~> flatten_generic ([("Minion", 4200)])
!(__0)
new variables:
  find __0: bool
new constraints:
  __0 =aux and([(schur#matrix_to_atom_1 = schur#matrix_to_atom_1),(schur#matrix_to_atom_1 = schur#matrix_to_atom_2);int(1..2)])

--

__0 =aux and([(schur#matrix_to_atom_1 = schur#matrix_to_atom_1),(schur#matrix_to_atom_1 = schur#matrix_to_atom_2);int(1..2)]), 
   ~~> bool_eq_to_reify ([("Minion", 4400)])
Reify(and([(schur#matrix_to_atom_1 = schur#matrix_to_atom_1),(schur#matrix_to_atom_1 = schur#matrix_to_atom_2);int(1..2)]), __0)

--

!(__0), 
   ~~> not_literal_to_wliteral ([("Minion", 4100)])
WatchedLiteral(__0,false)

--

and([(schur#matrix_to_atom_1 = schur#matrix_to_atom_1),(schur#matrix_to_atom_1 = schur#matrix_to_atom_2);int(1..2)]), 
   ~~> matrix_to_list ([("Base", 2000)])
and([(schur#matrix_to_atom_1 = schur#matrix_to_atom_1),(schur#matrix_to_atom_1 = schur#matrix_to_atom_2);int(1..)])

--

Final model:

letting n be 2
letting num_boxes be 3
find schur: matrix indexed by [int(1..n)] of int(1..num_boxes)
find __0: bool
find schur#matrix_to_atom_1: int(1..3)
find schur#matrix_to_atom_2: int(1..3)

such that

WatchedLiteral(__0,false),
Reify(and([(schur#matrix_to_atom_1 = schur#matrix_to_atom_1),(schur#matrix_to_atom_1 = schur#matrix_to_atom_2);int(1..)]), __0)

